/*! For license information please see main.54ed0742.js.LICENSE.txt */
(()=>{var e={89:e=>{"use strict";function t(e,t,i){i=i||2;var o,s,a,l,d,h,p,g=t&&t.length,m=g?t[0]*i:e.length,v=n(e,0,m,i,!0),y=[];if(!v||v.next===v.prev)return y;if(g&&(v=function(e,t,i,r){var o,s,a,l=[];for(o=0,s=t.length;o<s;o++)(a=n(e,t[o]*r,o<s-1?t[o+1]*r:e.length,r,!1))===a.next&&(a.steiner=!0),l.push(f(a));for(l.sort(c),o=0;o<l.length;o++)i=u(l[o],i);return i}(e,t,v,i)),e.length>80*i){o=a=e[0],s=l=e[1];for(var b=i;b<m;b+=i)(d=e[b])<o&&(o=d),(h=e[b+1])<s&&(s=h),d>a&&(a=d),h>l&&(l=h);p=0!==(p=Math.max(a-o,l-s))?32767/p:0}return r(v,y,i,o,s,p,0),y}function n(e,t,n,i,r){var o,s;if(r===T(e,t,n,i)>0)for(o=t;o<n;o+=i)s=P(o,e[o],e[o+1],s);else for(o=n-i;o>=t;o-=i)s=P(o,e[o],e[o+1],s);return s&&v(s,s.next)&&(S(s),s=s.next),s}function i(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!v(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{if(S(i),(i=t=i.prev)===i.next)break;n=!0}}while(n||i!==t);return t}function r(e,t,n,c,u,d,f){if(e){!f&&d&&function(e,t,n,i){var r=e;do{0===r.z&&(r.z=h(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,n,i,r,o,s,a,l,c=1;do{for(n=e,e=null,o=null,s=0;n;){for(s++,i=n,a=0,t=0;t<c&&(a++,i=i.nextZ);t++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(s>1)}(r)}(e,c,u,d);for(var p,g,m=e;e.prev!==e.next;)if(p=e.prev,g=e.next,d?s(e,c,u,d):o(e))t.push(p.i/n|0),t.push(e.i/n|0),t.push(g.i/n|0),S(e),e=g.next,m=g.next;else if((e=g)===m){f?1===f?r(e=a(i(e),t,n),t,n,c,u,d,2):2===f&&l(e,t,n,c,u,d):r(i(e),t,n,c,u,d,1);break}}}function o(e){var t=e.prev,n=e,i=e.next;if(m(t,n,i)>=0)return!1;for(var r=t.x,o=n.x,s=i.x,a=t.y,l=n.y,c=i.y,u=r<o?r<s?r:s:o<s?o:s,d=a<l?a<c?a:c:l<c?l:c,h=r>o?r>s?r:s:o>s?o:s,f=a>l?a>c?a:c:l>c?l:c,g=i.next;g!==t;){if(g.x>=u&&g.x<=h&&g.y>=d&&g.y<=f&&p(r,a,o,l,s,c,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function s(e,t,n,i){var r=e.prev,o=e,s=e.next;if(m(r,o,s)>=0)return!1;for(var a=r.x,l=o.x,c=s.x,u=r.y,d=o.y,f=s.y,g=a<l?a<c?a:c:l<c?l:c,v=u<d?u<f?u:f:d<f?d:f,y=a>l?a>c?a:c:l>c?l:c,b=u>d?u>f?u:f:d>f?d:f,_=h(g,v,t,n,i),w=h(y,b,t,n,i),x=e.prevZ,P=e.nextZ;x&&x.z>=_&&P&&P.z<=w;){if(x.x>=g&&x.x<=y&&x.y>=v&&x.y<=b&&x!==r&&x!==s&&p(a,u,l,d,c,f,x.x,x.y)&&m(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,P.x>=g&&P.x<=y&&P.y>=v&&P.y<=b&&P!==r&&P!==s&&p(a,u,l,d,c,f,P.x,P.y)&&m(P.prev,P,P.next)>=0)return!1;P=P.nextZ}for(;x&&x.z>=_;){if(x.x>=g&&x.x<=y&&x.y>=v&&x.y<=b&&x!==r&&x!==s&&p(a,u,l,d,c,f,x.x,x.y)&&m(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;P&&P.z<=w;){if(P.x>=g&&P.x<=y&&P.y>=v&&P.y<=b&&P!==r&&P!==s&&p(a,u,l,d,c,f,P.x,P.y)&&m(P.prev,P,P.next)>=0)return!1;P=P.nextZ}return!0}function a(e,t,n){var r=e;do{var o=r.prev,s=r.next.next;!v(o,s)&&y(o,r,r.next,s)&&w(o,s)&&w(s,o)&&(t.push(o.i/n|0),t.push(r.i/n|0),t.push(s.i/n|0),S(r),S(r.next),r=e=s),r=r.next}while(r!==e);return i(r)}function l(e,t,n,o,s,a){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&g(l,c)){var u=x(l,c);return l=i(l,l.next),u=i(u,u.next),r(l,t,n,o,s,a,0),void r(u,t,n,o,s,a,0)}c=c.next}l=l.next}while(l!==e)}function c(e,t){return e.x-t.x}function u(e,t){var n=function(e,t){var n,i=t,r=e.x,o=e.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s&&(s=a,n=i.x<i.next.x?i:i.next,a===r))return n}i=i.next}while(i!==t);if(!n)return null;var l,c=n,u=n.x,h=n.y,f=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&p(o<h?r:s,o,u,h,o<h?s:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),w(i,e)&&(l<f||l===f&&(i.x>n.x||i.x===n.x&&d(n,i)))&&(n=i,f=l)),i=i.next}while(i!==c);return n}(e,t);if(!n)return t;var r=x(n,e);return i(r,r.next),i(n,n.next)}function d(e,t){return m(e.prev,e,t.prev)<0&&m(t.next,e,e.next)<0}function h(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function f(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function p(e,t,n,i,r,o,s,a){return(r-s)*(t-a)>=(e-s)*(o-a)&&(e-s)*(i-a)>=(n-s)*(t-a)&&(n-s)*(o-a)>=(r-s)*(i-a)}function g(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&y(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(w(e,t)&&w(t,e)&&function(e,t){var n=e,i=!1,r=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(m(e.prev,e,t.prev)||m(e,t.prev,t))||v(e,t)&&m(e.prev,e,e.next)>0&&m(t.prev,t,t.next)>0)}function m(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function v(e,t){return e.x===t.x&&e.y===t.y}function y(e,t,n,i){var r=_(m(e,t,n)),o=_(m(e,t,i)),s=_(m(n,i,e)),a=_(m(n,i,t));return r!==o&&s!==a||(!(0!==r||!b(e,n,t))||(!(0!==o||!b(e,i,t))||(!(0!==s||!b(n,e,i))||!(0!==a||!b(n,t,i)))))}function b(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function _(e){return e>0?1:e<0?-1:0}function w(e,t){return m(e.prev,e,e.next)<0?m(e,t,e.next)>=0&&m(e,e.prev,t)>=0:m(e,t,e.prev)<0||m(e,e.next,t)<0}function x(e,t){var n=new E(e.i,e.x,e.y),i=new E(t.i,t.x,t.y),r=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function P(e,t,n,i){var r=new E(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function S(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function E(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(e,t,n,i){for(var r=0,o=t,s=n-i;o<n;o+=i)r+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return r}e.exports=t,e.exports.default=t,t.deviation=function(e,t,n,i){var r=t&&t.length,o=r?t[0]*n:e.length,s=Math.abs(T(e,0,o,n));if(r)for(var a=0,l=t.length;a<l;a++){var c=t[a]*n,u=a<l-1?t[a+1]*n:e.length;s-=Math.abs(T(e,c,u,n))}var d=0;for(a=0;a<i.length;a+=3){var h=i[a]*n,f=i[a+1]*n,p=i[a+2]*n;d+=Math.abs((e[h]-e[p])*(e[f+1]-e[h+1])-(e[h]-e[f])*(e[p+1]-e[h+1]))}return 0===s&&0===d?0:Math.abs((d-s)/s)},t.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},i=0,r=0;r<e.length;r++){for(var o=0;o<e[r].length;o++)for(var s=0;s<t;s++)n.vertices.push(e[r][o][s]);r>0&&(i+=e[r-1].length,n.holes.push(i))}return n}},97:(e,t,n)=>{var i;!function(r,o,s,a){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],u=o.createElement("div"),d="function",h=Math.round,f=Math.abs,p=Date.now;function g(e,t,n){return setTimeout(x(e,n),t)}function m(e,t,n){return!!Array.isArray(e)&&(v(e,n[t],n),!0)}function v(e,t,n){var i;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==a)for(i=0;i<e.length;)t.call(n,e[i],i,e),i++;else for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e)}function y(e,t,n){var i="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=r.console&&(r.console.warn||r.console.log);return o&&o.call(r.console,i,n),e.apply(this,arguments)}}l="function"!==typeof Object.assign?function(e){if(e===a||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==a&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t}:Object.assign;var b=y((function(e,t,n){for(var i=Object.keys(t),r=0;r<i.length;)(!n||n&&e[i[r]]===a)&&(e[i[r]]=t[i[r]]),r++;return e}),"extend","Use `assign`."),_=y((function(e,t){return b(e,t,!0)}),"merge","Use `assign`.");function w(e,t,n){var i,r=t.prototype;(i=e.prototype=Object.create(r)).constructor=e,i._super=r,n&&l(i,n)}function x(e,t){return function(){return e.apply(t,arguments)}}function P(e,t){return typeof e==d?e.apply(t&&t[0]||a,t):e}function S(e,t){return e===a?t:e}function E(e,t,n){v(k(t),(function(t){e.addEventListener(t,n,!1)}))}function T(e,t,n){v(k(t),(function(t){e.removeEventListener(t,n,!1)}))}function C(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function A(e,t){return e.indexOf(t)>-1}function k(e){return e.trim().split(/\s+/g)}function M(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0;i<e.length;){if(n&&e[i][n]==t||!n&&e[i]===t)return i;i++}return-1}function L(e){return Array.prototype.slice.call(e,0)}function O(e,t,n){for(var i=[],r=[],o=0;o<e.length;){var s=t?e[o][t]:e[o];M(r,s)<0&&i.push(e[o]),r[o]=s,o++}return n&&(i=t?i.sort((function(e,n){return e[t]>n[t]})):i.sort()),i}function R(e,t){for(var n,i,r=t[0].toUpperCase()+t.slice(1),o=0;o<c.length;){if((i=(n=c[o])?n+r:t)in e)return i;o++}return a}var I=1;function z(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||r}var F="ontouchstart"in r,D=R(r,"PointerEvent")!==a,j=F&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),N="touch",B="mouse",U=25,V=1,W=4,G=8,H=1,q=2,X=4,Z=8,Y=16,K=q|X,Q=Z|Y,$=K|Q,J=["x","y"],ee=["clientX","clientY"];function te(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){P(e.options.enable,[e])&&n.handler(t)},this.init()}function ne(e,t,n){var i=n.pointers.length,r=n.changedPointers.length,o=t&V&&i-r===0,s=t&(W|G)&&i-r===0;n.isFirst=!!o,n.isFinal=!!s,o&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,i=t.pointers,r=i.length;n.firstInput||(n.firstInput=ie(t));r>1&&!n.firstMultiple?n.firstMultiple=ie(t):1===r&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,l=s?s.center:o.center,c=t.center=re(i);t.timeStamp=p(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=le(l,c),t.distance=ae(l,c),function(e,t){var n=t.center,i=e.offsetDelta||{},r=e.prevDelta||{},o=e.prevInput||{};t.eventType!==V&&o.eventType!==W||(r=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=e.offsetDelta={x:n.x,y:n.y});t.deltaX=r.x+(n.x-i.x),t.deltaY=r.y+(n.y-i.y)}(n,t),t.offsetDirection=se(t.deltaX,t.deltaY);var u=oe(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=u.x,t.overallVelocityY=u.y,t.overallVelocity=f(u.x)>f(u.y)?u.x:u.y,t.scale=s?(d=s.pointers,h=i,ae(h[0],h[1],ee)/ae(d[0],d[1],ee)):1,t.rotation=s?function(e,t){return le(t[1],t[0],ee)+le(e[1],e[0],ee)}(s.pointers,i):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,i,r,o,s=e.lastInterval||t,l=t.timeStamp-s.timeStamp;if(t.eventType!=G&&(l>U||s.velocity===a)){var c=t.deltaX-s.deltaX,u=t.deltaY-s.deltaY,d=oe(l,c,u);i=d.x,r=d.y,n=f(d.x)>f(d.y)?d.x:d.y,o=se(c,u),e.lastInterval=t}else n=s.velocity,i=s.velocityX,r=s.velocityY,o=s.direction;t.velocity=n,t.velocityX=i,t.velocityY=r,t.direction=o}(n,t);var d,h;var g=e.element;C(t.srcEvent.target,g)&&(g=t.srcEvent.target);t.target=g}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function ie(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:h(e.pointers[n].clientX),clientY:h(e.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:t,center:re(t),deltaX:e.deltaX,deltaY:e.deltaY}}function re(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var n=0,i=0,r=0;r<t;)n+=e[r].clientX,i+=e[r].clientY,r++;return{x:h(n/t),y:h(i/t)}}function oe(e,t,n){return{x:t/e||0,y:n/e||0}}function se(e,t){return e===t?H:f(e)>=f(t)?e<0?q:X:t<0?Z:Y}function ae(e,t,n){n||(n=J);var i=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return Math.sqrt(i*i+r*r)}function le(e,t,n){n||(n=J);var i=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return 180*Math.atan2(r,i)/Math.PI}te.prototype={handler:function(){},init:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(z(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(z(this.element),this.evWin,this.domHandler)}};var ce={mousedown:V,mousemove:2,mouseup:W},ue="mousedown",de="mousemove mouseup";function he(){this.evEl=ue,this.evWin=de,this.pressed=!1,te.apply(this,arguments)}w(he,te,{handler:function(e){var t=ce[e.type];t&V&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=W),this.pressed&&(t&W&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:B,srcEvent:e}))}});var fe={pointerdown:V,pointermove:2,pointerup:W,pointercancel:G,pointerout:G},pe={2:N,3:"pen",4:B,5:"kinect"},ge="pointerdown",me="pointermove pointerup pointercancel";function ve(){this.evEl=ge,this.evWin=me,te.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(ge="MSPointerDown",me="MSPointerMove MSPointerUp MSPointerCancel"),w(ve,te,{handler:function(e){var t=this.store,n=!1,i=e.type.toLowerCase().replace("ms",""),r=fe[i],o=pe[e.pointerType]||e.pointerType,s=o==N,a=M(t,e.pointerId,"pointerId");r&V&&(0===e.button||s)?a<0&&(t.push(e),a=t.length-1):r&(W|G)&&(n=!0),a<0||(t[a]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(a,1))}});var ye={touchstart:V,touchmove:2,touchend:W,touchcancel:G};function be(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,te.apply(this,arguments)}function _e(e,t){var n=L(e.touches),i=L(e.changedTouches);return t&(W|G)&&(n=O(n.concat(i),"identifier",!0)),[n,i]}w(be,te,{handler:function(e){var t=ye[e.type];if(t===V&&(this.started=!0),this.started){var n=_e.call(this,e,t);t&(W|G)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:N,srcEvent:e})}}});var we={touchstart:V,touchmove:2,touchend:W,touchcancel:G},xe="touchstart touchmove touchend touchcancel";function Pe(){this.evTarget=xe,this.targetIds={},te.apply(this,arguments)}function Se(e,t){var n=L(e.touches),i=this.targetIds;if(t&(2|V)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,s=L(e.changedTouches),a=[],l=this.target;if(o=n.filter((function(e){return C(e.target,l)})),t===V)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;for(r=0;r<s.length;)i[s[r].identifier]&&a.push(s[r]),t&(W|G)&&delete i[s[r].identifier],r++;return a.length?[O(o.concat(a),"identifier",!0),a]:void 0}w(Pe,te,{handler:function(e){var t=we[e.type],n=Se.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:N,srcEvent:e})}});var Ee=2500;function Te(){te.apply(this,arguments);var e=x(this.handler,this);this.touch=new Pe(this.manager,e),this.mouse=new he(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function Ce(e,t){e&V?(this.primaryTouch=t.changedPointers[0].identifier,Ae.call(this,t)):e&(W|G)&&Ae.call(this,t)}function Ae(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var e=i.indexOf(n);e>-1&&i.splice(e,1)}),Ee)}}function ke(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(t-r.x),s=Math.abs(n-r.y);if(o<=25&&s<=25)return!0}return!1}w(Te,te,{handler:function(e,t,n){var i=n.pointerType==N,r=n.pointerType==B;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)Ce.call(this,t,n);else if(r&&ke.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Me=R(u.style,"touchAction"),Le=Me!==a,Oe="compute",Re="auto",Ie="manipulation",ze="none",Fe="pan-x",De="pan-y",je=function(){if(!Le)return!1;var e={},t=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){e[n]=!t||r.CSS.supports("touch-action",n)})),e}();function Ne(e,t){this.manager=e,this.set(t)}Ne.prototype={set:function(e){e==Oe&&(e=this.compute()),Le&&this.manager.element.style&&je[e]&&(this.manager.element.style[Me]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return v(this.manager.recognizers,(function(t){P(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(A(e,ze))return ze;var t=A(e,Fe),n=A(e,De);if(t&&n)return ze;if(t||n)return t?Fe:De;if(A(e,Ie))return Ie;return Re}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var i=this.actions,r=A(i,ze)&&!je[ze],o=A(i,De)&&!je[De],s=A(i,Fe)&&!je[Fe];if(r){var a=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(a&&l&&c)return}if(!s||!o)return r||o&&n&K||s&&n&Q?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Be=1,Ue=32;function Ve(e){this.options=l({},this.defaults,e||{}),this.id=I++,this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=Be,this.simultaneous={},this.requireFail=[]}function We(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Ge(e){return e==Y?"down":e==Z?"up":e==q?"left":e==X?"right":""}function He(e,t){var n=t.manager;return n?n.get(e):e}function qe(){Ve.apply(this,arguments)}function Xe(){qe.apply(this,arguments),this.pX=null,this.pY=null}function Ze(){qe.apply(this,arguments)}function Ye(){Ve.apply(this,arguments),this._timer=null,this._input=null}function Ke(){qe.apply(this,arguments)}function Qe(){qe.apply(this,arguments)}function $e(){Ve.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Je(e,t){return(t=t||{}).recognizers=S(t.recognizers,Je.defaults.preset),new et(e,t)}Ve.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(m(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=He(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return m(e,"dropRecognizeWith",this)||(e=He(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(m(e,"requireFailure",this))return this;var t=this.requireFail;return-1===M(t,e=He(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(m(e,"dropRequireFailure",this))return this;e=He(e,this);var t=M(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function i(n){t.manager.emit(n,e)}n<8&&i(t.options.event+We(n)),i(t.options.event),e.additionalEvent&&i(e.additionalEvent),n>=8&&i(t.options.event+We(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Ue},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Ue|Be)))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!P(this.options.enable,[this,t]))return this.reset(),void(this.state=Ue);56&this.state&&(this.state=Be),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},w(qe,Ve,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,i=6&t,r=this.attrTest(e);return i&&(n&G||!r)?16|t:i||r?n&W?8|t:2&t?4|t:2:Ue}}),w(Xe,qe,{defaults:{event:"pan",threshold:10,pointers:1,direction:$},getTouchAction:function(){var e=this.options.direction,t=[];return e&K&&t.push(De),e&Q&&t.push(Fe),t},directionTest:function(e){var t=this.options,n=!0,i=e.distance,r=e.direction,o=e.deltaX,s=e.deltaY;return r&t.direction||(t.direction&K?(r=0===o?H:o<0?q:X,n=o!=this.pX,i=Math.abs(e.deltaX)):(r=0===s?H:s<0?Z:Y,n=s!=this.pY,i=Math.abs(e.deltaY))),e.direction=r,n&&i>t.threshold&&r&t.direction},attrTest:function(e){return qe.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Ge(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),w(Ze,qe,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ze]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),w(Ye,Ve,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Re]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!i||!n||e.eventType&(W|G)&&!r)this.reset();else if(e.eventType&V)this.reset(),this._timer=g((function(){this.state=8,this.tryEmit()}),t.time,this);else if(e.eventType&W)return 8;return Ue},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&e.eventType&W?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),w(Ke,qe,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ze]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),w(Qe,qe,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:K|Q,pointers:1},getTouchAction:function(){return Xe.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(K|Q)?t=e.overallVelocity:n&K?t=e.overallVelocityX:n&Q&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&f(t)>this.options.velocity&&e.eventType&W},emit:function(e){var t=Ge(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),w($e,Ve,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ie]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),e.eventType&V&&0===this.count)return this.failTimeout();if(i&&r&&n){if(e.eventType!=W)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,s=!this.pCenter||ae(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,s&&o?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=g((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return Ue},failTimeout:function(){return this._timer=g((function(){this.state=Ue}),this.options.interval,this),Ue},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Je.VERSION="2.0.7",Je.defaults={domEvents:!1,touchAction:Oe,enable:!0,inputTarget:null,inputClass:null,preset:[[Ke,{enable:!1}],[Ze,{enable:!1},["rotate"]],[Qe,{direction:K}],[Xe,{direction:K},["swipe"]],[$e],[$e,{event:"doubletap",taps:2},["tap"]],[Ye]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function et(e,t){var n;this.options=l({},Je.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((n=this).options.inputClass||(D?ve:j?Pe:F?Te:he))(n,ne),this.touchAction=new Ne(this,this.options.touchAction),tt(this,!0),v(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function tt(e,t){var n,i=e.element;i.style&&(v(e.options.cssProps,(function(r,o){n=R(i.style,o),t?(e.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=e.oldCssProps[n]||""})),t||(e.oldCssProps={}))}et.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var i=this.recognizers,r=t.curRecognizer;(!r||r&&8&r.state)&&(r=t.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===t.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(e),!r&&14&n.state&&(r=t.curRecognizer=n),o++}},get:function(e){if(e instanceof Ve)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(m(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(m(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=M(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==a&&t!==a){var n=this.handlers;return v(k(e),(function(e){n[e]=n[e]||[],n[e].push(t)})),this}},off:function(e,t){if(e!==a){var n=this.handlers;return v(k(e),(function(e){t?n[e]&&n[e].splice(M(n[e],t),1):delete n[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=o.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](t),i++}},destroy:function(){this.element&&tt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(Je,{INPUT_START:V,INPUT_MOVE:2,INPUT_END:W,INPUT_CANCEL:G,STATE_POSSIBLE:Be,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ue,DIRECTION_NONE:H,DIRECTION_LEFT:q,DIRECTION_RIGHT:X,DIRECTION_UP:Z,DIRECTION_DOWN:Y,DIRECTION_HORIZONTAL:K,DIRECTION_VERTICAL:Q,DIRECTION_ALL:$,Manager:et,Input:te,TouchAction:Ne,TouchInput:Pe,MouseInput:he,PointerEventInput:ve,TouchMouseInput:Te,SingleTouchInput:be,Recognizer:Ve,AttrRecognizer:qe,Tap:$e,Pan:Xe,Swipe:Qe,Pinch:Ze,Rotate:Ke,Press:Ye,on:E,off:T,each:v,merge:_,extend:b,assign:l,inherit:w,bindFn:x,prefixed:R}),("undefined"!==typeof r?r:"undefined"!==typeof self?self:{}).Hammer=Je,(i=function(){return Je}.call(t,n,t,e))===a||(e.exports=i)}(window,document)},463:(e,t,n)=>{"use strict";var i=n(791),r=n(296);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,n,i,r,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,i){var r=m.hasOwnProperty(t)?m[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),x=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),C=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var I=Symbol.iterator;function z(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var F,D=Object.assign;function j(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var N=!1;function B(e,t){if(!e||N)return"";N=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),o=i.stack.split("\n"),s=r.length-1,a=o.length-1;1<=s&&0<=a&&r[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(r[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||r[s]!==o[a]){var l="\n"+r[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=a);break}}}finally{N=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function U(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case P:return"Fragment";case x:return"Portal";case E:return"Profiler";case S:return"StrictMode";case k:return"Suspense";case M:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case L:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=H(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function Z(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return D({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function $(e,t){Q(e,t);var n=G(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Z(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return D({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function oe(e,t){var n=G(t.value),i=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=ge(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=D({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Pe=null,Se=null;function Ee(e){if(e=br(e)){if("function"!==typeof xe)throw Error(o(280));var t=e.stateNode;t&&(t=wr(t),xe(e.stateNode,e.type,t))}}function Te(e){Pe?Se?Se.push(e):Se=[e]:Pe=e}function Ce(){if(Pe){var e=Pe,t=Se;if(Se=Pe=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Ae(e,t){return e(t)}function ke(){}var Me=!1;function Le(e,t,n){if(Me)return e(t,n);Me=!0;try{return Ae(e,t,n)}finally{Me=!1,(null!==Pe||null!==Se)&&(ke(),Ce())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var i=wr(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Re=!1;if(u)try{var Ie={};Object.defineProperty(Ie,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Ie,Ie),window.removeEventListener("test",Ie,Ie)}catch(ue){Re=!1}function ze(e,t,n,i,r,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Fe=!1,De=null,je=!1,Ne=null,Be={onError:function(e){Fe=!0,De=e}};function Ue(e,t,n,i,r,o,s,a,l){Fe=!1,De=null,ze.apply(Be,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(Ve(e)!==e)throw Error(o(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(i=r.return)){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return Ge(r),e;if(s===i)return Ge(r),t;s=s.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=s;break}if(l===i){a=!0,i=r,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,i=r;break}if(l===i){a=!0,i=s,n=r;break}l=l.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Xe=r.unstable_scheduleCallback,Ze=r.unstable_cancelCallback,Ye=r.unstable_shouldYield,Ke=r.unstable_requestPaint,Qe=r.unstable_now,$e=r.unstable_getCurrentPriorityLevel,Je=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,ot=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~r;0!==a?i=dt(a):0!==(o&=s)&&(i=dt(o))}else 0!==(s=n&~r)?i=dt(s):0!==o&&(i=dt(o));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(o=t&-t)||16===r&&0!==(4194240&o)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-st(t)),i|=e[n],t&=~r;return i}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-st(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var bt=0;function _t(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,xt,Pt,St,Et,Tt=!1,Ct=[],At=null,kt=null,Mt=null,Lt=new Map,Ot=new Map,Rt=[],It="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":kt=null;break;case"mouseover":case"mouseout":Mt=null;break;case"pointerover":case"pointerout":Lt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Ft(e,t,n,i,r,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},null!==t&&(null!==(t=br(t))&&xt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Dt(e){var t=yr(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void Et(e.priority,(function(){Pt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=br(n))&&xt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);_e=i,n.target.dispatchEvent(i),_e=null,t.shift()}return!0}function Nt(e,t,n){jt(e)&&n.delete(t)}function Bt(){Tt=!1,null!==At&&jt(At)&&(At=null),null!==kt&&jt(kt)&&(kt=null),null!==Mt&&jt(Mt)&&(Mt=null),Lt.forEach(Nt),Ot.forEach(Nt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Bt)))}function Vt(e){function t(t){return Ut(t,e)}if(0<Ct.length){Ut(Ct[0],e);for(var n=1;n<Ct.length;n++){var i=Ct[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==At&&Ut(At,e),null!==kt&&Ut(kt,e),null!==Mt&&Ut(Mt,e),Lt.forEach(t),Ot.forEach(t),n=0;n<Rt.length;n++)(i=Rt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Dt(n),null===n.blockedOn&&Rt.shift()}var Wt=_.ReactCurrentBatchConfig,Gt=!0;function Ht(e,t,n,i){var r=bt,o=Wt.transition;Wt.transition=null;try{bt=1,Xt(e,t,n,i)}finally{bt=r,Wt.transition=o}}function qt(e,t,n,i){var r=bt,o=Wt.transition;Wt.transition=null;try{bt=4,Xt(e,t,n,i)}finally{bt=r,Wt.transition=o}}function Xt(e,t,n,i){if(Gt){var r=Yt(e,t,n,i);if(null===r)Gi(e,t,i,Zt,n),zt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return At=Ft(At,e,t,n,i,r),!0;case"dragenter":return kt=Ft(kt,e,t,n,i,r),!0;case"mouseover":return Mt=Ft(Mt,e,t,n,i,r),!0;case"pointerover":var o=r.pointerId;return Lt.set(o,Ft(Lt.get(o)||null,e,t,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,Ot.set(o,Ft(Ot.get(o)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(zt(e,i),4&t&&-1<It.indexOf(e)){for(;null!==r;){var o=br(r);if(null!==o&&wt(o),null===(o=Yt(e,t,n,i))&&Gi(e,t,i,Zt,n),o===r)break;r=o}null!==r&&i.stopPropagation()}else Gi(e,t,i,null,n)}}var Zt=null;function Yt(e,t,n,i){if(Zt=null,null!==(e=yr(e=we(i))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Zt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Qt=null,$t=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=$t,i=n.length,r="value"in Qt?Qt.value:Qt.textContent,o=r.length;for(e=0;e<i&&n[e]===r[e];e++);var s=i-e;for(t=1;t<=s&&n[i-t]===r[o-t];t++);return Jt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,i,r,o){for(var s in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return D(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),dn=D({},cn,{view:0,detail:0}),hn=on(dn),fn=D({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=on(fn),gn=on(D({},fn,{dataTransfer:0})),mn=on(D({},dn,{relatedTarget:0})),vn=on(D({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=D({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(yn),_n=on(D({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Pn[e])&&!!t[e]}function En(){return Sn}var Tn=D({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=on(Tn),An=on(D({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=on(D({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Mn=on(D({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ln=D({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=on(Ln),Rn=[9,13,27,32],In=u&&"CompositionEvent"in window,zn=null;u&&"documentMode"in document&&(zn=document.documentMode);var Fn=u&&"TextEvent"in window&&!zn,Dn=u&&(!In||zn&&8<zn&&11>=zn),jn=String.fromCharCode(32),Nn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function Hn(e,t,n,i){Te(i),0<(t=qi(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var qn=null,Xn=null;function Zn(e){ji(e,0)}function Yn(e){if(X(_r(e)))return e}function Kn(e,t){if("change"===e)return t}var Qn=!1;if(u){var $n;if(u){var Jn="oninput"in document;if(!Jn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Jn="function"===typeof ei.oninput}$n=Jn}else $n=!1;Qn=$n&&(!document.documentMode||9<document.documentMode)}function ti(){qn&&(qn.detachEvent("onpropertychange",ni),Xn=qn=null)}function ni(e){if("value"===e.propertyName&&Yn(Xn)){var t=[];Hn(t,Xn,e,we(e)),Le(Zn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Xn=n,(qn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Xn)}function oi(e,t){if("click"===e)return Yn(t)}function si(e,t){if("input"===e||"change"===e)return Yn(t)}var ai="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(ai(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!d.call(t,r)||!ai(e[r],t[r]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function di(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?di(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hi(){for(var e=window,t=Z();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=Z((e=t.contentWindow).document)}return t}function fi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pi(e){var t=hi(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&di(n.ownerDocument.documentElement,n)){if(null!==i&&fi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,o=Math.min(i.start,r);i=void 0===i.end?o:Math.min(i.end,r),!e.extend&&o>i&&(r=i,i=o,o=r),r=ui(n,o);var s=ui(n,i);r&&s&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),o>i?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gi=u&&"documentMode"in document&&11>=document.documentMode,mi=null,vi=null,yi=null,bi=!1;function _i(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bi||null==mi||mi!==Z(i)||("selectionStart"in(i=mi)&&fi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=qi(vi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=mi)))}function wi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xi={animationend:wi("Animation","AnimationEnd"),animationiteration:wi("Animation","AnimationIteration"),animationstart:wi("Animation","AnimationStart"),transitionend:wi("Transition","TransitionEnd")},Pi={},Si={};function Ei(e){if(Pi[e])return Pi[e];if(!xi[e])return e;var t,n=xi[e];for(t in n)if(n.hasOwnProperty(t)&&t in Si)return Pi[e]=n[t];return e}u&&(Si=document.createElement("div").style,"AnimationEvent"in window||(delete xi.animationend.animation,delete xi.animationiteration.animation,delete xi.animationstart.animation),"TransitionEvent"in window||delete xi.transitionend.transition);var Ti=Ei("animationend"),Ci=Ei("animationiteration"),Ai=Ei("animationstart"),ki=Ei("transitionend"),Mi=new Map,Li="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oi(e,t){Mi.set(e,t),l(t,[e])}for(var Ri=0;Ri<Li.length;Ri++){var Ii=Li[Ri];Oi(Ii.toLowerCase(),"on"+(Ii[0].toUpperCase()+Ii.slice(1)))}Oi(Ti,"onAnimationEnd"),Oi(Ci,"onAnimationIteration"),Oi(Ai,"onAnimationStart"),Oi("dblclick","onDoubleClick"),Oi("focusin","onFocus"),Oi("focusout","onBlur"),Oi(ki,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fi=new Set("cancel close invalid load scroll toggle".split(" ").concat(zi));function Di(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,s,a,l,c){if(Ue.apply(this,arguments),Fe){if(!Fe)throw Error(o(198));var u=De;Fe=!1,De=null,je||(je=!0,Ne=u)}}(i,t,void 0,e),e.currentTarget=null}function ji(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var o=void 0;if(t)for(var s=i.length-1;0<=s;s--){var a=i[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break e;Di(r,a,c),o=l}else for(s=0;s<i.length;s++){if(l=(a=i[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break e;Di(r,a,c),o=l}}}if(je)throw e=Ne,je=!1,Ne=null,e}function Ni(e,t){var n=t[gr];void 0===n&&(n=t[gr]=new Set);var i=e+"__bubble";n.has(i)||(Wi(t,e,2,!1),n.add(i))}function Bi(e,t,n){var i=0;t&&(i|=4),Wi(n,e,i,t)}var Ui="_reactListening"+Math.random().toString(36).slice(2);function Vi(e){if(!e[Ui]){e[Ui]=!0,s.forEach((function(t){"selectionchange"!==t&&(Fi.has(t)||Bi(t,!1,e),Bi(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ui]||(t[Ui]=!0,Bi("selectionchange",!1,t))}}function Wi(e,t,n,i){switch(Kt(t)){case 1:var r=Ht;break;case 4:r=qt;break;default:r=Xt}n=r.bind(null,t,n,e),r=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Gi(e,t,n,i,r){var o=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===s)for(s=i.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;s=s.return}for(;null!==a;){if(null===(s=yr(a)))return;if(5===(l=s.tag)||6===l){i=o=s;continue e}a=a.parentNode}}i=i.return}Le((function(){var i=o,r=we(n),s=[];e:{var a=Mi.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=kn;break;case Ti:case Ci:case Ai:l=vn;break;case ki:l=Mn;break;case"scroll":l=hn;break;case"wheel":l=On;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=i;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==h&&(null!=(g=Oe(p,h))&&u.push(Hi(p,g,f)))),d)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,r),s.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===_e||!(c=n.relatedTarget||n.fromElement)||!yr(c)&&!c[pr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?yr(c):null)&&(c!==(d=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=pn,g="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=An,g="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?a:_r(l),f=null==c?a:_r(c),(a=new u(g,p+"leave",l,n,r)).target=d,a.relatedTarget=f,g=null,yr(r)===i&&((u=new u(h,p+"enter",c,n,r)).target=f,u.relatedTarget=d,g=u),d=g,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Xi(f))p++;for(f=0,g=h;g;g=Xi(g))f++;for(;0<p-f;)u=Xi(u),p--;for(;0<f-p;)h=Xi(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Xi(u),h=Xi(h)}u=null}else u=null;null!==l&&Zi(s,a,l,u,!1),null!==c&&null!==d&&Zi(s,d,c,u,!0)}if("select"===(l=(a=i?_r(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Kn;else if(Gn(a))if(Qn)m=si;else{m=ri;var v=ii}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=oi);switch(m&&(m=m(e,i))?Hn(s,m,n,r):(v&&v(e,a,i),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=i?_r(i):window,e){case"focusin":(Gn(v)||"true"===v.contentEditable)&&(mi=v,vi=i,yi=null);break;case"focusout":yi=vi=mi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,_i(s,n,r);break;case"selectionchange":if(gi)break;case"keydown":case"keyup":_i(s,n,r)}var y;if(In)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vn?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Dn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(y=en()):($t="value"in(Qt=r)?Qt.value:Qt.textContent,Vn=!0)),0<(v=qi(i,b)).length&&(b=new _n(b,e,null,n,r),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Un(n))&&(b.data=y))),(y=Fn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Nn=!0,jn);case"textInput":return(e=t.data)===jn&&Nn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!In&&Bn(e,t)?(e=en(),Jt=$t=Qt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=qi(i,"onBeforeInput")).length&&(r=new _n("onBeforeInput","beforeinput",null,n,r),s.push({event:r,listeners:i}),r.data=y))}ji(s,t)}))}function Hi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=Oe(e,n))&&i.unshift(Hi(e,o,r)),null!=(o=Oe(e,t))&&i.push(Hi(e,o,r))),e=e.return}return i}function Xi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Zi(e,t,n,i,r){for(var o=t._reactName,s=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Oe(n,o))&&s.unshift(Hi(n,l,a)):r||null!=(l=Oe(n,o))&&s.push(Hi(n,l,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Yi=/\r\n?/g,Ki=/\u0000|\uFFFD/g;function Qi(e){return("string"===typeof e?e:""+e).replace(Yi,"\n").replace(Ki,"")}function $i(e,t,n){if(t=Qi(t),Qi(e)!==t&&n)throw Error(o(425))}function Ji(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,or="function"===typeof Promise?Promise:void 0,sr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof or?function(e){return or.resolve(null).then(e).catch(ar)}:ir;function ar(e){setTimeout((function(){throw e}))}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void Vt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Vt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var dr=Math.random().toString(36).slice(2),hr="__reactFiber$"+dr,fr="__reactProps$"+dr,pr="__reactContainer$"+dr,gr="__reactEvents$"+dr,mr="__reactListeners$"+dr,vr="__reactHandles$"+dr;function yr(e){var t=e[hr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pr]||n[hr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[hr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function br(e){return!(e=e[hr]||e[pr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _r(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function wr(e){return e[fr]||null}var xr=[],Pr=-1;function Sr(e){return{current:e}}function Er(e){0>Pr||(e.current=xr[Pr],xr[Pr]=null,Pr--)}function Tr(e,t){Pr++,xr[Pr]=e.current,e.current=t}var Cr={},Ar=Sr(Cr),kr=Sr(!1),Mr=Cr;function Lr(e,t){var n=e.type.contextTypes;if(!n)return Cr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Or(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Rr(){Er(kr),Er(Ar)}function Ir(e,t,n){if(Ar.current!==Cr)throw Error(o(168));Tr(Ar,t),Tr(kr,n)}function zr(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(o(108,W(e)||"Unknown",r));return D({},n,i)}function Fr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cr,Mr=Ar.current,Tr(Ar,e),Tr(kr,kr.current),!0}function Dr(e,t,n){var i=e.stateNode;if(!i)throw Error(o(169));n?(e=zr(e,t,Mr),i.__reactInternalMemoizedMergedChildContext=e,Er(kr),Er(Ar),Tr(Ar,e)):Er(kr),Tr(kr,n)}var jr=null,Nr=!1,Br=!1;function Ur(e){null===jr?jr=[e]:jr.push(e)}function Vr(){if(!Br&&null!==jr){Br=!0;var e=0,t=bt;try{var n=jr;for(bt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}jr=null,Nr=!1}catch(r){throw null!==jr&&(jr=jr.slice(e+1)),Xe(Je,Vr),r}finally{bt=t,Br=!1}}return null}var Wr=[],Gr=0,Hr=null,qr=0,Xr=[],Zr=0,Yr=null,Kr=1,Qr="";function $r(e,t){Wr[Gr++]=qr,Wr[Gr++]=Hr,Hr=e,qr=t}function Jr(e,t,n){Xr[Zr++]=Kr,Xr[Zr++]=Qr,Xr[Zr++]=Yr,Yr=e;var i=Kr;e=Qr;var r=32-st(i)-1;i&=~(1<<r),n+=1;var o=32-st(t)+r;if(30<o){var s=r-r%5;o=(i&(1<<s)-1).toString(32),i>>=s,r-=s,Kr=1<<32-st(t)+r|n<<r|i,Qr=o+e}else Kr=1<<o|n<<r|i,Qr=e}function eo(e){null!==e.return&&($r(e,1),Jr(e,1,0))}function to(e){for(;e===Hr;)Hr=Wr[--Gr],Wr[Gr]=null,qr=Wr[--Gr],Wr[Gr]=null;for(;e===Yr;)Yr=Xr[--Zr],Xr[Zr]=null,Qr=Xr[--Zr],Xr[Zr]=null,Kr=Xr[--Zr],Xr[Zr]=null}var no=null,io=null,ro=!1,oo=null;function so(e,t){var n=Oc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ao(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,io=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,io=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yr?{id:Kr,overflow:Qr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Oc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,io=null,!0);default:return!1}}function lo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function co(e){if(ro){var t=io;if(t){var n=t;if(!ao(e,t)){if(lo(e))throw Error(o(418));t=cr(n.nextSibling);var i=no;t&&ao(e,t)?so(i,n):(e.flags=-4097&e.flags|2,ro=!1,no=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,ro=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!ro)return uo(e),ro=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=io)){if(lo(e))throw fo(),Error(o(418));for(;t;)so(e,t),t=cr(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){io=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}io=null}}else io=no?cr(e.stateNode.nextSibling):null;return!0}function fo(){for(var e=io;e;)e=cr(e.nextSibling)}function po(){io=no=null,ro=!1}function go(e){null===oo?oo=[e]:oo.push(e)}var mo=_.ReactCurrentBatchConfig;function vo(e,t){if(e&&e.defaultProps){for(var n in t=D({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var yo=Sr(null),bo=null,_o=null,wo=null;function xo(){wo=_o=bo=null}function Po(e){var t=yo.current;Er(yo),e._currentValue=t}function So(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Eo(e,t){bo=e,wo=_o=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_a=!0),e.firstContext=null)}function To(e){var t=e._currentValue;if(wo!==e)if(e={context:e,memoizedValue:t,next:null},null===_o){if(null===bo)throw Error(o(308));_o=e,bo.dependencies={lanes:0,firstContext:e}}else _o=_o.next=e;return t}var Co=null;function Ao(e){null===Co?Co=[e]:Co.push(e)}function ko(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Ao(t)):(n.next=r.next,r.next=n),t.interleaved=n,Mo(e,i)}function Mo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Lo=!1;function Oo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ro(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Io(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zo(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&kl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Mo(e,n)}return null===(r=i.interleaved)?(t.next=t,Ao(i)):(t.next=r.next,r.next=t),i.interleaved=t,Mo(e,n)}function Fo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Do(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?r=o=t:o=o.next=t}else r=o=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function jo(e,t,n,i){var r=e.updateQueue;Lo=!1;var o=r.firstBaseUpdate,s=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=r.baseState;for(s=0,u=c=l=null,a=o;;){var h=a.lane,f=a.eventTime;if((i&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(h=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(f,d,h):p)||void 0===h)break e;d=D({},d,h);break e;case 2:Lo=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,s|=h;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(h=a).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===u&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{s|=r.lane,r=r.next}while(r!==t)}else null===o&&(r.shared.lanes=0);Dl|=s,e.lanes=s,e.memoizedState=d}}function No(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(o(191,r));r.call(i)}}}var Bo=(new i.Component).refs;function Uo(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:D({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Vo={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=tc(),r=nc(e),o=Io(i,r);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,r))&&(ic(t,e,r,i),Fo(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=tc(),r=nc(e),o=Io(i,r);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,r))&&(ic(t,e,r,i),Fo(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),i=nc(e),r=Io(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=zo(e,r,i))&&(ic(t,e,i,n),Fo(t,e,i))}};function Wo(e,t,n,i,r,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,o))}function Go(e,t,n){var i=!1,r=Cr,o=t.contextType;return"object"===typeof o&&null!==o?o=To(o):(r=Or(t)?Mr:Ar.current,o=(i=null!==(i=t.contextTypes)&&void 0!==i)?Lr(e,r):Cr),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Vo,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=o),t}function Ho(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Vo.enqueueReplaceState(t,t.state,null)}function qo(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=Bo,Oo(e);var o=t.contextType;"object"===typeof o&&null!==o?r.context=To(o):(o=Or(t)?Mr:Ar.current,r.context=Lr(e,o)),r.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(Uo(e,t,o,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&Vo.enqueueReplaceState(r,r.state,null),jo(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function Xo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var i=n.stateNode}if(!i)throw Error(o(147,e));var r=i,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=r.refs;t===Bo&&(t=r.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function Zo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yo(e){return(0,e._init)(e._payload)}function Ko(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Ic(e,t)).index=0,e.sibling=null,e}function s(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=jc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var o=n.type;return o===P?d(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===O&&Yo(o)===t.type)?((i=r(t,n.props)).ref=Xo(e,t,n),i.return=e,i):((i=zc(n.type,n.key,n.props,null,e.mode,i)).ref=Xo(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Nc(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,i,o){return null===t||7!==t.tag?((t=Fc(n,e.mode,i,o)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=jc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=zc(t.type,t.key,t.props,null,e.mode,n)).ref=Xo(e,null,t),n.return=e,n;case x:return(t=Nc(t,e.mode,n)).return=e,t;case O:return h(e,(0,t._init)(t._payload),n)}if(te(t)||z(t))return(t=Fc(t,e.mode,n,null)).return=e,t;Zo(e,t)}return null}function f(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===r?c(e,t,n,i):null;case x:return n.key===r?u(e,t,n,i):null;case O:return f(e,t,(r=n._init)(n._payload),i)}if(te(n)||z(n))return null!==r?null:d(e,t,n,i,null);Zo(e,n)}return null}function p(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case w:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case x:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case O:return p(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||z(i))return d(t,e=e.get(n)||null,i,r,null);Zo(t,i)}return null}function g(r,o,a,l){for(var c=null,u=null,d=o,g=o=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var v=f(r,d,a[g],l);if(null===v){null===d&&(d=m);break}e&&d&&null===v.alternate&&t(r,d),o=s(v,o,g),null===u?c=v:u.sibling=v,u=v,d=m}if(g===a.length)return n(r,d),ro&&$r(r,g),c;if(null===d){for(;g<a.length;g++)null!==(d=h(r,a[g],l))&&(o=s(d,o,g),null===u?c=d:u.sibling=d,u=d);return ro&&$r(r,g),c}for(d=i(r,d);g<a.length;g++)null!==(m=p(d,r,g,a[g],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),o=s(m,o,g),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(r,e)})),ro&&$r(r,g),c}function m(r,a,l,c){var u=z(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var d=u=null,g=a,m=a=0,v=null,y=l.next();null!==g&&!y.done;m++,y=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=f(r,g,y.value,c);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(r,g),a=s(b,a,m),null===d?u=b:d.sibling=b,d=b,g=v}if(y.done)return n(r,g),ro&&$r(r,m),u;if(null===g){for(;!y.done;m++,y=l.next())null!==(y=h(r,y.value,c))&&(a=s(y,a,m),null===d?u=y:d.sibling=y,d=y);return ro&&$r(r,m),u}for(g=i(r,g);!y.done;m++,y=l.next())null!==(y=p(g,r,m,y.value,c))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),a=s(y,a,m),null===d?u=y:d.sibling=y,d=y);return e&&g.forEach((function(e){return t(r,e)})),ro&&$r(r,m),u}return function e(i,o,s,l){if("object"===typeof s&&null!==s&&s.type===P&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case w:e:{for(var c=s.key,u=o;null!==u;){if(u.key===c){if((c=s.type)===P){if(7===u.tag){n(i,u.sibling),(o=r(u,s.props.children)).return=i,i=o;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===O&&Yo(c)===u.type){n(i,u.sibling),(o=r(u,s.props)).ref=Xo(i,u,s),o.return=i,i=o;break e}n(i,u);break}t(i,u),u=u.sibling}s.type===P?((o=Fc(s.props.children,i.mode,l,s.key)).return=i,i=o):((l=zc(s.type,s.key,s.props,null,i.mode,l)).ref=Xo(i,o,s),l.return=i,i=l)}return a(i);case x:e:{for(u=s.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){n(i,o.sibling),(o=r(o,s.children||[])).return=i,i=o;break e}n(i,o);break}t(i,o),o=o.sibling}(o=Nc(s,i.mode,l)).return=i,i=o}return a(i);case O:return e(i,o,(u=s._init)(s._payload),l)}if(te(s))return g(i,o,s,l);if(z(s))return m(i,o,s,l);Zo(i,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==o&&6===o.tag?(n(i,o.sibling),(o=r(o,s)).return=i,i=o):(n(i,o),(o=jc(s,i.mode,l)).return=i,i=o),a(i)):n(i,o)}}var Qo=Ko(!0),$o=Ko(!1),Jo={},es=Sr(Jo),ts=Sr(Jo),ns=Sr(Jo);function is(e){if(e===Jo)throw Error(o(174));return e}function rs(e,t){switch(Tr(ns,t),Tr(ts,e),Tr(es,Jo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Er(es),Tr(es,t)}function os(){Er(es),Er(ts),Er(ns)}function ss(e){is(ns.current);var t=is(es.current),n=le(t,e.type);t!==n&&(Tr(ts,e),Tr(es,n))}function as(e){ts.current===e&&(Er(es),Er(ts))}var ls=Sr(0);function cs(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var us=[];function ds(){for(var e=0;e<us.length;e++)us[e]._workInProgressVersionPrimary=null;us.length=0}var hs=_.ReactCurrentDispatcher,fs=_.ReactCurrentBatchConfig,ps=0,gs=null,ms=null,vs=null,ys=!1,bs=!1,_s=0,ws=0;function xs(){throw Error(o(321))}function Ps(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ai(e[n],t[n]))return!1;return!0}function Ss(e,t,n,i,r,s){if(ps=s,gs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hs.current=null===e||null===e.memoizedState?aa:la,e=n(i,r),bs){s=0;do{if(bs=!1,_s=0,25<=s)throw Error(o(301));s+=1,vs=ms=null,t.updateQueue=null,hs.current=ca,e=n(i,r)}while(bs)}if(hs.current=sa,t=null!==ms&&null!==ms.next,ps=0,vs=ms=gs=null,ys=!1,t)throw Error(o(300));return e}function Es(){var e=0!==_s;return _s=0,e}function Ts(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===vs?gs.memoizedState=vs=e:vs=vs.next=e,vs}function Cs(){if(null===ms){var e=gs.alternate;e=null!==e?e.memoizedState:null}else e=ms.next;var t=null===vs?gs.memoizedState:vs.next;if(null!==t)vs=t,ms=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ms=e).memoizedState,baseState:ms.baseState,baseQueue:ms.baseQueue,queue:ms.queue,next:null},null===vs?gs.memoizedState=vs=e:vs=vs.next=e}return vs}function As(e,t){return"function"===typeof t?t(e):t}function ks(e){var t=Cs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var i=ms,r=i.baseQueue,s=n.pending;if(null!==s){if(null!==r){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,n.pending=null}if(null!==r){s=r.next,i=i.baseState;var l=a=null,c=null,u=s;do{var d=u.lane;if((ps&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,a=i):c=c.next=h,gs.lanes|=d,Dl|=d}u=u.next}while(null!==u&&u!==s);null===c?a=i:c.next=l,ai(i,t.memoizedState)||(_a=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{s=r.lane,gs.lanes|=s,Dl|=s,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ms(e){var t=Cs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{s=e(s,a.action),a=a.next}while(a!==r);ai(s,t.memoizedState)||(_a=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function Ls(){}function Os(e,t){var n=gs,i=Cs(),r=t(),s=!ai(i.memoizedState,r);if(s&&(i.memoizedState=r,_a=!0),i=i.queue,Gs(zs.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||null!==vs&&1&vs.memoizedState.tag){if(n.flags|=2048,Ns(9,Is.bind(null,n,i,r,t),void 0,null),null===Ml)throw Error(o(349));0!==(30&ps)||Rs(n,t,r)}return r}function Rs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=gs.updateQueue)?(t={lastEffect:null,stores:null},gs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Is(e,t,n,i){t.value=n,t.getSnapshot=i,Fs(t)&&Ds(e)}function zs(e,t,n){return n((function(){Fs(t)&&Ds(e)}))}function Fs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ai(e,n)}catch(i){return!0}}function Ds(e){var t=Mo(e,1);null!==t&&ic(t,e,1,-1)}function js(e){var t=Ts();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:As,lastRenderedState:e},t.queue=e,e=e.dispatch=na.bind(null,gs,e),[t.memoizedState,e]}function Ns(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=gs.updateQueue)?(t={lastEffect:null,stores:null},gs.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Bs(){return Cs().memoizedState}function Us(e,t,n,i){var r=Ts();gs.flags|=e,r.memoizedState=Ns(1|t,n,void 0,void 0===i?null:i)}function Vs(e,t,n,i){var r=Cs();i=void 0===i?null:i;var o=void 0;if(null!==ms){var s=ms.memoizedState;if(o=s.destroy,null!==i&&Ps(i,s.deps))return void(r.memoizedState=Ns(t,n,o,i))}gs.flags|=e,r.memoizedState=Ns(1|t,n,o,i)}function Ws(e,t){return Us(8390656,8,e,t)}function Gs(e,t){return Vs(2048,8,e,t)}function Hs(e,t){return Vs(4,2,e,t)}function qs(e,t){return Vs(4,4,e,t)}function Xs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Zs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Vs(4,4,Xs.bind(null,t,e),n)}function Ys(){}function Ks(e,t){var n=Cs();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Ps(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Qs(e,t){var n=Cs();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Ps(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function $s(e,t,n){return 0===(21&ps)?(e.baseState&&(e.baseState=!1,_a=!0),e.memoizedState=n):(ai(n,t)||(n=gt(),gs.lanes|=n,Dl|=n,e.baseState=!0),t)}function Js(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var i=fs.transition;fs.transition={};try{e(!1),t()}finally{bt=n,fs.transition=i}}function ea(){return Cs().memoizedState}function ta(e,t,n){var i=nc(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},ia(e))ra(t,n);else if(null!==(n=ko(e,t,n,i))){ic(n,e,i,tc()),oa(n,t,i)}}function na(e,t,n){var i=nc(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(ia(e))ra(t,r);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(r.hasEagerState=!0,r.eagerState=a,ai(a,s)){var l=t.interleaved;return null===l?(r.next=r,Ao(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=ko(e,t,r,i))&&(ic(n,e,i,r=tc()),oa(n,t,i))}}function ia(e){var t=e.alternate;return e===gs||null!==t&&t===gs}function ra(e,t){bs=ys=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function oa(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}var sa={readContext:To,useCallback:xs,useContext:xs,useEffect:xs,useImperativeHandle:xs,useInsertionEffect:xs,useLayoutEffect:xs,useMemo:xs,useReducer:xs,useRef:xs,useState:xs,useDebugValue:xs,useDeferredValue:xs,useTransition:xs,useMutableSource:xs,useSyncExternalStore:xs,useId:xs,unstable_isNewReconciler:!1},aa={readContext:To,useCallback:function(e,t){return Ts().memoizedState=[e,void 0===t?null:t],e},useContext:To,useEffect:Ws,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Us(4194308,4,Xs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Us(4194308,4,e,t)},useInsertionEffect:function(e,t){return Us(4,2,e,t)},useMemo:function(e,t){var n=Ts();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Ts();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=ta.bind(null,gs,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},Ts().memoizedState=e},useState:js,useDebugValue:Ys,useDeferredValue:function(e){return Ts().memoizedState=e},useTransition:function(){var e=js(!1),t=e[0];return e=Js.bind(null,e[1]),Ts().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=gs,r=Ts();if(ro){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Ml)throw Error(o(349));0!==(30&ps)||Rs(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,Ws(zs.bind(null,i,s,e),[e]),i.flags|=2048,Ns(9,Is.bind(null,i,s,n,t),void 0,null),n},useId:function(){var e=Ts(),t=Ml.identifierPrefix;if(ro){var n=Qr;t=":"+t+"R"+(n=(Kr&~(1<<32-st(Kr)-1)).toString(32)+n),0<(n=_s++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ws++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},la={readContext:To,useCallback:Ks,useContext:To,useEffect:Gs,useImperativeHandle:Zs,useInsertionEffect:Hs,useLayoutEffect:qs,useMemo:Qs,useReducer:ks,useRef:Bs,useState:function(){return ks(As)},useDebugValue:Ys,useDeferredValue:function(e){return $s(Cs(),ms.memoizedState,e)},useTransition:function(){return[ks(As)[0],Cs().memoizedState]},useMutableSource:Ls,useSyncExternalStore:Os,useId:ea,unstable_isNewReconciler:!1},ca={readContext:To,useCallback:Ks,useContext:To,useEffect:Gs,useImperativeHandle:Zs,useInsertionEffect:Hs,useLayoutEffect:qs,useMemo:Qs,useReducer:Ms,useRef:Bs,useState:function(){return Ms(As)},useDebugValue:Ys,useDeferredValue:function(e){var t=Cs();return null===ms?t.memoizedState=e:$s(t,ms.memoizedState,e)},useTransition:function(){return[Ms(As)[0],Cs().memoizedState]},useMutableSource:Ls,useSyncExternalStore:Os,useId:ea,unstable_isNewReconciler:!1};function ua(e,t){try{var n="",i=t;do{n+=U(i),i=i.return}while(i);var r=n}catch(o){r="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:r,digest:null}}function da(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var fa="function"===typeof WeakMap?WeakMap:Map;function pa(e,t,n){(n=Io(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Hl||(Hl=!0,ql=i),ha(0,t)},n}function ga(e,t,n){(n=Io(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){ha(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){ha(0,t),"function"!==typeof i&&(null===Xl?Xl=new Set([this]):Xl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new fa;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Tc.bind(null,e,t,n),t.then(e,e))}function va(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Io(-1,1)).tag=2,zo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var ba=_.ReactCurrentOwner,_a=!1;function wa(e,t,n,i){t.child=null===e?$o(t,null,n,i):Qo(t,e.child,n,i)}function xa(e,t,n,i,r){n=n.render;var o=t.ref;return Eo(t,r),i=Ss(e,t,n,i,o,r),n=Es(),null===e||_a?(ro&&n&&eo(t),t.flags|=1,wa(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ha(e,t,r))}function Pa(e,t,n,i,r){if(null===e){var o=n.type;return"function"!==typeof o||Rc(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=zc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Sa(e,t,o,i,r))}if(o=e.child,0===(e.lanes&r)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:li)(s,i)&&e.ref===t.ref)return Ha(e,t,r)}return t.flags|=1,(e=Ic(o,i)).ref=t.ref,e.return=t,t.child=e}function Sa(e,t,n,i,r){if(null!==e){var o=e.memoizedProps;if(li(o,i)&&e.ref===t.ref){if(_a=!1,t.pendingProps=i=o,0===(e.lanes&r))return t.lanes=e.lanes,Ha(e,t,r);0!==(131072&e.flags)&&(_a=!0)}}return Ca(e,t,n,i,r)}function Ea(e,t,n){var i=t.pendingProps,r=i.children,o=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tr(Il,Rl),Rl|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Tr(Il,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==o?o.baseLanes:n,Tr(Il,Rl),Rl|=i}else null!==o?(i=o.baseLanes|n,t.memoizedState=null):i=n,Tr(Il,Rl),Rl|=i;return wa(e,t,r,n),t.child}function Ta(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ca(e,t,n,i,r){var o=Or(n)?Mr:Ar.current;return o=Lr(t,o),Eo(t,r),n=Ss(e,t,n,i,o,r),i=Es(),null===e||_a?(ro&&i&&eo(t),t.flags|=1,wa(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ha(e,t,r))}function Aa(e,t,n,i,r){if(Or(n)){var o=!0;Fr(t)}else o=!1;if(Eo(t,r),null===t.stateNode)Ga(e,t),Go(t,n,i),qo(t,n,i,r),i=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=To(c):c=Lr(t,c=Or(n)?Mr:Ar.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==i||l!==c)&&Ho(t,s,i,c),Lo=!1;var h=t.memoizedState;s.state=h,jo(t,i,s,r),l=t.memoizedState,a!==i||h!==l||kr.current||Lo?("function"===typeof u&&(Uo(t,n,u,i),l=t.memoizedState),(a=Lo||Wo(t,n,a,i,h,l,c))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),s.props=i,s.state=l,s.context=c,i=a):("function"===typeof s.componentDidMount&&(t.flags|=4194308),i=!1)}else{s=t.stateNode,Ro(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:vo(t.type,a),s.props=c,d=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=To(l):l=Lr(t,l=Or(n)?Mr:Ar.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==d||h!==l)&&Ho(t,s,i,l),Lo=!1,h=t.memoizedState,s.state=h,jo(t,i,s,r);var p=t.memoizedState;a!==d||h!==p||kr.current||Lo?("function"===typeof f&&(Uo(t,n,f,i),p=t.memoizedState),(c=Lo||Wo(t,n,c,i,h,p,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(i,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),s.props=i,s.state=p,s.context=l,i=c):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return ka(e,t,n,i,o,r)}function ka(e,t,n,i,r,o){Ta(e,t);var s=0!==(128&t.flags);if(!i&&!s)return r&&Dr(t,n,!1),Ha(e,t,o);i=t.stateNode,ba.current=t;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&s?(t.child=Qo(t,e.child,null,o),t.child=Qo(t,null,a,o)):wa(e,t,a,o),t.memoizedState=i.state,r&&Dr(t,n,!0),t.child}function Ma(e){var t=e.stateNode;t.pendingContext?Ir(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ir(0,t.context,!1),rs(e,t.containerInfo)}function La(e,t,n,i,r){return po(),go(r),t.flags|=256,wa(e,t,n,i),t.child}var Oa,Ra,Ia,za,Fa={dehydrated:null,treeContext:null,retryLane:0};function Da(e){return{baseLanes:e,cachePool:null,transitions:null}}function ja(e,t,n){var i,r=t.pendingProps,s=ls.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&s)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Tr(ls,1&s),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Dc(l,r,0,null),e=Fc(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Da(n),t.memoizedState=Fa,e):Na(t,l));if(null!==(s=e.memoizedState)&&null!==(i=s.dehydrated))return function(e,t,n,i,r,s,a){if(n)return 256&t.flags?(t.flags&=-257,Ba(e,t,a,i=da(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=i.fallback,r=t.mode,i=Dc({mode:"visible",children:i.children},r,0,null),(s=Fc(s,r,a,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,0!==(1&t.mode)&&Qo(t,e.child,null,a),t.child.memoizedState=Da(a),t.memoizedState=Fa,s);if(0===(1&t.mode))return Ba(e,t,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Ba(e,t,a,i=da(s=Error(o(419)),i,void 0))}if(l=0!==(a&e.childLanes),_a||l){if(null!==(i=Ml)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|a))?0:r)&&r!==s.retryLane&&(s.retryLane=r,Mo(e,r),ic(i,e,r,-1))}return mc(),Ba(e,t,a,i=da(Error(o(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Ac.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,io=cr(r.nextSibling),no=t,ro=!0,oo=null,null!==e&&(Xr[Zr++]=Kr,Xr[Zr++]=Qr,Xr[Zr++]=Yr,Kr=e.id,Qr=e.overflow,Yr=t),t=Na(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,s,n);if(a){a=r.fallback,l=t.mode,i=(s=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==s?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Ic(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==i?a=Ic(i,a):(a=Fc(a,l,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=null===(l=e.child.memoizedState)?Da(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Fa,r}return e=(a=e.child).sibling,r=Ic(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Na(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ba(e,t,n,i){return null!==i&&go(i),Qo(t,e.child,null,n),(e=Na(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ua(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),So(e.return,t,n)}function Va(e,t,n,i,r){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r)}function Wa(e,t,n){var i=t.pendingProps,r=i.revealOrder,o=i.tail;if(wa(e,t,i.children,n),0!==(2&(i=ls.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ua(e,n,t);else if(19===e.tag)Ua(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Tr(ls,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===cs(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Va(t,!1,r,n,o);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===cs(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Va(t,!0,n,null,o);break;case"together":Va(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ga(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ha(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Dl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Ic(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ic(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qa(e,t){if(!ro)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Xa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Za(e,t,n){var i=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xa(t),null;case 1:case 17:return Or(t.type)&&Rr(),Xa(t),null;case 3:return i=t.stateNode,os(),Er(kr),Er(Ar),ds(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(ac(oo),oo=null))),Ra(e,t),Xa(t),null;case 5:as(t);var r=is(ns.current);if(n=t.type,null!==e&&null!=t.stateNode)Ia(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(o(166));return Xa(t),null}if(e=is(es.current),ho(t)){i=t.stateNode,n=t.type;var s=t.memoizedProps;switch(i[hr]=t,i[fr]=s,e=0!==(1&t.mode),n){case"dialog":Ni("cancel",i),Ni("close",i);break;case"iframe":case"object":case"embed":Ni("load",i);break;case"video":case"audio":for(r=0;r<zi.length;r++)Ni(zi[r],i);break;case"source":Ni("error",i);break;case"img":case"image":case"link":Ni("error",i),Ni("load",i);break;case"details":Ni("toggle",i);break;case"input":K(i,s),Ni("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Ni("invalid",i);break;case"textarea":re(i,s),Ni("invalid",i)}for(var l in ye(n,s),r=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==s.suppressHydrationWarning&&$i(i.textContent,c,e),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&$i(i.textContent,c,e),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ni("scroll",i)}switch(n){case"input":q(i),J(i,s,!0);break;case"textarea":q(i),se(i);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(i.onclick=Ji)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[hr]=t,e[fr]=i,Oa(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,i),n){case"dialog":Ni("cancel",e),Ni("close",e),r=i;break;case"iframe":case"object":case"embed":Ni("load",e),r=i;break;case"video":case"audio":for(r=0;r<zi.length;r++)Ni(zi[r],e);r=i;break;case"source":Ni("error",e),r=i;break;case"img":case"image":case"link":Ni("error",e),Ni("load",e),r=i;break;case"details":Ni("toggle",e),r=i;break;case"input":K(e,i),r=Y(e,i),Ni("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=D({},i,{value:void 0}),Ni("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Ni("invalid",e)}for(s in ye(n,r),c=r)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?me(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Ni("scroll",e):null!=u&&b(e,s,u,l))}switch(n){case"input":q(e),J(e,i,!1);break;case"textarea":q(e),se(e);break;case"option":null!=i.value&&e.setAttribute("value",""+G(i.value));break;case"select":e.multiple=!!i.multiple,null!=(s=i.value)?ne(e,!!i.multiple,s,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Ji)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Xa(t),null;case 6:if(e&&null!=t.stateNode)za(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(o(166));if(n=is(ns.current),is(es.current),ho(t)){if(i=t.stateNode,n=t.memoizedProps,i[hr]=t,(s=i.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:$i(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$i(i.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[hr]=t,t.stateNode=i}return Xa(t),null;case 13:if(Er(ls),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ro&&null!==io&&0!==(1&t.mode)&&0===(128&t.flags))fo(),po(),t.flags|=98560,s=!1;else if(s=ho(t),null!==i&&null!==i.dehydrated){if(null===e){if(!s)throw Error(o(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(o(317));s[hr]=t}else po(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Xa(t),s=!1}else null!==oo&&(ac(oo),oo=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ls.current)?0===zl&&(zl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Xa(t),null);case 4:return os(),Ra(e,t),null===e&&Vi(t.stateNode.containerInfo),Xa(t),null;case 10:return Po(t.type._context),Xa(t),null;case 19:if(Er(ls),null===(s=t.memoizedState))return Xa(t),null;if(i=0!==(128&t.flags),null===(l=s.rendering))if(i)qa(s,!1);else{if(0!==zl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=cs(e))){for(t.flags|=128,qa(s,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Tr(ls,1&ls.current|2),t.child}e=e.sibling}null!==s.tail&&Qe()>Wl&&(t.flags|=128,i=!0,qa(s,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=cs(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qa(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ro)return Xa(t),null}else 2*Qe()-s.renderingStartTime>Wl&&1073741824!==n&&(t.flags|=128,i=!0,qa(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Qe(),t.sibling=null,n=ls.current,Tr(ls,i?1&n|2:1&n),t):(Xa(t),null);case 22:case 23:return hc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Rl)&&(Xa(t),6&t.subtreeFlags&&(t.flags|=8192)):Xa(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ya(e,t){switch(to(t),t.tag){case 1:return Or(t.type)&&Rr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return os(),Er(kr),Er(Ar),ds(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return as(t),null;case 13:if(Er(ls),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));po()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Er(ls),null;case 4:return os(),null;case 10:return Po(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Oa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ra=function(){},Ia=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,is(es.current);var o,s=null;switch(n){case"input":r=Y(e,r),i=Y(e,i),s=[];break;case"select":r=D({},r,{value:void 0}),i=D({},i,{value:void 0}),s=[];break;case"textarea":r=ie(e,r),i=ie(e,i),s=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=Ji)}for(u in ye(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ni("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},za=function(e,t,n,i){n!==i&&(t.flags|=4)};var Ka=!1,Qa=!1,$a="function"===typeof WeakSet?WeakSet:Set,Ja=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Ec(e,t,i)}else n.current=null}function tl(e,t,n){try{n()}catch(i){Ec(e,t,i)}}var nl=!1;function il(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var o=r.destroy;r.destroy=void 0,void 0!==o&&tl(t,n,o)}r=r.next}while(r!==i)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function ol(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hr],delete t[fr],delete t[gr],delete t[mr],delete t[vr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Ji));else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var dl=null,hl=!1;function fl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(rt,n)}catch(a){}switch(n.tag){case 5:Qa||el(n,t);case 6:var i=dl,r=hl;dl=null,fl(e,t,n),hl=r,null!==(dl=i)&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),Vt(e)):lr(dl,n.stateNode));break;case 4:i=dl,r=hl,dl=n.stateNode.containerInfo,hl=!0,fl(e,t,n),dl=i,hl=r;break;case 0:case 11:case 14:case 15:if(!Qa&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var o=r,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&tl(n,t,s),r=r.next}while(r!==i)}fl(e,t,n);break;case 1:if(!Qa&&(el(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Ec(n,t,a)}fl(e,t,n);break;case 21:fl(e,t,n);break;case 22:1&n.mode?(Qa=(i=Qa)||null!==n.memoizedState,fl(e,t,n),Qa=i):fl(e,t,n);break;default:fl(e,t,n)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $a),t.forEach((function(t){var i=kc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,hl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===dl)throw Error(o(160));pl(s,a,r),dl=null,hl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){Ec(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&i){try{il(3,e,e.return),rl(3,e)}catch(m){Ec(e,e.return,m)}try{il(5,e,e.return)}catch(m){Ec(e,e.return,m)}}break;case 1:ml(t,e),yl(e),512&i&&null!==n&&el(n,n.return);break;case 5:if(ml(t,e),yl(e),512&i&&null!==n&&el(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(m){Ec(e,e.return,m)}}if(4&i&&null!=(r=e.stateNode)){var s=e.memoizedProps,a=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&Q(r,s),be(l,a);var u=be(l,s);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];"style"===d?me(r,h):"dangerouslySetInnerHTML"===d?de(r,h):"children"===d?he(r,h):b(r,d,h,u)}switch(l){case"input":$(r,s);break;case"textarea":oe(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?ne(r,!!s.multiple,p,!1):f!==!!s.multiple&&(null!=s.defaultValue?ne(r,!!s.multiple,s.defaultValue,!0):ne(r,!!s.multiple,s.multiple?[]:"",!1))}r[fr]=s}catch(m){Ec(e,e.return,m)}}break;case 6:if(ml(t,e),yl(e),4&i){if(null===e.stateNode)throw Error(o(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(m){Ec(e,e.return,m)}}break;case 3:if(ml(t,e),yl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(m){Ec(e,e.return,m)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(r=e.child).flags&&(s=null!==r.memoizedState,r.stateNode.isHidden=s,!s||null!==r.alternate&&null!==r.alternate.memoizedState||(Vl=Qe())),4&i&&gl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Qa=(u=Qa)||d,ml(t,e),Qa=u):ml(t,e),yl(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Ja=e,d=e.child;null!==d;){for(h=Ja=d;null!==Ja;){switch(p=(f=Ja).child,f.tag){case 0:case 11:case 14:case 15:il(4,f,f.return);break;case 1:el(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){i=f,n=f.return;try{t=i,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Ec(i,n,m)}}break;case 5:el(f,f.return);break;case 22:if(null!==f.memoizedState){xl(h);continue}}null!==p?(p.return=f,Ja=p):xl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{r=h.stateNode,u?"function"===typeof(s=r.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,a=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",a))}catch(m){Ec(e,e.return,m)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){Ec(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),yl(e),4&i&&gl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var i=n;break e}n=n.return}throw Error(o(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(he(r,""),i.flags&=-33),ul(e,ll(e),r);break;case 3:case 4:var s=i.stateNode.containerInfo;cl(e,ll(e),s);break;default:throw Error(o(161))}}catch(a){Ec(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){Ja=e,_l(e,t,n)}function _l(e,t,n){for(var i=0!==(1&e.mode);null!==Ja;){var r=Ja,o=r.child;if(22===r.tag&&i){var s=null!==r.memoizedState||Ka;if(!s){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Qa;a=Ka;var c=Qa;if(Ka=s,(Qa=l)&&!c)for(Ja=r;null!==Ja;)l=(s=Ja).child,22===s.tag&&null!==s.memoizedState?Pl(r):null!==l?(l.return=s,Ja=l):Pl(r);for(;null!==o;)Ja=o,_l(o,t,n),o=o.sibling;Ja=r,Ka=a,Qa=c}wl(e)}else 0!==(8772&r.subtreeFlags)&&null!==o?(o.return=r,Ja=o):wl(e)}}function wl(e){for(;null!==Ja;){var t=Ja;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qa||rl(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Qa)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:vo(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&No(t,s,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}No(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(o(163))}Qa||512&t.flags&&ol(t)}catch(f){Ec(t,t.return,f)}}if(t===e){Ja=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ja=n;break}Ja=t.return}}function xl(e){for(;null!==Ja;){var t=Ja;if(t===e){Ja=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ja=n;break}Ja=t.return}}function Pl(e){for(;null!==Ja;){var t=Ja;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Ec(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){Ec(t,r,l)}}var o=t.return;try{ol(t)}catch(l){Ec(t,o,l)}break;case 5:var s=t.return;try{ol(t)}catch(l){Ec(t,s,l)}}}catch(l){Ec(t,t.return,l)}if(t===e){Ja=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Ja=a;break}Ja=t.return}}var Sl,El=Math.ceil,Tl=_.ReactCurrentDispatcher,Cl=_.ReactCurrentOwner,Al=_.ReactCurrentBatchConfig,kl=0,Ml=null,Ll=null,Ol=0,Rl=0,Il=Sr(0),zl=0,Fl=null,Dl=0,jl=0,Nl=0,Bl=null,Ul=null,Vl=0,Wl=1/0,Gl=null,Hl=!1,ql=null,Xl=null,Zl=!1,Yl=null,Kl=0,Ql=0,$l=null,Jl=-1,ec=0;function tc(){return 0!==(6&kl)?Qe():-1!==Jl?Jl:Jl=Qe()}function nc(e){return 0===(1&e.mode)?1:0!==(2&kl)&&0!==Ol?Ol&-Ol:null!==mo.transition?(0===ec&&(ec=gt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function ic(e,t,n,i){if(50<Ql)throw Ql=0,$l=null,Error(o(185));vt(e,n,i),0!==(2&kl)&&e===Ml||(e===Ml&&(0===(2&kl)&&(jl|=n),4===zl&&lc(e,Ol)),rc(e,i),1===n&&0===kl&&0===(1&t.mode)&&(Wl=Qe()+500,Nr&&Vr()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-st(o),a=1<<s,l=r[s];-1===l?0!==(a&n)&&0===(a&i)||(r[s]=ft(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var i=ht(e,e===Ml?Ol:0);if(0===i)null!==n&&Ze(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ze(n),1===t)0===e.tag?function(e){Nr=!0,Ur(e)}(cc.bind(null,e)):Ur(cc.bind(null,e)),sr((function(){0===(6&kl)&&Vr()})),n=null;else{switch(_t(i)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Mc(n,oc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function oc(e,t){if(Jl=-1,ec=0,0!==(6&kl))throw Error(o(327));var n=e.callbackNode;if(Pc()&&e.callbackNode!==n)return null;var i=ht(e,e===Ml?Ol:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=vc(e,i);else{t=i;var r=kl;kl|=2;var s=gc();for(Ml===e&&Ol===t||(Gl=null,Wl=Qe()+500,fc(e,t));;)try{bc();break}catch(l){pc(e,l)}xo(),Tl.current=s,kl=r,null!==Ll?t=0:(Ml=null,Ol=0,t=zl)}if(0!==t){if(2===t&&(0!==(r=pt(e))&&(i=r,t=sc(e,r))),1===t)throw n=Fl,fc(e,0),lc(e,i),rc(e,Qe()),n;if(6===t)lc(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!ai(o(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=vc(e,i))&&(0!==(s=pt(e))&&(i=s,t=sc(e,s))),1===t))throw n=Fl,fc(e,0),lc(e,i),rc(e,Qe()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(o(345));case 2:case 5:xc(e,Ul,Gl);break;case 3:if(lc(e,i),(130023424&i)===i&&10<(t=Vl+500-Qe())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&i)!==i){tc(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(xc.bind(null,e,Ul,Gl),t);break}xc(e,Ul,Gl);break;case 4:if(lc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-st(i);s=1<<a,(a=t[a])>r&&(r=a),i&=~s}if(i=r,10<(i=(120>(i=Qe()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*El(i/1960))-i)){e.timeoutHandle=ir(xc.bind(null,e,Ul,Gl),i);break}xc(e,Ul,Gl);break;default:throw Error(o(329))}}}return rc(e,Qe()),e.callbackNode===n?oc.bind(null,e):null}function sc(e,t){var n=Bl;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=Ul,Ul=n,null!==t&&ac(t)),e}function ac(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function lc(e,t){for(t&=~Nl,t&=~jl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),i=1<<n;e[n]=-1,t&=~i}}function cc(e){if(0!==(6&kl))throw Error(o(327));Pc();var t=ht(e,0);if(0===(1&t))return rc(e,Qe()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var i=pt(e);0!==i&&(t=i,n=sc(e,i))}if(1===n)throw n=Fl,fc(e,0),lc(e,t),rc(e,Qe()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,Ul,Gl),rc(e,Qe()),null}function uc(e,t){var n=kl;kl|=1;try{return e(t)}finally{0===(kl=n)&&(Wl=Qe()+500,Nr&&Vr())}}function dc(e){null!==Yl&&0===Yl.tag&&0===(6&kl)&&Pc();var t=kl;kl|=1;var n=Al.transition,i=bt;try{if(Al.transition=null,bt=1,e)return e()}finally{bt=i,Al.transition=n,0===(6&(kl=t))&&Vr()}}function hc(){Rl=Il.current,Er(Il)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Ll)for(n=Ll.return;null!==n;){var i=n;switch(to(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Rr();break;case 3:os(),Er(kr),Er(Ar),ds();break;case 5:as(i);break;case 4:os();break;case 13:case 19:Er(ls);break;case 10:Po(i.type._context);break;case 22:case 23:hc()}n=n.return}if(Ml=e,Ll=e=Ic(e.current,null),Ol=Rl=t,zl=0,Fl=null,Nl=jl=Dl=0,Ul=Bl=null,null!==Co){for(t=0;t<Co.length;t++)if(null!==(i=(n=Co[t]).interleaved)){n.interleaved=null;var r=i.next,o=n.pending;if(null!==o){var s=o.next;o.next=r,i.next=s}n.pending=i}Co=null}return e}function pc(e,t){for(;;){var n=Ll;try{if(xo(),hs.current=sa,ys){for(var i=gs.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}ys=!1}if(ps=0,vs=ms=gs=null,bs=!1,_s=0,Cl.current=null,null===n||null===n.return){zl=1,Fl=t,Ll=null;break}e:{var s=e,a=n.return,l=n,c=t;if(t=Ol,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=va(a);if(null!==p){p.flags&=-257,ya(p,a,l,0,t),1&p.mode&&ma(s,u,t),c=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){ma(s,u,t),mc();break e}c=Error(o(426))}else if(ro&&1&l.mode){var v=va(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),ya(v,a,l,0,t),go(ua(c,l));break e}}s=c=ua(c,l),4!==zl&&(zl=2),null===Bl?Bl=[s]:Bl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Do(s,pa(0,c,t));break e;case 1:l=c;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Xl||!Xl.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Do(s,ga(s,l,t));break e}}s=s.return}while(null!==s)}wc(n)}catch(_){t=_,Ll===n&&null!==n&&(Ll=n=n.return);continue}break}}function gc(){var e=Tl.current;return Tl.current=sa,null===e?sa:e}function mc(){0!==zl&&3!==zl&&2!==zl||(zl=4),null===Ml||0===(268435455&Dl)&&0===(268435455&jl)||lc(Ml,Ol)}function vc(e,t){var n=kl;kl|=2;var i=gc();for(Ml===e&&Ol===t||(Gl=null,fc(e,t));;)try{yc();break}catch(r){pc(e,r)}if(xo(),kl=n,Tl.current=i,null!==Ll)throw Error(o(261));return Ml=null,Ol=0,zl}function yc(){for(;null!==Ll;)_c(Ll)}function bc(){for(;null!==Ll&&!Ye();)_c(Ll)}function _c(e){var t=Sl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?wc(e):Ll=t,Cl.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Za(n,t,Rl)))return void(Ll=n)}else{if(null!==(n=Ya(n,t)))return n.flags&=32767,void(Ll=n);if(null===e)return zl=6,void(Ll=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ll=t);Ll=t=e}while(null!==t);0===zl&&(zl=5)}function xc(e,t,n){var i=bt,r=Al.transition;try{Al.transition=null,bt=1,function(e,t,n,i){do{Pc()}while(null!==Yl);if(0!==(6&kl))throw Error(o(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-st(n),o=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~o}}(e,s),e===Ml&&(Ll=Ml=null,Ol=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Zl||(Zl=!0,Mc(tt,(function(){return Pc(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Al.transition,Al.transition=null;var a=bt;bt=1;var l=kl;kl|=4,Cl.current=null,function(e,t){if(er=Gt,fi(e=hi())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch(w){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==r&&3!==h.nodeType||(l=a+r),h!==s||0!==i&&3!==h.nodeType||(c=a+i),3===h.nodeType&&(a+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===r&&(l=a),f===s&&++d===i&&(c=a),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Gt=!1,Ja=t;null!==Ja;)if(e=(t=Ja).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ja=e;else for(;null!==Ja;){t=Ja;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:vo(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(o(163))}}catch(w){Ec(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Ja=e;break}Ja=t.return}g=nl,nl=!1}(e,n),vl(n,e),pi(tr),Gt=!!er,tr=er=null,e.current=n,bl(n,e,r),Ke(),kl=l,bt=a,Al.transition=s}else e.current=n;if(Zl&&(Zl=!1,Yl=e,Kl=r),s=e.pendingLanes,0===s&&(Xl=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Qe()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Hl)throw Hl=!1,e=ql,ql=null,e;0!==(1&Kl)&&0!==e.tag&&Pc(),s=e.pendingLanes,0!==(1&s)?e===$l?Ql++:(Ql=0,$l=e):Ql=0,Vr()}(e,t,n,i)}finally{Al.transition=r,bt=i}return null}function Pc(){if(null!==Yl){var e=_t(Kl),t=Al.transition,n=bt;try{if(Al.transition=null,bt=16>e?16:e,null===Yl)var i=!1;else{if(e=Yl,Yl=null,Kl=0,0!==(6&kl))throw Error(o(331));var r=kl;for(kl|=4,Ja=e.current;null!==Ja;){var s=Ja,a=s.child;if(0!==(16&Ja.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Ja=u;null!==Ja;){var d=Ja;switch(d.tag){case 0:case 11:case 15:il(8,d,s)}var h=d.child;if(null!==h)h.return=d,Ja=h;else for(;null!==Ja;){var f=(d=Ja).sibling,p=d.return;if(sl(d),d===u){Ja=null;break}if(null!==f){f.return=p,Ja=f;break}Ja=p}}}var g=s.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Ja=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,Ja=a;else e:for(;null!==Ja;){if(0!==(2048&(s=Ja).flags))switch(s.tag){case 0:case 11:case 15:il(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Ja=y;break e}Ja=s.return}}var b=e.current;for(Ja=b;null!==Ja;){var _=(a=Ja).child;if(0!==(2064&a.subtreeFlags)&&null!==_)_.return=a,Ja=_;else e:for(a=b;null!==Ja;){if(0!==(2048&(l=Ja).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(x){Ec(l,l.return,x)}if(l===a){Ja=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Ja=w;break e}Ja=l.return}}if(kl=r,Vr(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(rt,e)}catch(x){}i=!0}return i}finally{bt=n,Al.transition=t}}return!1}function Sc(e,t,n){e=zo(e,t=pa(0,t=ua(n,t),1),1),t=tc(),null!==e&&(vt(e,1,t),rc(e,t))}function Ec(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Xl||!Xl.has(i))){t=zo(t,e=ga(t,e=ua(n,e),1),1),e=tc(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function Tc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Ml===e&&(Ol&n)===n&&(4===zl||3===zl&&(130023424&Ol)===Ol&&500>Qe()-Vl?fc(e,0):Nl|=n),rc(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=Mo(e,t))&&(vt(e,t,n),rc(e,n))}function Ac(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function kc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(o(314))}null!==i&&i.delete(t),Cc(e,n)}function Mc(e,t){return Xe(e,t)}function Lc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oc(e,t,n,i){return new Lc(e,t,n,i)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ic(e,t){var n=e.alternate;return null===n?((n=Oc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function zc(e,t,n,i,r,s){var a=2;if(i=e,"function"===typeof e)Rc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case P:return Fc(n.children,r,s,t);case S:a=8,r|=8;break;case E:return(e=Oc(12,n,t,2|r)).elementType=E,e.lanes=s,e;case k:return(e=Oc(13,n,t,r)).elementType=k,e.lanes=s,e;case M:return(e=Oc(19,n,t,r)).elementType=M,e.lanes=s,e;case R:return Dc(n,r,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:a=10;break e;case C:a=9;break e;case A:a=11;break e;case L:a=14;break e;case O:a=16,i=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Oc(a,n,t,r)).elementType=e,t.type=i,t.lanes=s,t}function Fc(e,t,n,i){return(e=Oc(7,e,i,t)).lanes=n,e}function Dc(e,t,n,i){return(e=Oc(22,e,i,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function jc(e,t,n){return(e=Oc(6,e,null,t)).lanes=n,e}function Nc(e,t,n){return(t=Oc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,i,r,o,s,a,l){return e=new Bc(e,t,n,a,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Oc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oo(o),e}function Vc(e){if(!e)return Cr;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Or(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Or(n))return zr(e,n,t)}return t}function Wc(e,t,n,i,r,o,s,a,l){return(e=Uc(n,i,!0,e,0,o,0,a,l)).context=Vc(null),n=e.current,(o=Io(i=tc(),r=nc(n))).callback=void 0!==t&&null!==t?t:null,zo(n,o,r),e.current.lanes=r,vt(e,r,i),rc(e,i),e}function Gc(e,t,n,i){var r=t.current,o=tc(),s=nc(r);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Io(o,s)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=zo(r,t,s))&&(ic(e,r,s,o),Fo(e,r,s)),s}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Xc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||kr.current)_a=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return _a=!1,function(e,t,n){switch(t.tag){case 3:Ma(t),po();break;case 5:ss(t);break;case 1:Or(t.type)&&Fr(t);break;case 4:rs(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Tr(yo,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Tr(ls,1&ls.current),t.flags|=128,null):0!==(n&t.child.childLanes)?ja(e,t,n):(Tr(ls,1&ls.current),null!==(e=Ha(e,t,n))?e.sibling:null);Tr(ls,1&ls.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Wa(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Tr(ls,ls.current),i)break;return null;case 22:case 23:return t.lanes=0,Ea(e,t,n)}return Ha(e,t,n)}(e,t,n);_a=0!==(131072&e.flags)}else _a=!1,ro&&0!==(1048576&t.flags)&&Jr(t,qr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Ga(e,t),e=t.pendingProps;var r=Lr(t,Ar.current);Eo(t,n),r=Ss(null,t,i,e,r,n);var s=Es();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Or(i)?(s=!0,Fr(t)):s=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Oo(t),r.updater=Vo,t.stateNode=r,r._reactInternals=t,qo(t,i,e,n),t=ka(null,t,i,!0,s,n)):(t.tag=0,ro&&s&&eo(t),wa(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Ga(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Rc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===L)return 14}return 2}(i),e=vo(i,e),r){case 0:t=Ca(null,t,i,e,n);break e;case 1:t=Aa(null,t,i,e,n);break e;case 11:t=xa(null,t,i,e,n);break e;case 14:t=Pa(null,t,i,vo(i.type,e),n);break e}throw Error(o(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Ca(e,t,i,r=t.elementType===i?r:vo(i,r),n);case 1:return i=t.type,r=t.pendingProps,Aa(e,t,i,r=t.elementType===i?r:vo(i,r),n);case 3:e:{if(Ma(t),null===e)throw Error(o(387));i=t.pendingProps,r=(s=t.memoizedState).element,Ro(e,t),jo(t,i,null,n);var a=t.memoizedState;if(i=a.element,s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=La(e,t,i,n,r=ua(Error(o(423)),t));break e}if(i!==r){t=La(e,t,i,n,r=ua(Error(o(424)),t));break e}for(io=cr(t.stateNode.containerInfo.firstChild),no=t,ro=!0,oo=null,n=$o(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(po(),i===r){t=Ha(e,t,n);break e}wa(e,t,i,n)}t=t.child}return t;case 5:return ss(t),null===e&&co(t),i=t.type,r=t.pendingProps,s=null!==e?e.memoizedProps:null,a=r.children,nr(i,r)?a=null:null!==s&&nr(i,s)&&(t.flags|=32),Ta(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&co(t),null;case 13:return ja(e,t,n);case 4:return rs(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=Qo(t,null,i,n):wa(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,xa(e,t,i,r=t.elementType===i?r:vo(i,r),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,s=t.memoizedProps,a=r.value,Tr(yo,i._currentValue),i._currentValue=a,null!==s)if(ai(s.value,a)){if(s.children===r.children&&!kr.current){t=Ha(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===s.tag){(c=Io(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),So(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),So(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}wa(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Eo(t,n),i=i(r=To(r)),t.flags|=1,wa(e,t,i,n),t.child;case 14:return r=vo(i=t.type,t.pendingProps),Pa(e,t,i,r=vo(i.type,r),n);case 15:return Sa(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:vo(i,r),Ga(e,t),t.tag=1,Or(i)?(e=!0,Fr(t)):e=!1,Eo(t,n),Go(t,i,r),qo(t,i,r,n),ka(null,t,i,!0,e,n);case 19:return Wa(e,t,n);case 22:return Ea(e,t,n)}throw Error(o(156,t.tag))};var Zc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function eu(e,t,n,i,r){var o=n._reactRootContainer;if(o){var s=o;if("function"===typeof r){var a=r;r=function(){var e=Hc(s);a.call(e)}}Gc(t,s,e,r)}else s=function(e,t,n,i,r){if(r){if("function"===typeof i){var o=i;i=function(){var e=Hc(s);o.call(e)}}var s=Wc(t,i,e,0,null,!1,0,"",Jc);return e._reactRootContainer=s,e[pr]=s.current,Vi(8===e.nodeType?e.parentNode:e),dc(),s}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var a=i;i=function(){var e=Hc(l);a.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[pr]=l.current,Vi(8===e.nodeType?e.parentNode:e),dc((function(){Gc(t,l,n,i)})),l}(n,t,e,r,i);return Hc(s)}Kc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Gc(e,t,null,null)},Kc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Gc(null,e,null,null)})),t[pr]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Dt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Qe()),0===(6&kl)&&(Wl=Qe()+500,Vr()))}break;case 13:dc((function(){var t=Mo(e,1);if(null!==t){var n=tc();ic(t,e,1,n)}})),Xc(e,1)}},xt=function(e){if(13===e.tag){var t=Mo(e,134217728);if(null!==t)ic(t,e,134217728,tc());Xc(e,134217728)}},Pt=function(e){if(13===e.tag){var t=nc(e),n=Mo(e,t);if(null!==n)ic(n,e,t,tc());Xc(e,t)}},St=function(){return bt},Et=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},xe=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=wr(i);if(!r)throw Error(o(90));X(i),$(i,r)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ae=uc,ke=dc;var tu={usingClientEntryPoint:!1,Events:[br,_r,wr,Te,Ce,uc]},nu={findFiberByHostInstance:yr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},iu={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{rt=ru.inject(iu),ot=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(o(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Qc(e))throw Error(o(299));var n=!1,i="",r=Zc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,i,r),e[pr]=t.current,Vi(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(o(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qc(e))throw Error(o(405));var i=null!=n&&n.hydratedSources||null,r=!1,s="",a=Zc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Wc(t,null,e,1,null!=n?n:null,r,0,s,a),e[pr]=t.current,Vi(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Kc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(o(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(o(40));return!!e._reactRootContainer&&(dc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[pr]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!$c(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return eu(e,t,n,!1,i)},t.version="18.2.0-next-9e3b772b8-20220608"},250:(e,t,n)=>{"use strict";var i=n(164);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},164:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:(e,t,n)=>{"use strict";var i=n(791),r=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,o={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,i)&&!l.hasOwnProperty(i)&&(o[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===o[i]&&(o[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:u,props:o,_owner:a.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},117:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var _=b.prototype=new y;_.constructor=b,g(_,v.prototype),_.isPureReactComponent=!0;var w=Array.isArray,x=Object.prototype.hasOwnProperty,P={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,i){var r,o={},s=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)x.call(t,r)&&!S.hasOwnProperty(r)&&(o[r]=t[r]);var l=arguments.length-2;if(1===l)o.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:n,type:e,key:s,ref:a,props:o,_owner:P.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function k(e,t,r,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return s=s(l=e),e=""===o?"."+A(l,0):o,w(s)?(r="",null!=e&&(r=e.replace(C,"$&/")+"/"),k(s,t,r,"",(function(e){return e}))):null!=s&&(T(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+e)),t.push(s)),1;if(l=0,o=""===o?".":o+":",w(e))for(var c=0;c<e.length;c++){var u=o+A(a=e[c],c);l+=k(a,t,r,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=k(a=a.value,t,r,u=o+A(a,c++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function M(e,t,n){if(null==e)return e;var i=[],r=0;return k(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function L(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},R={transition:null},I={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:R,ReactCurrentOwner:P};t.Children={map:M,forEach:function(e,t,n){M(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return M(e,(function(){t++})),t},toArray:function(e){return M(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=s,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=g({},e.props),o=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=P.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)x.call(t,c)&&!S.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:o,ref:s,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:L}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.2.0"},791:(e,t,n)=>{"use strict";e.exports=n(117)},184:(e,t,n)=>{"use strict";e.exports=n(374)},813:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<o(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,s=r>>>1;i<s;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>o(l,n))c<r&&0>o(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<r&&0>o(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function _(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function w(e){if(m=!1,_(e),!g)if(null!==i(c))g=!0,R(x);else{var t=i(u);null!==t&&I(w,t.startTime-e)}}function x(e,n){g=!1,m&&(m=!1,y(T),T=-1),p=!0;var o=f;try{for(_(n),h=i(c);null!==h&&(!(h.expirationTime>n)||e&&!k());){var s=h.callback;if("function"===typeof s){h.callback=null,f=h.priorityLevel;var a=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===i(c)&&r(c),_(n)}else r(c);h=i(c)}if(null!==h)var l=!0;else{var d=i(u);null!==d&&I(w,d.startTime-n),l=!1}return l}finally{h=null,f=o,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var P,S=!1,E=null,T=-1,C=5,A=-1;function k(){return!(t.unstable_now()-A<C)}function M(){if(null!==E){var e=t.unstable_now();A=e;var n=!0;try{n=E(!0,e)}finally{n?P():(S=!1,E=null)}}else S=!1}if("function"===typeof b)P=function(){b(M)};else if("undefined"!==typeof MessageChannel){var L=new MessageChannel,O=L.port2;L.port1.onmessage=M,P=function(){O.postMessage(null)}}else P=function(){v(M,0)};function R(e){E=e,S||(S=!0,P())}function I(e,n){T=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,R(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,r,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,n(u,e),null===i(c)&&e===i(u)&&(m?(y(T),T=-1):m=!0,I(w,o-s))):(e.sortIndex=a,n(c,e),g||p||(g=!0,R(x))),e},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},296:(e,t,n)=>{"use strict";e.exports=n(813)},521:()=>{}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(i,r){if(1&r&&(i=this(i)),8&r)return i;if("object"===typeof i&&i){if(4&r&&i.__esModule)return i;if(16&r&&"function"===typeof i.then)return i}var o=Object.create(null);n.r(o);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&i;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>s[e]=()=>i[e]));return s.default=()=>i,n.d(o,s),o}})(),n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,i)=>(n.f[i](e,t),t)),[])),n.u=e=>"static/js/"+e+".ff8fb835.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="client-function:";n.l=(i,r,o,s)=>{if(e[i])e[i].push(r);else{var a,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==t+o){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+o),a.src=i),e[i]=[r];var h=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var r=e[i];if(delete e[i],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(n))),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/client-function-queenstown/",(()=>{var e={179:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var o=new Promise(((n,i)=>r=e[t]=[n,i]));i.push(r[2]=o);var s=n.p+n.u(t),a=new Error;n.l(s,(i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,r[1](a)}}),"chunk-"+t,t)}};var t=(t,i)=>{var r,o,s=i[0],a=i[1],l=i[2],c=0;if(s.some((t=>0!==e[t]))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(l)l(n)}for(t&&t(i);c<s.length;c++)o=s[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},i=self.webpackChunkclient_function=self.webpackChunkclient_function||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";var e=n(791),t=n(250);const i=e.createContext(null);function r(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function o(e,t){const n=t.viewState||t;let i=!1;if("longitude"in n&&"latitude"in n){const t=e.center;e.center=new t.constructor(n.longitude,n.latitude),i=i||t!==e.center}if("zoom"in n){const t=e.zoom;e.zoom=n.zoom,i=i||t!==e.zoom}if("bearing"in n){const t=e.bearing;e.bearing=n.bearing,i=i||t!==e.bearing}if("pitch"in n){const t=e.pitch;e.pitch=n.pitch,i=i||t!==e.pitch}return n.padding&&!e.isPaddingEqual(n.padding)&&(i=!0,e.padding=n.padding),i}const s=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function a(e){if(!e)return null;if("string"===typeof e)return e;if("toJS"in e&&(e=e.toJS()),!e.layers)return e;const t={};for(const i of e.layers)t[i.id]=i;const n=e.layers.map((e=>{const n=t[e.ref];let i=null;if("interactive"in e&&(i={...e},delete i.interactive),n){i=i||{...e},delete i.ref;for(const e of s)e in n&&(i[e]=n[e])}return i||e}));return{...e,layers:n}}function l(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!l(e[n],t[n]))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(const r of n){if(!t.hasOwnProperty(r))return!1;if(!l(e[r],t[r]))return!1}return!0}return!1}const c={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},u={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},d={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},h=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],f=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class p{constructor(e,t,n){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=e=>{const t=this.props[d[e.type]];t&&t(e)},this._onPointerEvent=e=>{"mousemove"!==e.type&&"mouseout"!==e.type||this._updateHover(e);const t=this.props[c[e.type]];t&&(this.props.interactiveLayerIds&&"mouseover"!==e.type&&"mouseout"!==e.type&&(e.features=this._hoveredFeatures||this._queryRenderedFeatures(e.point)),t(e),delete e.features)},this._onCameraEvent=e=>{if(!this._internalUpdate){const t=this.props[u[e.type]];t&&t(e)}e.type in this._deferredEvents&&(this._deferredEvents[e.type]=!1)},this._MapClass=e,this.props=t,this._initialize(n)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const t=this.props;this.props=e;const n=this._updateSettings(e,t);n&&this._createShadowTransform(this._map);const i=this._updateSize(e),r=this._updateViewState(e,!0);this._updateStyle(e,t),this._updateStyleComponents(e,t),this._updateHandlers(e,t),(n||i||r&&!this._map.isMoving())&&this.redraw()}static reuse(e,t){const n=p.savedMaps.pop();if(!n)return null;const i=n.map,r=i.getContainer();for(t.className=r.className;r.childNodes.length>0;)t.appendChild(r.childNodes[0]);i._container=t,n.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:o}=e;return o&&(o.bounds?i.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):n._updateViewState(o,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",(()=>i.fire("load"))),i.triggerRepaint(),n}_initialize(e){const{props:t}=this,n={...t,...t.initialViewState,accessToken:t.mapboxAccessToken||g()||null,container:e,style:a(t.mapStyle)},i=n.initialViewState||n.viewState||n;if(Object.assign(n,{center:[i.longitude||0,i.latitude||0],zoom:i.zoom||0,pitch:i.pitch||0,bearing:i.bearing||0}),t.gl){const e=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=e,t.gl)}const r=new this._MapClass(n);i.padding&&r.setPadding(i.padding),t.cursor&&(r.getCanvas().style.cursor=t.cursor),this._createShadowTransform(r);const o=r._render;r._render=e=>{this._inRender=!0,o.call(r,e),this._inRender=!1};const s=r._renderTaskQueue.run;r._renderTaskQueue.run=e=>{s.call(r._renderTaskQueue,e),this._onBeforeRepaint()},r.on("render",(()=>this._onAfterRepaint()));const l=r.fire;r.fire=this._fireEvent.bind(this,l),r.on("resize",(()=>{this._renderTransform.resize(r.transform.width,r.transform.height)})),r.on("styledata",(()=>this._updateStyleComponents(this.props,{}))),r.on("sourcedata",(()=>this._updateStyleComponents(this.props,{})));for(const a in c)r.on(a,this._onPointerEvent);for(const a in u)r.on(a,this._onCameraEvent);for(const a in d)r.on(a,this._onEvent);this._map=r}recycle(){const e=this.map.getContainer().querySelector("[mapboxgl-children]");null===e||void 0===e||e.remove(),p.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const t=function(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}(e.transform);e.painter.transform=t,this._renderTransform=t}_updateSize(e){const{viewState:t}=e;if(t){const e=this._map;if(t.width!==e.transform.width||t.height!==e.transform.height)return e.resize(),!0}return!1}_updateViewState(e,t){if(this._internalUpdate)return!1;const n=this._map,i=this._renderTransform,{zoom:s,pitch:a,bearing:l}=i,c=n.isMoving();c&&(i.cameraElevationReference="sea");const u=o(i,{...r(n.transform),...e});if(c&&(i.cameraElevationReference="ground"),u&&t){const e=this._deferredEvents;e.move=!0,e.zoom||(e.zoom=s!==i.zoom),e.rotate||(e.rotate=l!==i.bearing),e.pitch||(e.pitch=a!==i.pitch)}return c||o(n.transform,e),u}_updateSettings(e,t){const n=this._map;let i=!1;for(const r of h)r in e&&!l(e[r],t[r])&&(i=!0,n["set".concat(r[0].toUpperCase()).concat(r.slice(1))](e[r]));return i}_updateStyle(e,t){if(e.cursor!==t.cursor&&(this._map.getCanvas().style.cursor=e.cursor),e.mapStyle!==t.mapStyle){const t={diff:e.styleDiffing};return"localIdeographFontFamily"in e&&(t.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(a(e.mapStyle),t),!0}return!1}_updateStyleComponents(e,t){const n=this._map;let i=!1;return n.style.loaded()&&("light"in e&&!l(e.light,t.light)&&(i=!0,n.setLight(e.light)),"fog"in e&&!l(e.fog,t.fog)&&(i=!0,n.setFog(e.fog)),"terrain"in e&&!l(e.terrain,t.terrain)&&(e.terrain&&!n.getSource(e.terrain.source)||(i=!0,n.setTerrain(e.terrain)))),i}_updateHandlers(e,t){const n=this._map;let i=!1;for(const r of f){const o=e[r];l(o,t[r])||(i=!0,o?n[r].enable(o):n[r].disable())}return i}_queryRenderedFeatures(e){const t=this._map,{interactiveLayerIds:n=[]}=this.props;try{return t.queryRenderedFeatures(e,{layers:n.filter(t.getLayer.bind(t))})}catch(i){return[]}}_updateHover(e){var t;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const n=e.type,i=(null===(t=this._hoveredFeatures)||void 0===t?void 0:t.length)>0,r=this._queryRenderedFeatures(e.point),o=r.length>0;!o&&i&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=r,o&&!i&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=n}else this._hoveredFeatures=null}_fireEvent(e,t,n){const i=this._map,o=i.transform,s="string"===typeof t?t:t.type;return"move"===s&&this._updateViewState(this.props,!1),s in u&&("object"===typeof t&&(t.viewState=r(o)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,t,n),i.transform=o,i):(e.call(i,t,n),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const n in this._deferredEvents)this._deferredEvents[n]&&e.fire(n);this._internalUpdate=!1;const t=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=t}}}function g(){let e=null;if("undefined"!==typeof location){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||{NODE_ENV:"production",PUBLIC_URL:"/client-function-queenstown",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.MapboxAccessToken}catch(t){}try{e=e||{NODE_ENV:"production",PUBLIC_URL:"/client-function-queenstown",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch(n){}return e}p.savedMaps=[];const m=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function v(e,t){if(!e)return null;const n=e.map,i={getMap:()=>n,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:n=>e.transform.locationPoint(t.LngLat.convert(n)),unproject:n=>e.transform.pointLocation(t.Point.convert(n)),queryTerrainElevation:(t,i)=>{const r=n.transform;n.transform=e.transform;const o=n.queryTerrainElevation(t,i);return n.transform=r,o}};for(const r of function(e){const t=new Set;let n=e;for(;n;){for(const i of Object.getOwnPropertyNames(n))"_"!==i[0]&&"function"===typeof e[i]&&"fire"!==i&&"setEventedParent"!==i&&t.add(i);n=Object.getPrototypeOf(n)}return Array.from(t)}(n))r in i||m.includes(r)||(i[r]=n[r].bind(n));return i}const y="undefined"!==typeof document?e.useLayoutEffect:e.useEffect,b=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];const _=e.createContext(null),w={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:e=>console.error(e.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},x=(0,e.forwardRef)(((t,r)=>{const o=(0,e.useContext)(i),[s,a]=(0,e.useState)(null),l=(0,e.useRef)(),{current:c}=(0,e.useRef)({mapLib:null,map:null});(0,e.useEffect)((()=>{const e=t.mapLib;let i,r=!0;return Promise.resolve(e||n.e(483).then(n.t.bind(n,483,23))).then((e=>{if(r){if(e.Map||(e=e.default),!e||!e.Map)throw new Error("Invalid mapLib");if(function(e,t){for(const n of b)n in t&&(e[n]=t[n]);t.RTLTextPlugin&&e.getRTLTextPluginStatus&&"unavailable"===e.getRTLTextPluginStatus()&&e.setRTLTextPlugin(t.RTLTextPlugin,(e=>{e&&console.error(e)}),!1)}(e,t),!e.supported(t))throw new Error("Map is not supported by this browser");t.reuseMaps&&(i=p.reuse(t,l.current)),i||(i=new p(e.Map,t,l.current)),c.map=v(i,e),c.mapLib=e,a(i),null===o||void 0===o||o.onMapMount(c.map,t.id)}})).catch((e=>{t.onError({type:"error",target:null,originalEvent:null,error:e})})),()=>{r=!1,i&&(null===o||void 0===o||o.onMapUnmount(t.id),t.reuseMaps?i.recycle():i.destroy())}}),[]),y((()=>{s&&s.setProps(t)})),(0,e.useImperativeHandle)(r,(()=>c.map),[s]);const u=(0,e.useMemo)((()=>({position:"relative",width:"100%",height:"100%",...t.style})),[t.style]);return e.createElement("div",{id:t.id,ref:l,style:u},s&&e.createElement(_.Provider,{value:c},e.createElement("div",{"mapboxgl-children":"",style:{height:"100%"}},t.children)))}));x.displayName="Map",x.defaultProps=w;const P=x;var S=n(164);const E=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function T(e,t){if(!e||!t)return;const n=e.style;for(const i in t){const e=t[i];Number.isFinite(e)&&!E.test(i)?n[i]="".concat(e,"px"):n[i]=e}}function C(t){const{map:n,mapLib:i}=(0,e.useContext)(_),r=(0,e.useRef)({props:t});r.current.props=t;const o=(0,e.useMemo)((()=>{let n=!1;e.Children.forEach(t.children,(e=>{e&&(n=!0)}));const s={...t,element:n?document.createElement("div"):null},a=new i.Marker(s).setLngLat([t.longitude,t.latitude]);return a.getElement().addEventListener("click",(e=>{var t,n;null===(n=(t=r.current.props).onClick)||void 0===n||n.call(t,{type:"click",target:a,originalEvent:e})})),a.on("dragstart",(e=>{var t,n;const i=e;i.lngLat=o.getLngLat(),null===(n=(t=r.current.props).onDragStart)||void 0===n||n.call(t,i)})),a.on("drag",(e=>{var t,n;const i=e;i.lngLat=o.getLngLat(),null===(n=(t=r.current.props).onDrag)||void 0===n||n.call(t,i)})),a.on("dragend",(e=>{var t,n;const i=e;i.lngLat=o.getLngLat(),null===(n=(t=r.current.props).onDragEnd)||void 0===n||n.call(t,i)})),a}),[]);return(0,e.useEffect)((()=>(o.addTo(n.getMap()),()=>{o.remove()})),[]),(0,e.useEffect)((()=>{T(o.getElement(),t.style)}),[t.style]),o.getLngLat().lng===t.longitude&&o.getLngLat().lat===t.latitude||o.setLngLat([t.longitude,t.latitude]),t.offset&&!function(e,t){const n=Array.isArray(e)?e[0]:e?e.x:0,i=Array.isArray(e)?e[1]:e?e.y:0,r=Array.isArray(t)?t[0]:t?t.x:0,o=Array.isArray(t)?t[1]:t?t.y:0;return n===r&&i===o}(o.getOffset(),t.offset)&&o.setOffset(t.offset),o.isDraggable()!==t.draggable&&o.setDraggable(t.draggable),o.getRotation()!==t.rotation&&o.setRotation(t.rotation),o.getRotationAlignment()!==t.rotationAlignment&&o.setRotationAlignment(t.rotationAlignment),o.getPitchAlignment()!==t.pitchAlignment&&o.setPitchAlignment(t.pitchAlignment),o.getPopup()!==t.popup&&o.setPopup(t.popup),(0,S.createPortal)(t.children,o.getElement())}C.defaultProps={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};e.memo(C);function A(e){return new Set(e?e.trim().split(/\s+/):[])}e.memo((function(t){const{map:n,mapLib:i}=(0,e.useContext)(_),r=(0,e.useMemo)((()=>document.createElement("div")),[]),o=(0,e.useRef)({props:t});o.current.props=t;const s=(0,e.useMemo)((()=>{const e={...t},n=new i.Popup(e).setLngLat([t.longitude,t.latitude]);return n.once("open",(e=>{var t,n;null===(n=(t=o.current.props).onOpen)||void 0===n||n.call(t,e)})),n}),[]);if((0,e.useEffect)((()=>{const e=e=>{var t,n;null===(n=(t=o.current.props).onClose)||void 0===n||n.call(t,e)};return s.on("close",e),s.setDOMContent(r).addTo(n.getMap()),()=>{s.off("close",e),s.isOpen()&&s.remove()}}),[]),(0,e.useEffect)((()=>{T(s.getElement(),t.style)}),[t.style]),s.isOpen()&&(s.getLngLat().lng===t.longitude&&s.getLngLat().lat===t.latitude||s.setLngLat([t.longitude,t.latitude]),t.offset&&!l(s.options.offset,t.offset)&&s.setOffset(t.offset),s.options.anchor===t.anchor&&s.options.maxWidth===t.maxWidth||(s.options.anchor=t.anchor,s.setMaxWidth(t.maxWidth)),s.options.className!==t.className)){const e=A(s.options.className),n=A(t.className);for(const t of e)n.has(t)||s.removeClassName(t);for(const t of n)e.has(t)||s.addClassName(t);s.options.className=t.className}return(0,S.createPortal)(t.children,r)}));const k=function(t,n,i,r){const o=(0,e.useContext)(_),s=(0,e.useMemo)((()=>t(o)),[]);return(0,e.useEffect)((()=>{const e=r||i||n,t="function"===typeof n&&"function"===typeof i?n:null,a="function"===typeof i?i:"function"===typeof n?n:null,{map:l}=o;return l.hasControl(s)||(l.addControl(s,null===e||void 0===e?void 0:e.position),t&&t(o)),()=>{a&&a(o),l.hasControl(s)&&l.removeControl(s)}}),[]),s};e.memo((function(t){const n=k((e=>{let{mapLib:n}=e;return new n.AttributionControl(t)}),{position:t.position});return(0,e.useEffect)((()=>{T(n._container,t.style)}),[t.style]),null}));e.memo((function(t){const n=k((e=>{let{mapLib:n}=e;return new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)})}),{position:t.position});return(0,e.useEffect)((()=>{T(n._controlContainer,t.style)}),[t.style]),null}));const M=(0,e.forwardRef)(((t,n)=>{const i=(0,e.useRef)({props:t}),r=k((e=>{let{mapLib:n}=e;const r=new n.GeolocateControl(t),o=r._setupUI;return r._setupUI=e=>{r._container.hasChildNodes()||o(e)},r.on("geolocate",(e=>{var t,n;null===(n=(t=i.current.props).onGeolocate)||void 0===n||n.call(t,e)})),r.on("error",(e=>{var t,n;null===(n=(t=i.current.props).onError)||void 0===n||n.call(t,e)})),r.on("outofmaxbounds",(e=>{var t,n;null===(n=(t=i.current.props).onOutOfMaxBounds)||void 0===n||n.call(t,e)})),r.on("trackuserlocationstart",(e=>{var t,n;null===(n=(t=i.current.props).onTrackUserLocationStart)||void 0===n||n.call(t,e)})),r.on("trackuserlocationend",(e=>{var t,n;null===(n=(t=i.current.props).onTrackUserLocationEnd)||void 0===n||n.call(t,e)})),r}),{position:t.position});return i.current.props=t,(0,e.useImperativeHandle)(n,(()=>({trigger:()=>r.trigger()})),[]),(0,e.useEffect)((()=>{T(r._container,t.style)}),[t.style]),null}));M.displayName="GeolocateControl";e.memo(M);e.memo((function(t){const n=k((e=>{let{mapLib:n}=e;return new n.NavigationControl(t)}),{position:t.position});return(0,e.useEffect)((()=>{T(n._container,t.style)}),[t.style]),null}));function L(t){const n=k((e=>{let{mapLib:n}=e;return new n.ScaleControl(t)}),{position:t.position});return n.options.unit===t.unit&&n.options.maxWidth===t.maxWidth||(n.options.maxWidth=t.maxWidth,n.setUnit(t.unit)),(0,e.useEffect)((()=>{T(n._container,t.style)}),[t.style]),null}L.defaultProps={unit:"metric",maxWidth:100};e.memo(L);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function R(e){var t=function(e,t){if("object"!==O(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==O(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===O(t)?t:String(t)}function I(e,t,n){return(t=R(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e){if("undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof process&&"object"===typeof process.versions&&Boolean(process.versions.electron))return!0;const t="object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent,n=e||t;return!!(n&&n.indexOf("Electron")>=0)}function F(){return!("object"===typeof process&&"[object process]"===String(process)&&!process.browser)||z()}const D="undefined"!==typeof __VERSION__?__VERSION__:"untranspiled source";F();class j{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";I(this,"storage",void 0),I(this,"id",void 0),I(this,"config",void 0),this.storage=function(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(t){return null}}(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function N(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const r=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>i&&(n=Math.min(n,i/e.width));const o=e.width*n,s=e.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(r,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),a]}let B;function U(e){return"string"===typeof e?B[e.toUpperCase()]||B.WHITE:e}function V(e,t){if(!e)throw new Error(t||"Assertion failed")}!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(B||(B={}));const W={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof n.g&&n.g,document:"undefined"!==typeof document&&document,process:"object"===typeof process&&process},G=(globalThis,W.window||W.self||W.global),H=W.process||{};console;function q(){let e;var t,n;if(F&&"performance"in G)e=null===G||void 0===G||null===(t=G.performance)||void 0===t||null===(n=t.now)||void 0===n?void 0:n.call(t);else if("hrtime"in H){var i;const t=null===H||void 0===H||null===(i=H.hrtime)||void 0===i?void 0:i.call(H);e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}const X={debug:F&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Z={enabled:!0,level:0};function Y(){}const K={},Q={once:!0};class ${constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};I(this,"id",void 0),I(this,"VERSION",D),I(this,"_startTs",q()),I(this,"_deltaTs",q()),I(this,"_storage",void 0),I(this,"userData",{}),I(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new j("__probe-".concat(this.id,"__"),Z),this.timeStamp("".concat(this.id," started")),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(e),i=Object.getOwnPropertyNames(n);for(const r of i)"function"===typeof e[r]&&(t.find((e=>r===e))||(e[r]=e[r].bind(e)))}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((q()-this._startTs).toPrecision(10))}getDelta(){return Number((q()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){V(e,t)}warn(e){return this._getLogFunction(0,e,X.warn,arguments,Q)}error(e){return this._getLogFunction(0,e,X.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,X.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,X.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return this._getLogFunction(e,t,X.debug||X.info,arguments,Q)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||Y,n&&[n],{tag:te(t)}):Y}image(e){let{logLevel:t,priority:n,image:i,message:r="",scale:o=1}=e;return this._shouldLog(t||n)?F?function(e){let{image:t,message:n="",scale:i=1}=e;if("string"===typeof t){const e=new Image;return e.onload=()=>{const t=N(e,n,i);console.log(...t)},e.src=t,Y}const r=t.nodeName||"";if("img"===r.toLowerCase())return console.log(...N(t,n,i)),Y;if("canvas"===r.toLowerCase()){const e=new Image;return e.onload=()=>console.log(...N(e,n,i)),e.src=t.toDataURL(),Y}return Y}({image:i,message:r,scale:o}):function(e){let{image:t,message:n="",scale:i=1}=e;return console.warn("removed"),Y}({image:i,message:r,scale:o}):Y}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||Y)}group(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const i=ee({logLevel:e,message:t,opts:n}),{collapsed:r}=n;return i.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Y)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=J(e)}_getLogFunction(e,t,n,i,r){if(this._shouldLog(e)){r=ee({logLevel:e,message:t,args:i,opts:r}),V(n=n||r.method),r.total=this.getTotal(),r.delta=this.getDelta(),this._deltaTs=q();const o=r.tag||r.message;if(r.once){if(K[o])return Y;K[o]=q()}return t=function(e,t,n){if("string"===typeof t){const s=n.time?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(t-e.length,0);return"".concat(" ".repeat(n)).concat(e)}(function(e){let t;return t=e<10?"".concat(e.toFixed(2),"ms"):e<100?"".concat(e.toFixed(1),"ms"):e<1e3?"".concat(e.toFixed(0),"ms"):"".concat((e/1e3).toFixed(2),"s"),t}(n.total)):"";t=n.time?"".concat(e,": ").concat(s,"  ").concat(t):"".concat(e,": ").concat(t),i=t,r=n.color,o=n.background,F||"string"!==typeof i||(r&&(r=U(r),i="\x1b[".concat(r,"m").concat(i,"\x1b[39m")),o&&(r=U(o),i="\x1b[".concat(o+10,"m").concat(i,"\x1b[49m"))),t=i}var i,r,o;return t}(this.id,r.message,r),n.bind(console,t,...r.args)}return Y}}function J(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return V(Number.isFinite(t)&&t>=0),t}function ee(e){const{logLevel:t,message:n}=e;e.logLevel=J(t);const i=e.args?Array.from(e.args):[];for(;i.length&&i.shift()!==n;);switch(typeof t){case"string":case"function":void 0!==n&&i.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"===typeof e.message&&(e.message=e.message());const r=typeof e.message;return V("string"===r||"object"===r),Object.assign(e,{args:i},e.opts)}function te(e){for(const t in e)for(const n in e[t])return n||"untitled";return"empty"}I($,"VERSION",D);const ne=new $({id:"deck"});const ie=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};I(this,"_pool",[]),I(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,n){let{size:i=1,type:r,padding:o=0,copy:s=!1,initialize:a=!1,maxCount:l}=n;const c=r||e&&e.constructor||Float32Array,u=t*i+o;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let d=1/0;l&&(d=l*i+o);const h=this._allocate(c,u,a,d);return e&&s?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,t,n,i){let r=Math.max(Math.ceil(t*this.opts.overAlloc),1);r>i&&(r=i);const o=this._pool,s=e.BYTES_PER_ELEMENT*r,a=o.findIndex((e=>e.byteLength>=s));if(a>=0){const t=new e(o.splice(a,1)[0],0,r);return n&&t.fill(0),t}return new e(r)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:n}=e,{byteLength:i}=n,r=t.findIndex((e=>e.byteLength>=i));r<0?t.push(n):(r>0||t.length<this.opts.poolSize)&&t.splice(r,0,n),t.length>this.opts.poolSize&&t.shift()}},re=(Math.PI,Math.PI,{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0});function oe(e){let{precision:t=re.precision}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=function(e){return Math.round(e/re.EPSILON)*re.EPSILON}(e),"".concat(parseFloat(e.toPrecision(t)))}function se(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ae(e,t,n){return ue(e,(e=>Math.max(t,Math.min(n,e))))}function le(e,t,n){return se(e)?e.map(((e,i)=>le(e,t[i],n))):n*t+(1-n)*e}function ce(e,t,n){const i=re.EPSILON;n&&(re.EPSILON=n);try{if(e===t)return!0;if(se(e)&&se(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!ce(e[n],t[n]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):"number"===typeof e&&"number"===typeof t&&Math.abs(e-t)<=re.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{re.EPSILON=i}}function ue(e,t,n){if(se(e)){const i=e;n=n||function(e){return e.clone?e.clone():new Array(e.length)}(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=t(e[r],r,n);return n}return t(e)}class de extends(function(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:se(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(re)}formatString(e){let t="";for(let n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+oe(this[n],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!ce(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,n){if(void 0===n)return this.lerp(this,e,t);for(let i=0;i<this.ELEMENTS;++i){const r=e[i];this[i]=r+n*(t[i]-r)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const i of t)for(let e=0;e<this.ELEMENTS;++e)this[e]+=i[e];return this.check()}subtract(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const i of t)for(let e=0;e<this.ELEMENTS;++e)this[e]-=i[e];return this.check()}scale(e){if("number"===typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(re.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}get elements(){return this}}function he(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(e));return e}function fe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(re.debug&&!function(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e,t))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return e}function pe(e,t){if(!e)throw new Error("math.gl assertion ".concat(t))}class ge extends de{get x(){return this[0]}set x(e){this[0]=he(e)}get y(){return this[1]}set y(e){this[1]=he(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-e[n];t+=i*i}return he(t)}dot(e){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return he(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const i of t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=i[e];return this.check()}divide(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const i of t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=i[e];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return pe(e>=0&&e<this.ELEMENTS,"index is out of range"),he(this[e])}setComponent(e,t){return pe(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var me=1e-6,ve="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function ye(e,t,n){var i=t[0],r=t[1],o=t[2],s=n[3]*i+n[7]*r+n[11]*o+n[15];return s=s||1,e[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/s,e[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,e[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var be=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},_e=function(e){var t=e[0],n=e[1],i=e[2];return Math.hypot(t,n,i)},we=function(e){var t=e[0],n=e[1],i=e[2];return t*t+n*n+i*i};!function(){var e=function(){var e=new ve(3);return ve!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}()}();function xe(e,t,n){const i=t[0],r=t[1],o=t[2],s=n[3]*i+n[7]*r+n[11]*o||1;return e[0]=(n[0]*i+n[4]*r+n[8]*o)/s,e[1]=(n[1]*i+n[5]*r+n[9]*o)/s,e[2]=(n[2]*i+n[6]*r+n[10]*o)/s,e}const Pe=[0,0,0];let Se;class Ee extends ge{static get ZERO(){return Se||(Se=new Ee(0,0,0),Object.freeze(Se)),Se}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(-0,-0,-0),1===arguments.length&&se(e)?this.copy(e):(re.debug&&(he(e),he(t),he(n)),this[0]=e,this[1]=t,this[2]=n)}set(e,t,n){return this[0]=e,this[1]=t,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return re.debug&&(he(e.x),he(e.y),he(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=he(e)}angle(e){return function(e,t){var n=e[0],i=e[1],r=e[2],o=t[0],s=t[1],a=t[2],l=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(o*o+s*s+a*a),c=l&&function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))}(this,e)}cross(e){return function(e,t,n){var i=t[0],r=t[1],o=t[2],s=n[0],a=n[1],l=n[2];e[0]=r*l-o*a,e[1]=o*s-i*l,e[2]=i*a-r*s}(this,this,e),this.check()}rotateX(e){let{radians:t,origin:n=Pe}=e;return function(e,t,n,i){var r=[],o=[];r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2]}(this,this,n,t),this.check()}rotateY(e){let{radians:t,origin:n=Pe}=e;return function(e,t,n,i){var r=[],o=[];r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2]}(this,this,n,t),this.check()}rotateZ(e){let{radians:t,origin:n=Pe}=e;return function(e,t,n,i){var r=[],o=[];r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2]}(this,this,n,t),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return ye(this,this,e),this.check()}transformAsVector(e){return xe(this,this,e),this.check()}transformByMatrix3(e){return function(e,t,n){var i=t[0],r=t[1],o=t[2];e[0]=i*n[0]+r*n[3]+o*n[6],e[1]=i*n[1]+r*n[4]+o*n[7],e[2]=i*n[2]+r*n[5]+o*n[8]}(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const i=t[0],r=t[1];e[0]=n[0]*i+n[2]*r,e[1]=n[1]*i+n[3]*r,e[2]=t[2]}(this,this,e),this.check()}transformByQuaternion(e){return function(e,t,n){var i=n[0],r=n[1],o=n[2],s=n[3],a=t[0],l=t[1],c=t[2],u=r*c-o*l,d=o*a-i*c,h=i*l-r*a,f=r*h-o*d,p=o*u-i*h,g=i*d-r*u,m=2*s;u*=m,d*=m,h*=m,f*=2,p*=2,g*=2,e[0]=a+u+f,e[1]=l+d+p,e[2]=c+h+g}(this,this,e),this.check()}}const Te=new Ee;function Ce(e,t,n,i){Te.set(e,t,n);const r=Te.len();return{distance:i/r,normal:new Ee(-e/r,-t/r,-n/r)}}let Ae;function ke(e,t){const{size:n=1,startIndex:i=0}=t,r=void 0!==t.endIndex?t.endIndex:e.length,o=(r-i)/n;Ae=ie.allocate(Ae,o,{type:Float32Array,size:2*n});let s=i,a=0;for(;s<r;){for(let t=0;t<n;t++){const i=e[s++];Ae[a+t]=i,Ae[a+t+n]=(l=i)-Math.fround(l)}a+=2*n}var l;return Ae.subarray(0,o*n*2)}function Me(e){let t=null,n=!1;for(const i of e)i&&(t?(n||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],n=!0),t[0][0]=Math.min(t[0][0],i[0][0]),t[0][1]=Math.min(t[0][1],i[0][1]),t[1][0]=Math.max(t[1][0],i[1][0]),t[1][1]=Math.max(t[1][1],i[1][1])):t=i);return t}class Le extends de{toString(){let e="[";if(re.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let n=0;n<this.RANK;++n)e+=" ".concat(this[n*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,n){return this[t*this.RANK+e]=he(n),this}getColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0);const n=e*this.RANK;for(let i=0;i<this.RANK;++i)t[i]=this[n+i];return t}setColumn(e,t){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=t[i];return this}}function Oe(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],d=t[9],h=t[10],f=t[11],p=t[12],g=t[13],m=t[14],v=t[15],y=n*a-i*s,b=n*l-r*s,_=n*c-o*s,w=i*l-r*a,x=i*c-o*a,P=r*c-o*l,S=u*g-d*p,E=u*m-h*p,T=u*v-f*p,C=d*m-h*g,A=d*v-f*g,k=h*v-f*m,M=y*k-b*A+_*C+w*T-x*E+P*S;return M?(M=1/M,e[0]=(a*k-l*A+c*C)*M,e[1]=(r*A-i*k-o*C)*M,e[2]=(g*P-m*x+v*w)*M,e[3]=(h*x-d*P-f*w)*M,e[4]=(l*T-s*k-c*E)*M,e[5]=(n*k-r*T+o*E)*M,e[6]=(m*_-p*P-v*b)*M,e[7]=(u*P-h*_+f*b)*M,e[8]=(s*A-a*T+c*S)*M,e[9]=(i*T-n*A-o*S)*M,e[10]=(p*x-g*_+v*y)*M,e[11]=(d*_-u*x-f*y)*M,e[12]=(a*E-s*C-l*S)*M,e[13]=(n*C-i*E+r*S)*M,e[14]=(g*b-p*w-m*y)*M,e[15]=(u*w-d*b+h*y)*M,e):null}function Re(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=t[9],f=t[10],p=t[11],g=t[12],m=t[13],v=t[14],y=t[15],b=n[0],_=n[1],w=n[2],x=n[3];return e[0]=b*i+_*a+w*d+x*g,e[1]=b*r+_*l+w*h+x*m,e[2]=b*o+_*c+w*f+x*v,e[3]=b*s+_*u+w*p+x*y,b=n[4],_=n[5],w=n[6],x=n[7],e[4]=b*i+_*a+w*d+x*g,e[5]=b*r+_*l+w*h+x*m,e[6]=b*o+_*c+w*f+x*v,e[7]=b*s+_*u+w*p+x*y,b=n[8],_=n[9],w=n[10],x=n[11],e[8]=b*i+_*a+w*d+x*g,e[9]=b*r+_*l+w*h+x*m,e[10]=b*o+_*c+w*f+x*v,e[11]=b*s+_*u+w*p+x*y,b=n[12],_=n[13],w=n[14],x=n[15],e[12]=b*i+_*a+w*d+x*g,e[13]=b*r+_*l+w*h+x*m,e[14]=b*o+_*c+w*f+x*v,e[15]=b*s+_*u+w*p+x*y,e}function Ie(e,t,n){var i,r,o,s,a,l,c,u,d,h,f,p,g=n[0],m=n[1],v=n[2];return t===e?(e[12]=t[0]*g+t[4]*m+t[8]*v+t[12],e[13]=t[1]*g+t[5]*m+t[9]*v+t[13],e[14]=t[2]*g+t[6]*m+t[10]*v+t[14],e[15]=t[3]*g+t[7]*m+t[11]*v+t[15]):(i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=t[9],f=t[10],p=t[11],e[0]=i,e[1]=r,e[2]=o,e[3]=s,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=d,e[9]=h,e[10]=f,e[11]=p,e[12]=i*g+a*m+d*v+t[12],e[13]=r*g+l*m+h*v+t[13],e[14]=o*g+c*m+f*v+t[14],e[15]=s*g+u*m+p*v+t[15]),e}function ze(e,t,n){var i=n[0],r=n[1],o=n[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Fe(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],d=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*r+c*i,e[5]=s*r+u*i,e[6]=a*r+d*i,e[7]=l*r+h*i,e[8]=c*r-o*i,e[9]=u*r-s*i,e[10]=d*r-a*i,e[11]=h*r-l*i,e}function De(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[0],s=t[1],a=t[2],l=t[3],c=t[4],u=t[5],d=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r+c*i,e[1]=s*r+u*i,e[2]=a*r+d*i,e[3]=l*r+h*i,e[4]=c*r-o*i,e[5]=u*r-s*i,e[6]=d*r-a*i,e[7]=h*r-l*i,e}var je=function(e,t,n,i,r){var o,s=1/Math.tan(t/2);return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(o=1/(i-r),e[10]=(r+i)*o,e[14]=2*r*i*o):(e[10]=-1,e[14]=-2*i),e};var Ne=function(e,t,n,i,r,o,s){var a=1/(t-n),l=1/(i-r),c=1/(o-s);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*a,e[13]=(r+i)*l,e[14]=(s+o)*c,e[15]=1,e};function Be(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function Ue(e){var t=e[0],n=e[1];return Math.hypot(t,n)}function Ve(e,t,n,i){var r=t[0],o=t[1];return e[0]=r+i*(n[0]-r),e[1]=o+i*(n[1]-o),e}var We=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e};!function(){var e=function(){var e=new ve(2);return ve!=Float32Array&&(e[0]=0,e[1]=0),e}()}();function Ge(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function He(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3];return e[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,e[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,e[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,e[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,e}var qe;!function(){var e=function(){var e=new ve(4);return ve!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();!function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"}(qe||(qe={}));const Xe=45*Math.PI/180,Ze=1,Ye=.1,Ke=500,Qe=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class $e extends Le{static get IDENTITY(){return function(){et||(et=new $e,Object.freeze(et));return et}()}static get ZERO(){return function(){Je||(Je=new $e([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Je));return Je}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return qe}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,n,i,r,o,s,a,l,c,u,d,h,f,p,g){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this[4]=r,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this[9]=c,this[10]=u,this[11]=d,this[12]=h,this[13]=f,this[14]=p,this[15]=g,this.check()}setRowMajor(e,t,n,i,r,o,s,a,l,c,u,d,h,f,p,g){return this[0]=e,this[1]=r,this[2]=l,this[3]=h,this[4]=t,this[5]=o,this[6]=c,this[7]=f,this[8]=n,this[9]=s,this[10]=u,this[11]=p,this[12]=i,this[13]=a,this[14]=d,this[15]=g,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Qe)}fromObject(e){return this.check()}fromQuaternion(e){return function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=n+n,a=i+i,l=r+r,c=n*s,u=i*s,d=i*a,h=r*s,f=r*a,p=r*l,g=o*s,m=o*a,v=o*l;e[0]=1-d-p,e[1]=u+v,e[2]=h-m,e[3]=0,e[4]=u-v,e[5]=1-c-p,e[6]=f+g,e[7]=0,e[8]=h+m,e[9]=f-g,e[10]=1-c-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this.check()}frustum(e){const{left:t,right:n,bottom:i,top:r,near:o=Ye,far:s=Ke}=e;return s===1/0?function(e,t,n,i,r,o){const s=2*o/(n-t),a=2*o/(r-i),l=(n+t)/(n-t),c=(r+i)/(r-i),u=-1,d=-1,h=-2*o;e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=l,e[9]=c,e[10]=u,e[11]=d,e[12]=0,e[13]=0,e[14]=h,e[15]=0}(this,t,n,i,r,o):function(e,t,n,i,r,o,s){var a=1/(n-t),l=1/(r-i),c=1/(o-s);e[0]=2*o*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(n+t)*a,e[9]=(r+i)*l,e[10]=(s+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*o*2*c,e[15]=0}(this,t,n,i,r,o,s),this.check()}lookAt(e){const{eye:t,center:n=[0,0,0],up:i=[0,1,0]}=e;return function(e,t,n,i){var r,o,s,a,l,c,u,d,h,f,p=t[0],g=t[1],m=t[2],v=i[0],y=i[1],b=i[2],_=n[0],w=n[1],x=n[2];Math.abs(p-_)<me&&Math.abs(g-w)<me&&Math.abs(m-x)<me?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(e):(u=p-_,d=g-w,h=m-x,r=y*(h*=f=1/Math.hypot(u,d,h))-b*(d*=f),o=b*(u*=f)-v*h,s=v*d-y*u,(f=Math.hypot(r,o,s))?(r*=f=1/f,o*=f,s*=f):(r=0,o=0,s=0),a=d*s-h*o,l=h*r-u*s,c=u*o-d*r,(f=Math.hypot(a,l,c))?(a*=f=1/f,l*=f,c*=f):(a=0,l=0,c=0),e[0]=r,e[1]=a,e[2]=u,e[3]=0,e[4]=o,e[5]=l,e[6]=d,e[7]=0,e[8]=s,e[9]=c,e[10]=h,e[11]=0,e[12]=-(r*p+o*g+s*m),e[13]=-(a*p+l*g+c*m),e[14]=-(u*p+d*g+h*m),e[15]=1)}(this,t,n,i),this.check()}ortho(e){const{left:t,right:n,bottom:i,top:r,near:o=Ye,far:s=Ke}=e;return Ne(this,t,n,i,r,o,s),this.check()}orthographic(e){const{fovy:t=Xe,aspect:n=Ze,focalDistance:i=1,near:r=Ye,far:o=Ke}=e;tt(t);const s=t/2,a=i*Math.tan(s),l=a*n;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:o})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:n=1,near:i=.1,far:r=500}=e;return tt(t),je(this,t,n,i,r),this.check()}determinant(){return function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],d=e[10],h=e[11],f=e[12],p=e[13],g=e[14],m=e[15];return(t*s-n*o)*(d*m-h*g)-(t*a-i*o)*(u*m-h*p)+(t*l-r*o)*(u*g-d*p)+(n*a-i*s)*(c*m-h*f)-(n*l-r*s)*(c*g-d*f)+(i*l-r*a)*(c*p-u*f)}(this)}getScale(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),i=1/n[0],r=1/n[1],o=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*r,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*r,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*r,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),i=1/n[0],r=1/n[1],o=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*r,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*r,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*r,e[8]=this[10]*o,e}transpose(){return function(e,t){if(e===t){var n=t[1],i=t[2],r=t[3],o=t[6],s=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=o,e[11]=t[14],e[12]=r,e[13]=s,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]}(this,this),this.check()}invert(){return Oe(this,this),this.check()}multiplyLeft(e){return Re(this,e,this),this.check()}multiplyRight(e){return Re(this,this,e),this.check()}rotateX(e){return Fe(this,this,e),this.check()}rotateY(e){return function(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[0],s=t[1],a=t[2],l=t[3],c=t[8],u=t[9],d=t[10],h=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r-c*i,e[1]=s*r-u*i,e[2]=a*r-d*i,e[3]=l*r-h*i,e[8]=o*i+c*r,e[9]=s*i+u*r,e[10]=a*i+d*r,e[11]=l*i+h*r}(this,this,e),this.check()}rotateZ(e){return De(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return function(e,t,n,i){var r,o,s,a,l,c,u,d,h,f,p,g,m,v,y,b,_,w,x,P,S,E,T,C,A=i[0],k=i[1],M=i[2],L=Math.hypot(A,k,M);L<me||(A*=L=1/L,k*=L,M*=L,r=Math.sin(n),s=1-(o=Math.cos(n)),a=t[0],l=t[1],c=t[2],u=t[3],d=t[4],h=t[5],f=t[6],p=t[7],g=t[8],m=t[9],v=t[10],y=t[11],b=A*A*s+o,_=k*A*s+M*r,w=M*A*s-k*r,x=A*k*s-M*r,P=k*k*s+o,S=M*k*s+A*r,E=A*M*s+k*r,T=k*M*s-A*r,C=M*M*s+o,e[0]=a*b+d*_+g*w,e[1]=l*b+h*_+m*w,e[2]=c*b+f*_+v*w,e[3]=u*b+p*_+y*w,e[4]=a*x+d*P+g*S,e[5]=l*x+h*P+m*S,e[6]=c*x+f*P+v*S,e[7]=u*x+p*P+y*S,e[8]=a*E+d*T+g*C,e[9]=l*E+h*T+m*C,e[10]=c*E+f*T+v*C,e[11]=u*E+p*T+y*C,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,this,e,t),this.check()}scale(e){return ze(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Ie(this,this,e),this.check()}transform(e,t){return 4===e.length?(fe(t=He(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:n}=e;let i;switch(n){case 2:i=function(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[4]*r+n[12],e[1]=n[1]*i+n[5]*r+n[13],e}(t||[-0,-0],e,this);break;case 3:i=ye(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return fe(i,e.length),i}transformAsVector(e,t){let n;switch(e.length){case 2:n=function(e,t,n){const i=t[0],r=t[1],o=n[3]*i+n[7]*r||1;return e[0]=(n[0]*i+n[4]*r)/o,e[1]=(n[1]*i+n[5]*r)/o,e}(t||[-0,-0],e,this);break;case 3:n=xe(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return fe(n,e.length),n}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,n){return this.identity().translate([e,t,n])}}let Je,et;function tt(e){if(e>2*Math.PI)throw Error("expected radians")}function nt(e,t){const n=He([],t,e);return Ge(n,n,1/n[3]),n}function it(e,t){const n=e%t;return n<0?t+n:n}function rt(e,t,n){return e<t?t:e>n?n:e}const ot=Math.log2||function(e){return Math.log(e)*Math.LOG2E};function st(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const at=Math.PI,lt=at/4,ct=at/180,ut=180/at,dt=512,ht=4003e4,ft=85.051129,pt=1.5;function gt(e){return Math.pow(2,e)}function mt(e){return ot(e)}function vt(e){const[t,n]=e;st(Number.isFinite(t)),st(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=n*ct;return[dt*(t*ct+at)/(2*at),dt*(at+Math.log(Math.tan(lt+.5*i)))/(2*at)]}function yt(e){const[t,n]=e,i=t/dt*(2*at)-at,r=2*(Math.atan(Math.exp(n/dt*(2*at)-at))-lt);return[i*ut,r*ut]}function bt(e){const t=Math.cos(e*ct);return dt/ht/t}function _t(e){const{latitude:t,longitude:n,highPrecision:i=!1}=e;st(Number.isFinite(t)&&Number.isFinite(n));const r=dt,o=Math.cos(t*ct),s=r/360,a=s/o,l=r/ht/o,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[s,a,l],degreesPerUnit:[1/s,1/a,1/l]};if(i){const e=ct*Math.tan(t*ct)/o,n=s*e/2,i=r/ht*e,u=i/a*l;c.unitsPerDegree2=[0,n,i],c.unitsPerMeter2=[u,0,u]}return c}function wt(e,t){const[n,i,r]=e,[o,s,a]=t,{unitsPerMeter:l,unitsPerMeter2:c}=_t({longitude:n,latitude:i,highPrecision:!0}),u=vt(e);u[0]+=o*(l[0]+c[0]*s),u[1]+=s*(l[1]+c[1]*s);const d=yt(u),h=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[d[0],d[1],h]:d}function xt(e){const{width:t,height:n,altitude:i,pitch:r=0,offset:o,center:s,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=e;let{fovy:u=Pt(pt)}=e;void 0!==i&&(u=Pt(i));const d=u*ct,h=r*ct,f=St(u);let p=f;s&&(p+=s[2]*a/Math.cos(h)/n);const g=d*(.5+(o?o[1]:0)/n),m=Math.sin(g)*p/Math.sin(rt(Math.PI/2-h-g,.01,Math.PI-.01)),v=Math.sin(h)*m+p,y=10*p;return{fov:d,aspect:t/n,focalDistance:f,near:l,far:Math.min(v*c,y)}}function Pt(e){return 2*Math.atan(.5/e)*ut}function St(e){return.5/Math.tan(.5*e*ct)}function Et(e,t){const[n,i,r=0]=e;return st(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),nt(t,[n,i,r,1])}function Tt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const[i,r,o]=e;if(st(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(o)){return nt(t,[i,r,o,1])}const s=nt(t,[i,r,0,1]),a=nt(t,[i,r,1,1]),l=s[2],c=a[2];return Ve([],s,a,l===c?0:((n||0)-l)/(c-l))}function Ct(e){const{width:t,height:n,bounds:i,minExtent:r=0,maxZoom:o=24,offset:s=[0,0]}=e,[[a,l],[c,u]]=i,d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("number"===typeof e)return{top:e,bottom:e,left:e,right:e};return st(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e}(e.padding),h=vt([a,rt(u,-85.051129,ft)]),f=vt([c,rt(l,-85.051129,ft)]),p=[Math.max(Math.abs(f[0]-h[0]),r),Math.max(Math.abs(f[1]-h[1]),r)],g=[t-d.left-d.right-2*Math.abs(s[0]),n-d.top-d.bottom-2*Math.abs(s[1])];st(g[0]>0&&g[1]>0);const m=g[0]/p[0],v=g[1]/p[1],y=(d.right-d.left)/2/m,b=(d.top-d.bottom)/2/v,_=yt([(f[0]+h[0])/2+y,(f[1]+h[1])/2+b]),w=Math.min(o,ot(Math.abs(Math.min(m,v))));return st(Number.isFinite(w)),{longitude:_[0],latitude:_[1],zoom:w}}const At=Math.PI/180;function kt(e,t,n){const{pixelUnprojectionMatrix:i}=e,r=nt(i,[t,0,1,1]),o=nt(i,[t,e.height,1,1]),s=yt(Ve([],r,o,(n*e.distanceScales.unitsPerMeter[2]-r[2])/(o[2]-r[2])));return s.push(n),s}const Mt=.01,Lt=["longitude","latitude","zoom"],Ot={curve:1.414,speed:1.2};function Rt(e,t,n){const i=(n=Object.assign({},Ot,n)).curve,r=e.zoom,o=[e.longitude,e.latitude],s=gt(r),a=t.zoom,l=[t.longitude,t.latitude],c=gt(a-r),u=vt(o),d=vt(l),h=We([],d,u),f=Math.max(e.width,e.height),p=f/c,g=Ue(h)*s,m=Math.max(g,Mt),v=i*i,y=(p*p-f*f+v*v*m*m)/(2*f*v*m),b=(p*p-f*f-v*v*m*m)/(2*p*v*m),_=Math.log(Math.sqrt(y*y+1)-y),w=Math.log(Math.sqrt(b*b+1)-b);return{startZoom:r,startCenterXY:u,uDelta:h,w0:f,u1:g,S:(w-_)/i,rho:i,rho2:v,r0:_,r1:w}}const It={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(It,"IDENTITY",{get:()=>(ne.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const zt={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Ft={common:0,meters:1,pixels:2},Dt={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},jt=Math.PI/180,Nt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Bt=[0,0,0],Ut={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class Vt{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};I(this,"id",void 0),I(this,"x",void 0),I(this,"y",void 0),I(this,"width",void 0),I(this,"height",void 0),I(this,"padding",void 0),I(this,"isGeospatial",void 0),I(this,"zoom",void 0),I(this,"focalDistance",void 0),I(this,"position",void 0),I(this,"modelMatrix",void 0),I(this,"distanceScales",void 0),I(this,"scale",void 0),I(this,"center",void 0),I(this,"cameraPosition",void 0),I(this,"projectionMatrix",void 0),I(this,"viewMatrix",void 0),I(this,"viewMatrixUncentered",void 0),I(this,"viewMatrixInverse",void 0),I(this,"viewProjectionMatrix",void 0),I(this,"pixelProjectionMatrix",void 0),I(this,"pixelUnprojectionMatrix",void 0),I(this,"resolution",void 0),I(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||Ut,this.focalDistance=e.focalDistance||1,this.position=e.position||Bt,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?zt.WEB_MERCATOR:zt.WEB_MERCATOR_AUTO_OFFSET:zt.IDENTITY}equals(e){return e instanceof Vt&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&ce(e.projectionMatrix,this.projectionMatrix)&&ce(e.viewMatrix,this.viewMatrix))}project(e){let{topLeft:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Et(this.projectPosition(e),this.pixelProjectionMatrix),[i,r]=n,o=t?r:this.height-r;return 2===e.length?[i,o]:[i,o,n[2]]}unproject(e){let{topLeft:t=!0,targetZ:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[i,r,o]=e,s=t?r:this.height-r,a=n&&n*this.distanceScales.unitsPerMeter[2],l=Tt([i,s,o],this.pixelUnprojectionMatrix,a),[c,u,d]=this.unprojectPosition(l);return Number.isFinite(o)?[c,u,d]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(e){const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){if(this.isGeospatial){const t=vt(e);return t[1]=ae(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?yt(e):e}getBounds(){const e={targetZ:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0},t=this.unproject([0,0],e),n=this.unproject([this.width,0],e),i=this.unproject([0,this.height],e),r=this.unproject([this.width,this.height],e);return[Math.min(t[0],n[0],i[0],r[0]),Math.min(t[1],n[1],i[1],r[1]),Math.max(t[0],n[0],i[0],r[0]),Math.max(t[1],n[1],i[1],r[1])]}getDistanceScales(e){return e?_t({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel(e){let{x:t,y:n,width:i=1,height:r=1}=e;return t<this.x+this.width&&this.x<t+i&&n<this.y+this.height&&this.y<n+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,{left:Ce((e=this.viewProjectionMatrix)[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),right:Ce(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),bottom:Ce(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),top:Ce(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),near:Ce(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),far:Ce(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14])}),this._frustumPlanes;var e}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=function(e){const{latitude:t}=e;st(Number.isFinite(t));const n=Math.cos(t*ct);return mt(ht*n)-9}({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||_t({latitude:n,longitude:t}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:r,modelMatrix:o}=e;let s=Bt;if(r&&(s=o?new $e(o).transformAsVector(r,[]):r),this.isGeospatial){const e=this.projectPosition([t,n,0]);this.center=new Ee(s).scale(this.distanceScales.unitsPerMeter).add(e)}else this.center=this.projectPosition(s)}_initMatrices(e){const{viewMatrix:t=Nt,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:r,fovy:o=75,near:s=.1,far:a=1e3,padding:l=null,focalDistance:c=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=(new $e).multiplyRight(t).translate(new Ee(this.center).negate()),this.projectionMatrix=n||function(e){let{width:t,height:n,orthographic:i,fovyRadians:r,focalDistance:o,padding:s,near:a,far:l}=e;const c=t/n,u=i?(new $e).orthographic({fovy:r,aspect:c,focalDistance:o,near:a,far:l}):(new $e).perspective({fovy:r,aspect:c,near:a,far:l});if(s){const{left:e=0,right:i=0,top:r=0,bottom:o=0}=s,a=ae((e+t-i)/2,0,t)-t/2,l=ae((r+n-o)/2,0,n)-n/2;u[8]-=2*a/t,u[9]+=2*l/n}return u}({width:this.width,height:this.height,orthographic:i,fovyRadians:r||o*jt,focalDistance:c,padding:l,near:s,far:a});const u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var d;Re(u,u,this.projectionMatrix),Re(u,u,this.viewMatrix),this.viewProjectionMatrix=u,this.viewMatrixInverse=Oe([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(d=this.viewMatrixInverse)[12],d[13],d[14]];const h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];ze(h,h,[this.width/2,-this.height/2,1]),Ie(h,h,[1,-1,0]),Re(f,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=f,this.pixelUnprojectionMatrix=Oe([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||ne.warn("Pixel project matrix not invertible")()}}I(Vt,"displayName","Viewport");const Wt=/([0-9]+\.?[0-9]*)(%|px)/;function Gt(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":const t=Wt.exec(e);if(t&&t.length>=3){const e="%"===t[2],n=parseFloat(t[1]);return{position:e?n/100:n,relative:e}}default:throw new Error("Could not parse position string ".concat(e))}}function Ht(e,t){return e.relative?Math.round(e.position*t):e.position}function qt(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!qt(e[i],t[i],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(const o of i){if(!t.hasOwnProperty(o))return!1;if(!qt(e[o],t[o],n-1))return!1}return!0}return!1}function Xt(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}class Zt{constructor(e){I(this,"id",void 0),I(this,"viewportInstance",void 0),I(this,"_x",void 0),I(this,"_y",void 0),I(this,"_width",void 0),I(this,"_height",void 0),I(this,"_padding",void 0),I(this,"props",void 0);const{id:t,x:n=0,y:i=0,width:r="100%",height:o="100%",padding:s=null,viewportInstance:a}=e||{};Xt(!a||a instanceof Vt),this.viewportInstance=a,this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Gt(n),this._y=Gt(i),this._width=Gt(r),this._height=Gt(o),this._padding=s&&{left:Gt(s.left||0),right:Gt(s.right||0),top:Gt(s.top||0),bottom:Gt(s.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?!!e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):this.ViewportType===e.ViewportType&&qt(this.props,e.props,2))}makeViewport(e){let{width:t,height:n,viewState:i}=e;if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:t,height:n});return r.height&&r.width?new this.ViewportType({...i,...this.props,...r}):null}getViewStateId(){const{viewState:e}=this.props;return"string"===typeof e?e:(null===e||void 0===e?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&"object"===typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const e in this.props.viewState)"id"!==e&&(t[e]=this.props.viewState[e]);return t}return e}getDimensions(e){let{width:t,height:n}=e;const i={x:Ht(this._x,t),y:Ht(this._y,n),width:Ht(this._width,t),height:Ht(this._height,n)};return this._padding&&(i.padding={left:Ht(this._padding.left,t),top:Ht(this._padding.top,n),right:Ht(this._padding.right,t),bottom:Ht(this._padding.bottom,n)}),i}get controller(){const e=this.props.controller;return e?!0===e?{type:this.ControllerType}:"function"===typeof e?{type:e}:{type:this.ControllerType,...e}:null}}const Yt=Math.PI/180,Kt=180/Math.PI,Qt=6370972,$t=256;function Jt(){const e=4018225162502676e-20,t=Math.PI/180*$t;return{unitsPerMeter:[e,e,e],unitsPerMeter2:[0,0,0],metersPerUnit:[24886.609375,24886.609375,24886.609375],unitsPerDegree:[t,t,e],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/t,1/t,24886.609375]}}class en extends Vt{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{latitude:t=0,longitude:n=0,zoom:i=0,nearZMultiplier:r=.1,farZMultiplier:o=2,resolution:s=10}=e;let{height:a,altitude:l=1.5}=e;a=a||1,l=Math.max(.75,l);const c=(new $e).lookAt({eye:[0,-l,0],up:[0,0,1]}),u=Math.pow(2,i);c.rotateX(t*Yt),c.rotateZ(-n*Yt),c.scale(u/a);const d=Math.atan(.5/l),h=512*u/a;super({...e,height:a,viewMatrix:c,longitude:n,latitude:t,zoom:i,distanceScales:Jt(),fovyRadians:2*d,focalDistance:l,near:r,far:Math.min(2,1/h+1)*l*o}),I(this,"longitude",void 0),I(this,"latitude",void 0),I(this,"resolution",void 0),this.latitude=t,this.longitude=n,this.resolution=s}get projectionMode(){return zt.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(){const e={targetZ:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0},t=this.unproject([0,this.height/2],e),n=this.unproject([this.width/2,0],e),i=this.unproject([this.width,this.height/2],e),r=this.unproject([this.width/2,this.height],e);return i[0]<this.longitude&&(i[0]+=360),t[0]>this.longitude&&(t[0]-=360),[Math.min(t[0],i[0],n[0],r[0]),Math.min(t[1],i[1],n[1],r[1]),Math.max(t[0],i[0],n[0],r[0]),Math.max(t[1],i[1],n[1],r[1])]}unproject(e){let{topLeft:t=!0,targetZ:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[i,r,o]=e,s=t?r:this.height-r,{pixelUnprojectionMatrix:a}=this;let l;if(Number.isFinite(o))l=tn(a,[i,s,o,1]);else{const e=tn(a,[i,s,-1,1]),t=tn(a,[i,s,1,1]),r=((n||0)/Qt+1)*$t,o=we(be([],e,t)),c=we(e),u=we(t),d=4*((4*c*u-(o-c-u)**2)/16)/o;l=function(e,t,n,i){var r=t[0],o=t[1],s=t[2];return e[0]=r+i*(n[0]-r),e[1]=o+i*(n[1]-o),e[2]=s+i*(n[2]-s),e}([],e,t,(Math.sqrt(c-d)-Math.sqrt(Math.max(0,r*r-d)))/Math.sqrt(o))}const[c,u,d]=this.unprojectPosition(l);return Number.isFinite(o)?[c,u,d]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(e){const[t,n,i=0]=e,r=t*Yt,o=n*Yt,s=Math.cos(o),a=(i/Qt+1)*$t;return[Math.sin(r)*s*a,-Math.cos(r)*s*a,Math.sin(o)*a]}unprojectPosition(e){const[t,n,i]=e,r=_e(e),o=Math.asin(i/r);return[Math.atan2(t,-n)*Kt,o*Kt,(r/$t-1)*Qt]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,t){const n=this.unproject(t);return{longitude:e[0]-n[0]+this.longitude,latitude:e[1]-n[1]+this.latitude}}}function tn(e,t){const n=He([],t,e);return Ge(n,n,1/n[3]),n}class nn{constructor(e){I(this,"_inProgress",void 0),I(this,"_handle",void 0),I(this,"_timeline",void 0),I(this,"time",void 0),I(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var t,n;this.cancel(),this.settings=e,this._inProgress=!0,null===(t=(n=this.settings).onStart)||void 0===t||t.call(n,this)}end(){var e,t;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(e=(t=this.settings).onEnd)||void 0===e||e.call(t,this))}cancel(){var e,t;this._inProgress&&(null===(e=(t=this.settings).onInterrupt)||void 0===e||e.call(t,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,t;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(e=(t=this.settings).onUpdate)||void 0===e||e.call(t,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const rn=()=>{},on=2,sn=3,an=e=>e,ln=1;class cn{constructor(e){I(this,"getControllerState",void 0),I(this,"props",void 0),I(this,"propsInTransition",void 0),I(this,"transition",void 0),I(this,"onViewStateChange",void 0),I(this,"onStateChange",void 0),I(this,"_onTransitionUpdate",(e=>{const{time:t,settings:{interpolator:n,startProps:i,endProps:r,duration:o,easing:s}}=e,a=s(t/o),l=n.interpolateProps(i,r,a);this.propsInTransition=this.getControllerState({...this.props,...l}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})})),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new nn(e.timeline),this.onViewStateChange=e.onViewStateChange||rn,this.onStateChange=e.onStateChange||rn}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let i=n;if(this.transition.inProgress){const{interruption:e,endProps:t}=this.transition.settings;i={...n,...e===on?t:this.propsInTransition||n}}this._triggerTransition(i,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:n}=e;return(t>0||"auto"===t)&&Boolean(n)}_isUpdateDueToCurrentTransition(e){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?this.transition.settings.interruption===sn||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const n=this.getControllerState(e),i=this.getControllerState(t).shortestPathFrom(n),r=t.transitionInterpolator,o=r.getDuration?r.getDuration(e,t):t.transitionDuration;if(0===o)return;const s=r.initializeProps(e,i);this.propsInTransition={};const a={duration:o,easing:t.transitionEasing||an,interpolator:r,interruption:t.transitionInterruption||ln,startProps:s.start,endProps:s.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(a),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null===e||void 0===e||e(t)}}}class un{constructor(e){I(this,"_propsToCompare",void 0),I(this,"_propsToExtract",void 0),I(this,"_requiredProps",void 0);const{compare:t,extract:n,required:i}=e;this._propsToCompare=t,this._propsToExtract=n||t,this._requiredProps=i}arePropsEqual(e,t){for(const n of this._propsToCompare)if(!(n in e)||!(n in t)||!ce(e[n],t[n]))return!1;return!0}initializeProps(e,t){const n={},i={};for(const r of this._propsToExtract)(r in e||r in t)&&(n[r]=e[r],i[r]=t[r]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach((t=>{const n=e[t];Xt(Number.isFinite(n)||Array.isArray(n),"".concat(t," is required for transition"))}))}}const dn=["longitude","latitude","zoom","bearing","pitch"],hn=["longitude","latitude","zoom"];class fn extends un{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:dn,required:hn},super(n.transitionProps),I(this,"opts",void 0),this.opts=n}initializeProps(e,t){const n=super.initializeProps(e,t),{makeViewport:i,around:r}=this.opts;if(i&&r){const o=i(e),s=i(t),a=o.unproject(r);n.start.around=r,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:t.width,height:t.height})}return n}interpolateProps(e,t,n){const i={};for(const r of this._propsToExtract)i[r]=le(e[r]||0,t[r]||0,n);if(t.aroundPosition&&this.opts.makeViewport){const r=this.opts.makeViewport({...t,...i});Object.assign(i,r.panByPosition(t.aroundPosition,le(e.around,t.around,n)))}return i}}const pn={transitionDuration:0},gn=e=>1-(1-e)*(1-e),mn=["wheel"],vn=["panstart","panmove","panend"],yn=["pinchstart","pinchmove","pinchend"],bn=["tripanstart","tripanmove","tripanend"],_n=["doubletap"],wn=["keydown"],xn={};class Pn{constructor(e){I(this,"props",void 0),I(this,"state",{}),I(this,"transitionManager",void 0),I(this,"eventManager",void 0),I(this,"onViewStateChange",void 0),I(this,"onStateChange",void 0),I(this,"makeViewport",void 0),I(this,"_controllerState",void 0),I(this,"_events",{}),I(this,"_interactionState",{isDragging:!1}),I(this,"_customEvents",[]),I(this,"_eventStartBlocked",null),I(this,"_panMove",!1),I(this,"invertPan",!1),I(this,"dragMode","rotate"),I(this,"inertia",0),I(this,"scrollZoom",!0),I(this,"dragPan",!0),I(this,"dragRotate",!0),I(this,"doubleClickZoom",!0),I(this,"touchZoom",!0),I(this,"touchRotate",!1),I(this,"keyboard",!0),this.transitionManager=new cn({...e,getControllerState:e=>new this.ControllerState(e),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const t in this._events){var e;if(this._events[t])null===(e=this.eventManager)||void 0===e||e.off(t,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!t&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:n}=this.props,{offsetCenter:i}=e;return[i.x-t,i.y-n]}isPointInBounds(e,t){const{width:n,height:i}=this.props;if(t&&t.handled)return!1;const r=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=i;return r&&t&&t.stopPropagation(),r}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout((()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)}),e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:!0===t?300:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:r=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:l=!0}=e,c=Boolean(this.onViewStateChange);this.toggleEvents(mn,c&&n),this.toggleEvents(vn,c&&(i||r)),this.toggleEvents(yn,c&&(s||a)),this.toggleEvents(bn,c&&a),this.toggleEvents(_n,c&&o),this.toggleEvents(wn,c&&l),this.scrollZoom=n,this.dragPan=i,this.dragRotate=r,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach((e=>{this._events[e]!==t&&(this._events[e]=t,t?this.eventManager.on(e,this.handleEvent):this.eventManager.off(e,this.handleEvent))}))}updateViewport(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={...e.getViewportProps(),...t},r=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),r){const e=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:e})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:t});return this._panMove=n,this.updateViewport(i,pn,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),n=this.controllerState.pan({pos:t});return this.updateViewport(n,pn,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],r=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:gn},{isDragging:!1,isPanning:!0})}else{const e=this.controllerState.panEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),n=this.controllerState.rotate({pos:t});return this.updateViewport(n,pn,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],r=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:gn},{isDragging:!1,isRotating:!0})}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:n=.01,smooth:i=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:r}=e;let o=2/(1+Math.exp(-Math.abs(r*n)));r<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:t}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.rotateStart({pos:t});return this.updateViewport(n,pn,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const n=this.controllerState.rotate({pos:t});return this.updateViewport(n,pn,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const n=this.getCenter(e),i=[n[0],n[1]+=e.velocityY*t/2],r=this.controllerState.rotate({pos:i});this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:gn},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return xn._startPinchRotation=e.rotation,xn._lastPinchEvent=e,this.updateViewport(n,pn,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:n}=e,i=this.getCenter(e);t=t.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=e;t=t.rotate({deltaAngleX:xn._startPinchRotation-n})}return this.updateViewport(t,pn,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),xn._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:n}=xn;if(this.touchZoom&&t&&n&&e.scale!==n.scale){const i=this.getCenter(e);let r=this.controllerState.rotateEnd();const o=Math.log2(e.scale),s=(o-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),a=Math.pow(2,o+s*t/2);r=r.zoom({pos:i,scale:a}).zoomEnd(),this.updateViewport(r,{...this._getTransitionProps({around:i}),transitionDuration:t,transitionEasing:gn},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const e=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return xn._startPinchRotation=null,xn._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:t,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:r,rotateSpeedY:o}=!0===this.keyboard?{}:this.keyboard,{controllerState:s}=this;let a;const l={};switch(e.srcEvent.code){case"Minus":a=t?s.zoomOut(n).zoomOut(n):s.zoomOut(n),l.isZooming=!0;break;case"Equal":a=t?s.zoomIn(n).zoomIn(n):s.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":t?(a=s.rotateLeft(r),l.isRotating=!0):(a=s.moveLeft(i),l.isPanning=!0);break;case"ArrowRight":t?(a=s.rotateRight(r),l.isRotating=!0):(a=s.moveRight(i),l.isPanning=!0);break;case"ArrowUp":t?(a=s.rotateUp(o),l.isRotating=!0):(a=s.moveUp(i),l.isPanning=!0);break;case"ArrowDown":t?(a=s.rotateDown(o),l.isRotating=!0):(a=s.moveDown(i),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{transition:t}=this;return t&&t.transitionInterpolator?e?{...t,transitionInterpolator:new fn({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t:pn}}class Sn{constructor(e,t){I(this,"_viewportProps",void 0),I(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}class En extends Sn{constructor(e){const{width:t,height:n,latitude:i,longitude:r,zoom:o,bearing:s=0,pitch:a=0,altitude:l=1.5,position:c=[0,0,0],maxZoom:u=20,minZoom:d=0,maxPitch:h=60,minPitch:f=0,startPanLngLat:p,startZoomLngLat:g,startRotatePos:m,startBearing:v,startPitch:y,startZoom:b,normalize:_=!0}=e;Xt(Number.isFinite(r)),Xt(Number.isFinite(i)),Xt(Number.isFinite(o)),super({width:t,height:n,latitude:i,longitude:r,zoom:o,bearing:s,pitch:a,altitude:l,maxZoom:u,minZoom:d,maxPitch:h,minPitch:f,normalize:_,position:c},{startPanLngLat:p,startZoomLngLat:g,startRotatePos:m,startBearing:v,startPitch:y,startZoom:b}),I(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart(e){let{pos:t}=e;return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan(e){let{pos:t,startPos:n}=e;const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const r=this.makeViewport(this.getViewportProps()).panByPosition(i,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart(e){let{pos:t}=e;return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate(e){let{pos:t,deltaAngleX:n=0,deltaAngleY:i=0}=e;const{startRotatePos:r,startBearing:o,startPitch:s}=this.getState();if(!r||void 0===o||void 0===s)return this;let a;return a=t?this._getNewRotation(t,r,s,o):{bearing:o+n,pitch:s+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart(e){let{pos:t}=e;return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom(e){let{pos:t,startPos:n,scale:i}=e,{startZoom:r,startZoomLngLat:o}=this.getState();if(o||(r=this.getViewportProps().zoom,o=this._unproject(n)||this._unproject(t)),!o)return this;const{maxZoom:s,minZoom:a}=this.getViewportProps();let l=r+Math.log2(i);l=ae(l,a,s);const c=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...c.panByPosition(o,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(e)}zoomOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(1/e)}moveLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([e,0])}moveRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([-e,0])}moveUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,e])}moveDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,-e])}rotateLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:r}=n;return Math.abs(i-t.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(r-t.longitude)>180&&(n.longitude=r<0?r+360:r-360),n}applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:i}=e;e.zoom=ae(i,n,t);const{maxPitch:r,minPitch:o,pitch:s}=e;e.pitch=ae(s,o,r);const{normalize:a=!0}=e;return a&&Object.assign(e,function(e){const{width:t,height:n,pitch:i=0}=e;let{longitude:r,latitude:o,zoom:s,bearing:a=0}=e;(r<-180||r>180)&&(r=it(r+180,360)-180),(a<-180||a>180)&&(a=it(a+180,360)-180);const l=ot(n/512);if(s<=l)s=l,o=0;else{const e=n/2/Math.pow(2,s),t=yt([0,e])[1];if(o<t)o=t;else{const t=yt([0,512-e])[1];o>t&&(o=t)}}return{width:t,height:n,longitude:r,latitude:o,zoom:s,pitch:i,bearing:a}}(e)),e}_zoomFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.zoom({pos:[t/2,n/2],scale:e})}_panFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.pan({startPos:[t/2,n/2],pos:[t/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,n,i){const r=e[0]-t[0],o=e[1]-t[1],s=e[1],a=t[1],{width:l,height:c}=this.getViewportProps(),u=r/l;let d=0;o>0?Math.abs(c-a)>5&&(d=o/(a-c)*1.2):o<0&&a>5&&(d=1-s/a),d=ae(d,-1,1);const{minPitch:h,maxPitch:f}=this.getViewportProps();let p=n;return d>0?p=n+d*(f-n):d<0&&(p=n-d*(h-n)),{pitch:p,bearing:i+180*u}}}class Tn extends Pn{constructor(){super(...arguments),I(this,"ControllerState",En),I(this,"transition",{transitionDuration:300,transitionInterpolator:new fn({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),I(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e);(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Cn extends En{applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:i}=e;e.zoom=ae(i,n,t);const{longitude:r,latitude:o}=e;return(r<-180||r>180)&&(e.longitude=function(e,t){const n=e%t;return n<0?t+n:n}(r+180,360)-180),e.latitude=ae(o,-89,89),e}}class An extends Pn{constructor(){super(...arguments),I(this,"ControllerState",Cn),I(this,"transition",{transitionDuration:300,transitionInterpolator:new fn(["longitude","latitude","zoom"])}),I(this,"dragMode","pan")}setProps(e){super.setProps(e),this.dragRotate=!1,this.touchRotate=!1}}class kn extends Zt{get ViewportType(){return en}get ControllerType(){return An}}I(kn,"displayName","GlobeView");let Mn=1,Ln=1;class On{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:r=1}=e,o=Mn++,s={time:0,delay:t,duration:n,rate:i,repeat:r};return this._setChannelTime(s,this.time),this.channels.set(o,s),o}removeChannel(e){this.channels.delete(e);for(const[t,n]of this.animations)n.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const i of t)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:e,channel:t}=i;e.setTime(this.getTime(t))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const n=Ln++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const n=t-e.delay;n>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}const Rn="Awaiting state",In="Matched. State transferred from previous layer",zn="Initialized",Fn="Discarded. Awaiting garbage collection",Dn="No longer matched. Awaiting garbage collection",jn="Finalized! Awaiting garbage collection",Nn=Symbol.for("component"),Bn=Symbol.for("propTypes"),Un=Symbol.for("deprecatedProps"),Vn=Symbol.for("asyncPropDefaults"),Wn=Symbol.for("asyncPropOriginal"),Gn=Symbol.for("asyncPropResolved");let Hn={};function qn(e){Hn=e}function Xn(e,t,n,i){ne.level>0&&Hn[e]&&Hn[e].call(null,t,n,i)}function Zn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;return Array.isArray(e)?Yn(e,t,[]):t(e)?[e]:[]}function Yn(e,t,n){let i=-1;for(;++i<e.length;){const r=e[i];Array.isArray(r)?Yn(r,t,n):t(r)&&n.push(r)}return n}function Kn(e){let{target:t,source:n,start:i=0,count:r=1}=e;const o=n.length,s=r*o;let a=0;for(let l=i;a<o;a++)t[l++]=n[a];for(;a<s;)a<s-a?(t.copyWithin(i+a,i,i+a),a*=2):(t.copyWithin(i+a,i,i+s-a),a=s);return t}function Qn(){let e;if("undefined"!==typeof window&&window.performance)e=window.performance.now();else if("undefined"!==typeof process&&process.hrtime){const t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}class $n{constructor(e,t){I(this,"name",void 0),I(this,"type",void 0),I(this,"sampleSize",1),I(this,"time",void 0),I(this,"count",void 0),I(this,"samples",void 0),I(this,"lastTiming",void 0),I(this,"lastSampleTime",void 0),I(this,"lastSampleCount",void 0),I(this,"_count",0),I(this,"_time",0),I(this,"_samples",0),I(this,"_startTime",0),I(this,"_timerPending",!1),this.name=e,this.type=t,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Qn(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Qn()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Jn{constructor(e){I(this,"id",void 0),I(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach((t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((e=>this._getOrCreate(e)))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:n}=e;return this.stats[t]||(this.stats[t]=e instanceof $n?e:new $n(t,n)),this.stats[t]}}const ei=e=>"boolean"===typeof e,ti=e=>"function"===typeof e,ni=e=>null!==e&&"object"===typeof e,ii=e=>ni(e)&&e.constructor==={}.constructor,ri=e=>e&&"function"===typeof e[Symbol.iterator],oi=e=>e&&"function"===typeof e[Symbol.asyncIterator],si=e=>"undefined"!==typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,ai=e=>"undefined"!==typeof Blob&&e instanceof Blob,li=e=>e&&"object"===typeof e&&e.isBuffer,ci=e=>(e=>"undefined"!==typeof ReadableStream&&e instanceof ReadableStream||ni(e)&&ti(e.tee)&&ti(e.cancel)&&ti(e.getReader))(e)||(e=>ni(e)&&ti(e.read)&&ti(e.pipe)&&ei(e.readable))(e);function ui(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function di(e){var t;if(!e)return!1;Array.isArray(e)&&(e=e[0]);return Array.isArray(null===(t=e)||void 0===t?void 0:t.extensions)}function hi(e){var t,n;let i;return ui(e,"null loader"),ui(di(e),"invalid loader"),Array.isArray(e)&&(i=e[1],e=e[0],e={...e,options:{...e.options,...i}}),(null!==(t=e)&&void 0!==t&&t.parseTextSync||null!==(n=e)&&void 0!==n&&n.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}let fi="";const pi={};const gi=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,mi=/^([-\w.]+\/[-\w.+]+)/;function vi(e){const t=mi.exec(e);return t?t[1]:e}function yi(e){const t=gi.exec(e);return t?t[1]:""}const bi=/\?.*/;function _i(e){if(si(e)){const t=wi(e.url||"");return{url:t,type:vi(e.headers.get("content-type")||"")||yi(t)}}return ai(e)?{url:wi(e.name||""),type:e.type||""}:"string"===typeof e?{url:wi(e),type:yi(e)}:{url:"",type:""}}function wi(e){return e.replace(bi,"")}async function xi(e){if(si(e))return e;const t={},n=function(e){return si(e)?e.headers["content-length"]||-1:ai(e)?e.size:"string"===typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);n>=0&&(t["content-length"]=String(n));const{url:i,type:r}=_i(e);r&&(t["content-type"]=r);const o=await async function(e){const t=5;if("string"===typeof e)return"data:,".concat(e.slice(0,t));if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const n=new FileReader;n.onload=t=>{var n;return e(null===t||void 0===t||null===(n=t.target)||void 0===n?void 0:n.result)},n.readAsDataURL(t)}))}if(e instanceof ArrayBuffer){const n=function(e){let t="";const n=new Uint8Array(e);for(let i=0;i<n.byteLength;i++)t+=String.fromCharCode(n[i]);return btoa(t)}(e.slice(0,t));return"data:base64,".concat(n)}return null}(e);o&&(t["x-first-bytes"]=o),"string"===typeof e&&(e=(new TextEncoder).encode(e));const s=new Response(e,{headers:t});return Object.defineProperty(s,"url",{value:i}),s}async function Pi(e,t){if("string"===typeof e){e=function(e){for(const t in pi)if(e.startsWith(t)){const n=pi[t];e=e.replace(t,n)}return e.startsWith("http://")||e.startsWith("https://")||(e="".concat(fi).concat(e)),e}(e);let n=t;return null!==t&&void 0!==t&&t.fetch&&"function"!==typeof(null===t||void 0===t?void 0:t.fetch)&&(n=t.fetch),await fetch(e,n)}return await xi(e)}const Si=new $({id:"loaders.gl"});class Ei{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof n.g&&n.g,"undefined"!==typeof document&&document;const Ti=Boolean("object"!==typeof process||"[object process]"!==String(process)||process.browser),Ci="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version),Ai=(Ci&&parseFloat(Ci[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){I(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.log.bind(this.console,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.info.bind(this.console,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.warn.bind(this.console,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.error.bind(this.console,...t)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Ti,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),ki={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Mi(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state=e._state||{},e._state}const Li=()=>{const e=Mi();return e.globalOptions=e.globalOptions||{...Ai},e.globalOptions};function Oi(e,t,n,i){return n=n||[],function(e,t){Ii(e,null,Ai,ki,t);for(const n of t){const i=e&&e[n.id]||{},r=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};Ii(i,n.id,r,o,t)}}(e,n=Array.isArray(n)?n:[n]),Fi(t,e,i)}function Ri(e,t){const n=Li(),i=e||n;return"function"===typeof i.fetch?i.fetch:ni(i.fetch)?e=>Pi(e,i):null!==t&&void 0!==t&&t.fetch?null===t||void 0===t?void 0:t.fetch:Pi}function Ii(e,t,n,i,r){const o=t||"Top level",s=t?"".concat(t,"."):"";for(const a in e){const l=!t&&ni(e[a]);if(!(a in n)&&!("baseUri"===a&&!t)&&!("workerUrl"===a&&t))if(a in i)Si.warn("".concat(o," loader option '").concat(s).concat(a,"' no longer supported, use '").concat(i[a],"'"))();else if(!l){const e=zi(a,r);Si.warn("".concat(o," loader option '").concat(s).concat(a,"' not recognized. ").concat(e))()}}}function zi(e,t){const n=e.toLowerCase();let i="";for(const r of t)for(const t in r.options){if(e===t)return"Did you mean '".concat(r.id,".").concat(t,"'?");const o=t.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(t,"'?"))}return i}function Fi(e,t,n){const i={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(i,n),null===i.log&&(i.log=new Ei),Di(i,Li()),Di(i,t),i}function Di(e,t){for(const n in t)if(n in t){const i=t[n];ii(i)&&ii(e[n])?e[n]={...e[n],...t[n]}:e[n]=t[n]}}function ji(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}const Ni="3.3.4";"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof n.g&&n.g,"undefined"!==typeof document&&document;const Bi="object"!==typeof process||"[object process]"!==String(process)||process.browser,Ui="undefined"!==typeof window&&"undefined"!==typeof window.orientation,Vi="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version);Vi&&parseFloat(Vi[1]);class Wi{terminate(){}}const Gi=new Map;function Hi(e){ji(e.source&&!e.url||!e.source&&e.url);let t=Gi.get(e.source||e.url);return t||(e.url&&(t=function(e){if(!e.startsWith("http"))return e;return qi((t=e,"try {\n  importScripts('".concat(t,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")));var t}(e.url),Gi.set(e.url,t)),e.source&&(t=qi(e.source),Gi.set(e.source,t))),ji(t),t}function qi(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function Xi(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const i=n||new Set;if(e){if(Zi(e))i.add(e);else if(Zi(e.buffer))i.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"===typeof e)for(const r in e)Xi(e[r],t,i)}else;return void 0===n?Array.from(i):[]}function Zi(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!==typeof MessagePort&&e instanceof MessagePort||("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}const Yi=()=>{};class Ki{static isSupported(){return"undefined"!==typeof Worker&&Bi||"undefined"!==typeof Wi&&!Bi}constructor(e){I(this,"name",void 0),I(this,"source",void 0),I(this,"url",void 0),I(this,"terminated",!1),I(this,"worker",void 0),I(this,"onMessage",void 0),I(this,"onError",void 0),I(this,"_loadableURL","");const{name:t,source:n,url:i}=e;ji(n||i),this.name=t,this.source=n,this.url=i,this.onMessage=Yi,this.onError=e=>console.log(e),this.worker=Bi?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Yi,this.onError=Yi,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||Xi(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(t+="".concat(e.message," in ")),e.lineno&&(t+=":".concat(e.lineno,":").concat(e.colno)),new Error(t)}_createBrowserWorker(){this._loadableURL=Hi({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Wi(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new Wi(this.source,{eval:!0})}return e.on("message",(e=>{this.onMessage(e)})),e.on("error",(e=>{this.onError(e)})),e.on("exit",(e=>{})),e}}class Qi{constructor(e,t){I(this,"name",void 0),I(this,"workerThread",void 0),I(this,"isRunning",!0),I(this,"result",void 0),I(this,"_resolve",(()=>{})),I(this,"_reject",(()=>{})),this.name=e,this.workerThread=t,this.result=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){ji(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ji(this.isRunning),this.isRunning=!1,this._reject(e)}}class $i{static isSupported(){return Ki.isSupported()}constructor(e){I(this,"name","unnamed"),I(this,"source",void 0),I(this,"url",void 0),I(this,"maxConcurrency",1),I(this,"maxMobileConcurrency",1),I(this,"onDebug",(()=>{})),I(this,"reuseWorkers",!0),I(this,"props",{}),I(this,"jobQueue",[]),I(this,"idleQueue",[]),I(this,"count",0),I(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach((e=>e.destroy())),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t,n)=>e.done(n),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e.error(t);const i=new Promise((i=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:i}),this)));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const n=new Qi(t.name,e);e.onMessage=e=>t.onMessage(n,e.type,e.payload),e.onError=e=>t.onError(n,e),t.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Ki({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Ui?this.maxMobileConcurrency:this.maxConcurrency}}const Ji={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class er{static isSupported(){return Ki.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return er._workerFarm=er._workerFarm||new er({}),er._workerFarm.setProps(e),er._workerFarm}constructor(e){I(this,"props",void 0),I(this,"workerPools",new Map),this.props={...Ji},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:i}=e;let r=this.workerPools.get(t);return r||(r=new $i({name:t,source:n,url:i}),r.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,r)),r}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}I(er,"_workerFarm",void 0);const tr="latest";async function nr(e,t,n,i,r){const o=e.id,s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t[e.id]||{},i="".concat(e.id,"-worker.js");let r=n.workerUrl;if(r||"compression"!==e.id||(r=t.workerUrl),"test"===t._workerType&&(r="modules/".concat(e.module,"/dist/").concat(i)),!r){let t=e.version;"latest"===t&&(t=tr);const n=t?"@".concat(t):"";r="https://unpkg.com/@loaders.gl/".concat(e.module).concat(n,"/dist/").concat(i)}return ji(r),r}(e,n),a=er.getWorkerFarm(n).getWorkerPool({name:o,url:s});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const l=await a.startJob("process-on-worker",ir.bind(null,r));l.postMessage("process",{input:t,options:n,context:i});const c=await l.result;return await c.result}async function ir(e,t,n,i){switch(n){case"done":t.done(i);break;case"error":t.error(new Error(i.error));break;case"process":const{id:o,input:s,options:a}=i;try{const n=await e(s,a);t.postMessage("done",{id:o,result:n})}catch(r){const e=r instanceof Error?r.message:"unknown error";t.postMessage("error",{id:o,error:e})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}async function rr(e){const t=[];for await(const n of e)t.push(n);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=t.map((e=>e instanceof ArrayBuffer?new Uint8Array(e):e)),r=i.reduce(((e,t)=>e+t.byteLength),0),o=new Uint8Array(r);let s=0;for(const a of i)o.set(a,s),s+=a.byteLength;return o.buffer}(...t)}const or=262144;const sr=262144;const ar=1048576;var lr=n(521);function cr(e){if((t=e)&&"object"===typeof t&&t.isBuffer)return lr.toArrayBuffer(e);var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"===typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"===typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function ur(e,t){return Ti?async function*(e,t){const n=e.getReader();let i;try{for(;;){const e=i||n.read();null!==t&&void 0!==t&&t._streamReadAhead&&(i=n.read());const{done:r,value:o}=await e;if(r)return;yield cr(o)}}catch(r){n.releaseLock()}}(e,t):async function*(e,t){for await(const n of e)yield cr(n)}(e)}function dr(e,t){if("string"===typeof e)return function*(e,t){const n=(null===t||void 0===t?void 0:t.chunkSize)||or;let i=0;const r=new TextEncoder;for(;i<e.length;){const t=Math.min(e.length-i,n),o=e.slice(i,i+t);i+=t,yield r.encode(o)}}(e,t);if(e instanceof ArrayBuffer)return function*(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{chunkSize:n=sr}=t;let i=0;for(;i<e.byteLength;){const t=Math.min(e.byteLength-i,n),r=new ArrayBuffer(t),o=new Uint8Array(e,i,t);new Uint8Array(r).set(o),i+=t,yield r}}(e,t);if(ai(e))return async function*(e,t){const n=(null===t||void 0===t?void 0:t.chunkSize)||ar;let i=0;for(;i<e.size;){const t=i+n,r=await e.slice(i,t).arrayBuffer();i=t,yield r}}(e,t);if(ci(e))return ur(e,t);if(si(e)){return ur(e.body,t)}throw new Error("makeIterator")}const hr="Cannot convert supplied data type";async function fr(e,t,n){const i=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"===typeof e||i)return function(e,t,n){if(t.text&&"string"===typeof e)return e;if(li(e)&&(e=e.buffer),e instanceof ArrayBuffer){const n=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let n=e.buffer;const i=e.byteLength||e.length;return 0===e.byteOffset&&i===n.byteLength||(n=n.slice(e.byteOffset,e.byteOffset+i)),n}throw new Error(hr)}(e,t);if(ai(e)&&(e=await xi(e)),si(e)){const n=e;return await async function(e){if(!e.ok){const t=await async function(e){let t="Failed to fetch resource ".concat(e.url," (").concat(e.status,"): ");try{const n=e.headers.get("Content-Type");let i=e.statusText;n.includes("application/json")&&(i+=" ".concat(await e.text())),t+=i,t=t.length>60?"".concat(t.slice(0,60),"..."):t}catch(n){}return t}(e);throw new Error(t)}}(n),t.binary?await n.arrayBuffer():await n.text()}if(ci(e)&&(e=dr(e,n)),ri(e)||oi(e))return rr(e);throw new Error(hr)}const pr=new $({id:"loaders.gl"}),gr=()=>{const e=Mi();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};const mr=/\.([^.]+)$/;function vr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!yr(e))return null;if(t&&!Array.isArray(t))return hi(t);let r=[];t&&(r=r.concat(t)),null!==n&&void 0!==n&&n.ignoreRegisteredLoaders||r.push(...gr()),function(e){for(const t of e)hi(t)}(r);const o=function(e,t,n,i){const{url:r,type:o}=_i(e),s=r||(null===i||void 0===i?void 0:i.url);let a=null,l="";null!==n&&void 0!==n&&n.mimeType&&(a=_r(t,null===n||void 0===n?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(null===n||void 0===n?void 0:n.mimeType));var c;a=a||function(e,t){const n=t&&mr.exec(t),i=n&&n[1];return i?function(e,t){t=t.toLowerCase();for(const n of e)for(const e of n.extensions)if(e.toLowerCase()===t)return n;return null}(e,i):null}(t,s),l=l||(a?"matched url ".concat(s):""),a=a||_r(t,o),l=l||(a?"matched MIME type ".concat(o):""),a=a||function(e,t){if(!t)return null;for(const n of e)if("string"===typeof t){if(wr(t,n))return n}else if(ArrayBuffer.isView(t)){if(xr(t.buffer,t.byteOffset,n))return n}else if(t instanceof ArrayBuffer){if(xr(t,0,n))return n}return null}(t,e),l=l||(a?"matched initial data ".concat(Pr(e)):""),a=a||_r(t,null===n||void 0===n?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(o):""),l&&pr.log(1,"selectLoader selected ".concat(null===(c=a)||void 0===c?void 0:c.name,": ").concat(l,"."));return a}(e,r,n,i);if(!o&&(null===n||void 0===n||!n.nothrow))throw new Error(br(e));return o}function yr(e){return!(e instanceof Response&&204===e.status)}function br(e){const{url:t,type:n}=_i(e);let i="No valid loader found (";i+=t?"".concat(function(e){const t=e&&e.lastIndexOf("/");return t>=0?e.substr(t+1):""}(t),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=e?Pr(e):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function _r(e,t){for(const n of e){if(n.mimeTypes&&n.mimeTypes.includes(t))return n;if(t==="application/x.".concat(n.id))return n}return null}function wr(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function xr(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((i=>function(e,t,n,i){if(i instanceof ArrayBuffer)return function(e,t,n){if(n=n||e.byteLength,e.byteLength<n||t.byteLength<n)return!1;const i=new Uint8Array(e),r=new Uint8Array(t);for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0}(i,e,i.byteLength);switch(typeof i){case"function":return i(e,n);case"string":return i===Sr(e,t,i.length);default:return!1}}(e,t,n,i)))}function Pr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"===typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return Sr(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return Sr(e,0,t)}return""}function Sr(e,t,n){if(e.byteLength<t+n)return"";const i=new DataView(e);let r="";for(let o=0;o<n;o++)r+=String.fromCharCode(i.getUint8(t+o));return r}async function Er(e,t,n,i){ji(!i||"object"===typeof i),!t||Array.isArray(t)||di(t)||(i=void 0,n=t,t=void 0),e=await e,n=n||{};const{url:r}=_i(e),o=function(e,t){if(!t&&e&&!Array.isArray(e))return e;let n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[...n,...e]:e}return n&&n.length?n:null}(t,i),s=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!yr(e))return null;let r=vr(e,t,{...n,nothrow:!0},i);if(r)return r;if(ai(e)&&(r=vr(e=await e.slice(0,10).arrayBuffer(),t,n,i)),!r&&(null===n||void 0===n||!n.nothrow))throw new Error(br(e));return r}(e,o,n);return s?(i=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n)return n;const i={fetch:Ri(t,e),...e};return Array.isArray(i.loaders)||(i.loaders=null),i}({url:r,parse:Er,loaders:o},n=Oi(n,s,o,r),i),await async function(e,t,n,i){if(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ni;ji(e,"no worker provided");const n=e.version}(e),si(t)){const e=t,{ok:n,redirected:r,status:o,statusText:s,type:a,url:l}=e,c=Object.fromEntries(e.headers.entries());i.response={headers:c,ok:n,redirected:r,status:o,statusText:s,type:a,url:l}}if(t=await fr(t,e,n),e.parseTextSync&&"string"===typeof t)return n.dataType="text",e.parseTextSync(t,n,i,e);if(function(e,t){return!!er.isSupported()&&!!(Bi||null!==t&&void 0!==t&&t._nodeWorkers)&&e.worker&&(null===t||void 0===t?void 0:t.worker)}(e,n))return await nr(e,t,n,i,Er);if(e.parseText&&"string"===typeof t)return await e.parseText(t,n,i,e);if(e.parse)return await e.parse(t,n,i,e);throw ji(!e.parseSync),new Error("".concat(e.id," loader - no parser found and worker is disabled"))}(s,e,n,i)):null}async function Tr(e,t,n,i){Array.isArray(t)||di(t)||(void 0,n=t,t=void 0);const r=Ri(n);let o=e;return"string"===typeof e&&(o=await r(e)),ai(e)&&(o=await r(e)),await Er(o,t,n)}class Cr{constructor(e,t,n){I(this,"id",void 0),I(this,"context",void 0),I(this,"isLoaded",void 0),I(this,"persistent",void 0),I(this,"_loadCount",0),I(this,"_subscribers",new Set),I(this,"_data",void 0),I(this,"_loader",void 0),I(this,"_error",void 0),I(this,"_content",void 0),this.id=e,this.context=n,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(e,t){if(e===this._data&&!t)return;this._data=e;const n=++this._loadCount;let i=e;"string"===typeof e&&(i=Tr(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then((e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=e)})).catch((e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=e||!0)}))):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const r of this._subscribers)r.onChange(this.getData())}}class Ar{constructor(e){let{gl:t,protocol:n}=e;I(this,"protocol",void 0),I(this,"_context",void 0),I(this,"_resources",void 0),I(this,"_consumers",void 0),I(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add(e){let{resourceId:t,data:n,forceUpdate:i=!1,persistent:r=!0}=e,o=this._resources[t];o?o.setData(n,i):(o=new Cr(t,n,this._context),this._resources[t]=o),o.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe(e){let{consumerId:t}=e;const n=this._consumers[t];if(n){for(const e in n){const t=n[e],i=this._resources[t.resourceId];i&&i.unsubscribe(t)}delete this._consumers[t],this.prune()}}subscribe(e){let{resourceId:t,onChange:n,consumerId:i,requestId:r="default"}=e;const{_resources:o,protocol:s}=this;t.startsWith(s)&&(t=t.replace(s,""),o[t]||this.add({resourceId:t,data:null,persistent:!1}));const a=o[t];if(this._track(i,r,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,n,i){const r=this._consumers,o=r[e]=r[e]||{},s=o[t]||{},a=s.resourceId&&this._resources[s.resourceId];a&&(a.unsubscribe(s),this.prune()),n&&(o[t]=s,s.onChange=i,s.resourceId=n.id,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];t.persistent||t.inUse()||(t.delete(),delete this._resources[e])}}}const kr="vs",Mr="fs";function Lr(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}const Or={number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},array:{validate:(e,t)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function Rr(e){let t=Ir(e);return"object"===t?e?"type"in e?Object.assign({},e,Or[e.type]):"value"in e?(t=Ir(e.value),Object.assign({type:t},e,Or[t])):{type:"object",value:e}:{type:"object",value:null}:Object.assign({type:t,value:e},Or[t])}function Ir(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}class zr{constructor(e){let{name:t,vs:n,fs:i,dependencies:r=[],uniforms:o,getUniforms:s,deprecations:a=[],defines:l={},inject:c={},vertexShader:u,fragmentShader:d}=e;Lr("string"===typeof t),this.name=t,this.vs=n||u,this.fs=i||d,this.getModuleUniforms=s,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(e){const t={vs:{},fs:{}};for(const n in e){let i=e[n];"string"===typeof i&&(i={order:0,injection:i}),t[n.slice(0,2)][n]=i}return t}(c),o&&(this.uniforms=function(e){const t={};for(const n in e){const i=Rr(e[n]);t[n]=i}return t}(o))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:Lr(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(t,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach((n=>{n.regex.test(e)&&(n.deprecated?t.deprecated(n.old,n.new)():t.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(e){return e.forEach((e=>{if("function"===e.type)e.regex=new RegExp("\\b".concat(e.old,"\\("));else e.regex=new RegExp("".concat(e.type," ").concat(e.old,";"))})),e}_defaultGetUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},n=this.uniforms;for(const i in n){const r=n[i];i in e&&!r.private?(r.validate&&Lr(r.validate(e[i],r),"".concat(this.name,": invalid ").concat(i)),t[i]=e[i]):t[i]=r.value}return t}}function Fr(e){return Dr(Nr(e))}function Dr(e){const t={},n={};return jr({modules:e,level:0,moduleMap:t,moduleDepth:n}),Object.keys(n).sort(((e,t)=>n[t]-n[e])).map((e=>t[e]))}function jr(e){let{modules:t,level:n,moduleMap:i,moduleDepth:r}=e;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const o of t)i[o.name]=o,(void 0===r[o.name]||r[o.name]<n)&&(r[o.name]=n);for(const o of t)o.dependencies&&jr({modules:o.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function Nr(e,t){return e.map((e=>(e instanceof zr||(Lr("string"!==typeof e,"Shader module use by name is deprecated. Import shader module '".concat(e,"' and use it directly.")),Lr(e.name,"shader module has no name"),(e=new zr(e)).dependencies=Nr(e.dependencies)),e)))}const Br=7936,Ur=7937,Vr=7938,Wr=35724,Gr={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Hr={};Object.keys(Gr).forEach((e=>{Hr[e]=e}));const qr={};function Xr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=Gr[t];if(Lr(i,t),!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t="undefined"!==typeof window&&window.navigator||{},n=e.userAgent||t.userAgent||"",i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r}(n))return!0;if(t in qr)return qr[t];const r=i[0],o=n.behavior||"enable",s="#extension GL_".concat(r," : ").concat(o,"\nvoid main(void) {}"),a=e.createShader(35633);e.shaderSource(a,s),e.compileShader(a);const l=e.getShaderParameter(a,35713);return e.deleteShader(a),qr[t]=l,l}function Zr(e,t){const n=Gr[t];Lr(n,t);const i=function(e){return"undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}(e)&&n[1]||n[0],r="string"===typeof i?Boolean(e.getExtension(i)):i;return Lr(!1===r||!0===r),r}function Yr(e,t){return(t=Array.isArray(t)?t:[t]).every((t=>Zr(e,t)))}function Kr(e){const t=function(e){const t=e.getExtension("WEBGL_debug_renderer_info"),n=e.getParameter(t&&t.UNMASKED_VENDOR_WEBGL||Br),i=e.getParameter(t&&t.UNMASKED_RENDERER_WEBGL||Ur);return{gpuVendor:function(e,t){return e.match(/NVIDIA/i)||t.match(/NVIDIA/i)?"NVIDIA":e.match(/INTEL/i)||t.match(/INTEL/i)?"INTEL":e.match(/AMD/i)||t.match(/AMD/i)||e.match(/ATI/i)||t.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,i),vendor:n,renderer:i,version:e.getParameter(Vr),shadingLanguageVersion:e.getParameter(Wr)}}(e);switch(t.gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}const Qr={[kr]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[Mr]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},$r="__LUMA_INJECT_DECLARATIONS__",Jr=/void\s+main\s*\([^)]*\)\s*\{\n?/,eo=/}\n?[^{}]*$/,to=[];function no(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=t===kr;for(const o in n){const t=n[o];t.sort(((e,t)=>e.order-t.order)),to.length=t.length;for(let e=0,n=t.length;e<n;++e)to[e]=t[e].injection;const i="".concat(to.join("\n"),"\n");switch(o){case"vs:#decl":r&&(e=e.replace($r,i));break;case"vs:#main-start":r&&(e=e.replace(Jr,(e=>e+i)));break;case"vs:#main-end":r&&(e=e.replace(eo,(e=>i+e)));break;case"fs:#decl":r||(e=e.replace($r,i));break;case"fs:#main-start":r||(e=e.replace(Jr,(e=>e+i)));break;case"fs:#main-end":r||(e=e.replace(eo,(e=>i+e)));break;default:e=e.replace(o,(e=>e+i))}}return e=e.replace($r,""),i&&(e=e.replace(/\}\s*$/,(e=>e+Qr[t]))),e}function io(e){const t={};return Lr(Array.isArray(e)&&e.length>1),e.forEach((e=>{for(const n in e)t[n]=t[n]?"".concat(t[n],"\n").concat(e[n]):e[n]})),t}function ro(e){return new RegExp("\\b".concat(e,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const oo=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],so=[...oo,[ro("attribute"),"in $1"],[ro("varying"),"out $1"]],ao=[...oo,[ro("varying"),"in $1"]],lo=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],co=[...lo,[ro("in"),"attribute $1"],[ro("out"),"varying $1"]],uo=[...lo,[ro("in"),"varying $1"]],ho="gl_FragColor",fo=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,po=/void\s+main\s*\([^)]*\)\s*\{\n?/;function go(e,t,n){switch(t){case 300:return n?mo(e,so):function(e){e=mo(e,ao);const t=e.match(fo);if(t){const n=t[1];e=e.replace(new RegExp("\\b".concat(ho,"\\b"),"g"),n)}else{const t="fragmentColor";e=e.replace(po,(e=>"out vec4 ".concat(t,";\n").concat(e))).replace(new RegExp("\\b".concat(ho,"\\b"),"g"),t)}return e}(e);case 100:return n?mo(e,co):function(e){e=mo(e,uo);const t=e.match(fo);if(t){const n=t[1];e=e.replace(fo,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),ho)}return e}(e);default:throw new Error("unknown GLSL version ".concat(t))}}function mo(e,t){for(const[n,i]of t)e=e.replace(n,i);return e}const vo="\n\n".concat($r,"\n\n"),yo={[kr]:"vertex",[Mr]:"fragment"},bo="precision highp float;\n\n";function _o(e,t){let{id:n,source:i,type:r,modules:o,defines:s={},hookFunctions:a=[],inject:l={},transpileToGLSL100:c=!1,prologue:u=!0,log:d}=t;Lr("string"===typeof i,"shader source must be a string");const h=r===kr,f=i.split("\n");let p=100,g="",m=i;0===f[0].indexOf("#version ")?(p=300,g=f[0],m=f.slice(1).join("\n")):g="#version ".concat(p);const v={};o.forEach((e=>{Object.assign(v,e.getDefines())})),Object.assign(v,s);let y=u?"".concat(g,"\n").concat(function(e){let{id:t,source:n,type:i}=e;const r=t&&"string"===typeof t&&-1===n.indexOf("SHADER_NAME");return r?"\n#define SHADER_NAME ".concat(t,"_").concat(yo[i],"\n\n"):""}({id:n,source:i,type:r}),"\n").concat(function(e){let{type:t}=e;return"\n#define SHADER_TYPE_".concat(yo[t].toUpperCase(),"\n")}({type:r}),"\n").concat(Kr(e),"\n").concat(function(e,t,n){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return Yr(e,Hr.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),Yr(e,Hr.GLSL_DERIVATIVES)&&Xr(e,Hr.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),Yr(e,Hr.GLSL_FRAG_DATA)&&Xr(e,Hr.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),Yr(e,Hr.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(e),"\n").concat(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=0,n="";for(const i in e){0===t&&(n+="\n// APPLICATION DEFINES\n"),t++;const r=e[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(e[i],"\n"))}0===t&&(n+="\n");return n}(v),"\n").concat(h?"":bo,"\n"):"".concat(g,"\n");const b=function(e){const t={vs:{},fs:{}};return e.forEach((e=>{let n;"string"!==typeof e?(n=e,e=n.hook):n={},e=e.trim();const[i,r]=e.split(":"),o=e.replace(/\(.+/,"");t[i][o]=Object.assign(n,{signature:r})})),t}(a),_={},w={},x={};for(const P in l){const e="string"===typeof l[P]?{injection:l[P],order:0}:l[P],t=P.match(/^(v|f)s:(#)?([\w-]+)$/);if(t){const n=t[2],i=t[3];n?"decl"===i?w[P]=[e]:x[P]=[e]:_[P]=[e]}else x[P]=[e]}for(const P of o){d&&P.checkDeprecations(m,d);y+=P.getModuleSource(r,p);const e=P.injections[r];for(const t in e){const n=t.match(/^(v|f)s:#([\w-]+)$/);if(n){const i="decl"===n[2]?w:x;i[t]=i[t]||[],i[t].push(e[t])}else _[t]=_[t]||[],_[t].push(e[t])}}return y+=vo,y=no(y,r,w),y+=function(e,t){let n="";for(const i in e){const r=e[i];if(n+="void ".concat(r.signature," {\n"),r.header&&(n+="  ".concat(r.header)),t[i]){const e=t[i];e.sort(((e,t)=>e.order-t.order));for(const t of e)n+="  ".concat(t.injection,"\n")}r.footer&&(n+="  ".concat(r.footer)),n+="}\n"}return n}(b[r],_),y+=m,y=no(y,r,x),y=go(y,c?100:p,h),y}function wo(e){return function(t){const n={};for(const i of e){const e=i.getUniforms(t,n);Object.assign(n,e)}return n}}const xo=new $({id:"luma.gl"});function Po(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}const So="Invalid WebGLRenderingContext",Eo="Requires WebGL2";function To(e){return"undefined"!==typeof WebGLRenderingContext&&e instanceof WebGLRenderingContext||("undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&Number.isFinite(e._version)))}function Co(e){return"undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}function Ao(e){return Po(To(e),So),e}function ko(e){return Po(Co(e),Eo),e}const Mo={};function Lo(e,t){var n;Mo[e]=!0,void 0!==t&&(n=t,globalThis.console&&globalThis.console.error&&globalThis.console.error(n))}const Oo=function e(t){const n=t.gl;this.ext=t,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(t.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const t=new e.VertexAttrib(n);this.attribs[i]=t}this.maxAttrib=0};(Oo.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Ro=function(e){const t=this;this.gl=e,function(e){const t=e.getError;e.getError=function(){let n;do{n=t.apply(e),0!==n&&(Mo[n]=!0)}while(0!==n);for(n in Mo)if(Mo[n])return delete Mo[n],parseInt(n,10);return 0}}(e);const n=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(e){return e===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:n.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(e){const i=t.currentVertexArrayObject;i.maxAttrib=Math.max(i.maxAttrib,e);return i.attribs[e].enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(e){const i=t.currentVertexArrayObject;i.maxAttrib=Math.max(i.maxAttrib,e);return i.attribs[e].enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(e,i){switch(e){case 34962:t.currentArrayBuffer=i;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=i}return n.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(e,i){const r=t.currentVertexArrayObject.attribs[e];switch(i){case 34975:return r.buffer;case 34338:return r.enabled;case 34339:return r.size;case 34340:return r.stride;case 34341:return r.type;case 34922:return r.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(e,i,r,o,s,a){const l=t.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,e);const c=l.attribs[e];return c.buffer=t.currentArrayBuffer,c.size=i,c.type=r,c.normalized=o,c.stride=s,c.offset=a,c.recache(),n.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",(()=>{var e;e="OESVertexArrayObject emulation library context restored",globalThis.console&&globalThis.console.log&&globalThis.console.log(e),t.reset_()}),!0),this.reset_()};Ro.prototype.VERTEX_ARRAY_BINDING_OES=34229,Ro.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;const e=this.gl;this.maxVertexAttribs=e.getParameter(34921),this.defaultVertexArrayObject=new Oo(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Ro.prototype.createVertexArrayOES=function(){const e=new Oo(this);return this.vertexArrayObjects.push(e),e},Ro.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},Ro.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Oo&&e.hasBeenBound&&e.ext===this)},Ro.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void Lo(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const n=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const r=this.currentVertexArrayObject;if(i===r)return;i&&r.elementArrayBuffer===i.elementArrayBuffer||n.bindBuffer.call(t,34963,r.elementArrayBuffer);let o=this.currentArrayBuffer;const s=Math.max(i?i.maxAttrib:0,r.maxAttrib);for(let a=0;a<=s;a++){const e=r.attribs[a],s=i?i.attribs[a]:null;if(i&&e.enabled===s.enabled||(e.enabled?n.enableVertexAttribArray.call(t,a):n.disableVertexAttribArray.call(t,a)),e.enabled){let r=!1;i&&e.buffer===s.buffer||(o!==e.buffer&&(n.bindBuffer.call(t,34962,e.buffer),o=e.buffer),r=!0),(r||e.cached!==s.cached)&&n.vertexAttribPointer.call(t,a,e.size,e.type,e.normalized,e.stride,e.offset)}}this.currentArrayBuffer!==o&&n.bindBuffer.call(t,34962,this.currentArrayBuffer)};const Io="OES_element_index",zo="WEBGL_draw_buffers",Fo="WEBGL_debug_renderer_info",Do=e=>Co(e)?void 0:0,jo={3074:e=>Co(e)?void 0:36064,35723:e=>Co(e)?void 0:4352,35977:Do,32937:Do,36795:(e,t)=>{const n=Co(e)?e.getExtension("EXT_disjoint_timer_query_webgl2"):e.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?t(n.GPU_DISJOINT_EXT):0},37445:(e,t)=>{const n=e.getExtension(Fo);return t(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(e,t)=>{const n=e.getExtension(Fo);return t(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(e,t)=>{const n=e.luma.extensions.EXT_texture_filter_anisotropic;return n?t(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Do,35071:Do,37447:Do,36063:(e,t)=>{if(!Co(e)){const n=e.getExtension(zo);return n?t(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Do,35374:Do,35377:Do,34852:e=>{if(!Co(e)){const t=e.getExtension(zo);return t?t.MAX_DRAW_BUFFERS_WEBGL:0}},36203:e=>e.getExtension(Io)?2147483647:65535,33001:e=>e.getExtension(Io)?16777216:65535,33e3:e=>16777216,37157:Do,35373:Do,35657:Do,36183:Do,37137:Do,34045:Do,35978:Do,35979:Do,35968:Do,35376:Do,35375:Do,35659:Do,37154:Do,35371:Do,35658:Do,35076:Do,35077:Do,35380:Do};const No="ANGLE_instanced_arrays";const Bo={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{Po(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[No]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(e,t){Po(0===t,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Po(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{Po(!1)},deleteQuery:()=>{Po(!1)},beginQuery:()=>{Po(!1)},endQuery:()=>{},getQuery(e,t){return this.getQueryObject(e,t)},getQueryParameter(e,t){return this.getQueryObject(e,t)},getQueryObject:()=>{}}},Uo={readBuffer:(e,t,n)=>{Co(e)&&t(n)},getVertexAttrib:(e,t,n,i)=>{const{webgl2:r,ext:o}=function(e,t){return{webgl2:Co(e),ext:e.getExtension(t)}}(e,No);let s;switch(i){case 35069:s=!!r&&void 0;break;case 35070:s=r||o?void 0:0}return void 0!==s?s:t(n,i)},getProgramParameter:(e,t,n,i)=>{if(!Co(e))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return t(n,i)},getInternalformatParameter:(e,t,n,i,r)=>Co(e)||32937!==r?e.getInternalformatParameter(n,i,r):new Int32Array([0]),getTexParameter(e,t,n,i){if(34046===i){const{extensions:t}=e.luma,n=t.EXT_texture_filter_anisotropic;i=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return t(n,i)},getParameter:function(e,t,n){const i=jo[n],r="function"===typeof i?i(e,t,n):i;return void 0!==r?r:t(n)},hint:(e,t,n,i)=>t(n,i)};function Vo(e,t){let{extension:n,target:i,target2:r}=t;const o=Bo[n];Po(o);const{meta:s={}}=o,{suffix:a=""}=s,l=e.getExtension(n);for(const c of Object.keys(o)){const t="".concat(c).concat(a);let n=null;"meta"===c||"function"===typeof e[c]||(l&&"function"===typeof l[t]?n=function(){return l[t](...arguments)}:"function"===typeof o[c]&&(n=o[c].bind(i))),n&&(i[c]=n,r[c]=n)}}globalThis.polyfillContext=function(e){e.luma=e.luma||{};const{luma:t}=e;return t.polyfilled||(!function(e){if("function"===typeof e.createVertexArray)return;const t=e.getSupportedExtensions;e.getSupportedExtensions=function(){const e=t.call(this)||[];return e.indexOf("OES_vertex_array_object")<0&&e.push("OES_vertex_array_object"),e};const n=e.getExtension;e.getExtension=function(t){return n.call(this,t)||("OES_vertex_array_object"!==t?null:(e.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Ro(this)),this.__OESVertexArrayObject))}}(e),function(e){e.luma.extensions={};const t=e.getSupportedExtensions()||[];for(const n of t)e.luma[n]=e.getExtension(n)}(e),function(e,t){for(const n of Object.getOwnPropertyNames(t))"overrides"!==n&&Vo(e,{extension:n,target:e.luma,target2:e})}(e,Bo),function(e,t){let{target:n,target2:i}=t;Object.keys(Uo).forEach((t=>{if("function"===typeof Uo[t]){const r=e[t]?e[t].bind(e):()=>{},o=Uo[t].bind(null,e,r);n[t]=o,i[t]=o}}))}(e,{target:t,target2:e}),t.polyfilled=!0),e};const Wo={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Go=(e,t,n)=>t?e.enable(n):e.disable(n),Ho=(e,t,n)=>e.hint(n,t),qo=(e,t,n)=>e.pixelStorei(n,t);function Xo(e){return Array.isArray(e)||ArrayBuffer.isView(e)}const Zo={3042:Go,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:Go,2885:(e,t)=>e.cullFace(t),2929:Go,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:Go,35723:Ho,36006:(e,t)=>{const n=Co(e)?36009:36160;return e.bindFramebuffer(n,t)},2886:(e,t)=>e.frontFace(t),33170:Ho,2849:(e,t)=>e.lineWidth(t),32823:Go,32824:"polygonOffset",10752:"polygonOffset",35977:Go,32938:"sampleCoverage",32939:"sampleCoverage",3089:Go,3088:(e,t)=>e.scissor(...t),2960:Go,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),3333:qo,3317:qo,37440:qo,37441:qo,37443:qo,3330:qo,3332:qo,3331:qo,36010:(e,t)=>e.bindFramebuffer(36008,t),3314:qo,32878:qo,3316:qo,3315:qo,32877:qo,framebuffer:(e,t)=>{const n=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,n)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{t=Xo(t)?t:[t,t],e.blendEquationSeparate(...t)},blendFunc:(e,t)=>{t=Xo(t)&&2===t.length?[...t,...t]:t,e.blendFuncSeparate(...t)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(...t),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=Xo(t)?t:[t,t];const[n,i]=t;e.stencilMaskSeparate(1028,n),e.stencilMaskSeparate(1029,i)},stencilFunc:(e,t)=>{t=Xo(t)&&3===t.length?[...t,...t]:t;const[n,i,r,o,s,a]=t;e.stencilFuncSeparate(1028,n,i,r),e.stencilFuncSeparate(1029,o,s,a)},stencilOp:(e,t)=>{t=Xo(t)&&3===t.length?[...t,...t]:t;const[n,i,r,o,s,a]=t;e.stencilOpSeparate(1028,n,i,r),e.stencilOpSeparate(1029,o,s,a)},viewport:(e,t)=>e.viewport(...t)};function Yo(e,t,n){return void 0!==t[e]?t[e]:n[e]}const Ko={blendEquation:(e,t,n)=>e.blendEquationSeparate(Yo(32777,t,n),Yo(34877,t,n)),blendFunc:(e,t,n)=>e.blendFuncSeparate(Yo(32969,t,n),Yo(32968,t,n),Yo(32971,t,n),Yo(32970,t,n)),polygonOffset:(e,t,n)=>e.polygonOffset(Yo(32824,t,n),Yo(10752,t,n)),sampleCoverage:(e,t,n)=>e.sampleCoverage(Yo(32938,t,n),Yo(32939,t,n)),stencilFuncFront:(e,t,n)=>e.stencilFuncSeparate(1028,Yo(2962,t,n),Yo(2967,t,n),Yo(2963,t,n)),stencilFuncBack:(e,t,n)=>e.stencilFuncSeparate(1029,Yo(34816,t,n),Yo(36003,t,n),Yo(36004,t,n)),stencilOpFront:(e,t,n)=>e.stencilOpSeparate(1028,Yo(2964,t,n),Yo(2965,t,n),Yo(2966,t,n)),stencilOpBack:(e,t,n)=>e.stencilOpSeparate(1029,Yo(34817,t,n),Yo(34818,t,n),Yo(34819,t,n))},Qo={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,n)=>e({[t]:n}),hint:(e,t,n)=>e({[t]:n}),bindFramebuffer:(e,t,n)=>{switch(t){case 36160:return e({36006:n,36010:n});case 36009:return e({36006:n});case 36008:return e({36010:n});default:return null}},blendColor:(e,t,n,i,r)=>e({32773:new Float32Array([t,n,i,r])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,n)=>e({32777:t,34877:n}),blendFunc:(e,t,n)=>e({32969:t,32968:n,32971:t,32970:n}),blendFuncSeparate:(e,t,n,i,r)=>e({32969:t,32968:n,32971:i,32970:r}),clearColor:(e,t,n,i,r)=>e({3106:new Float32Array([t,n,i,r])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,n,i,r)=>e({3107:[t,n,i,r]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,n)=>e({2928:new Float32Array([t,n])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,n)=>e({32824:t,10752:n}),sampleCoverage:(e,t,n)=>e({32938:t,32939:n}),scissor:(e,t,n,i,r)=>e({3088:new Int32Array([t,n,i,r])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,n)=>e({[1028===t?2968:36005]:n}),stencilFunc:(e,t,n,i)=>e({2962:t,2967:n,2963:i,34816:t,36003:n,36004:i}),stencilFuncSeparate:(e,t,n,i,r)=>e({[1028===t?2962:34816]:n,[1028===t?2967:36003]:i,[1028===t?2963:36004]:r}),stencilOp:(e,t,n,i)=>e({2964:t,2965:n,2966:i,34817:t,34818:n,34819:i}),stencilOpSeparate:(e,t,n,i,r)=>e({[1028===t?2964:34817]:n,[1028===t?2965:34818]:i,[1028===t?2966:34819]:r}),viewport:(e,t,n,i,r)=>e({2978:[t,n,i,r]})},$o=(e,t)=>e.isEnabled(t),Jo={3042:$o,2884:$o,2929:$o,3024:$o,32823:$o,32926:$o,32928:$o,3089:$o,2960:$o,35977:$o};function es(e){for(const t in e)return!1;return!0}function ts(e,t){if(e===t)return!0;const n=Array.isArray(e)||ArrayBuffer.isView(e),i=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&i&&e.length===t.length){for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}return!1}function ns(e,t){const n=e[t].bind(e);e[t]=function(){const t=arguments.length<=0?void 0:arguments[0];return t in e.state.cache&&e.state.enable?e.state.cache[t]:n(...arguments)},Object.defineProperty(e[t],"name",{value:"".concat(t,"-from-cache"),configurable:!1})}function is(e,t,n){const i=e[t].bind(e);e[t]=function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];const{valueChanged:s,oldValue:a}=n(e.state._updateCache,...r);return s&&i(...r),a},Object.defineProperty(e[t],"name",{value:"".concat(t,"-to-cache"),configurable:!1})}class rs{constructor(e){let{copyState:t=!1,log:n=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(e,t){if("number"===typeof(t=t||Wo)){const n=t,i=Jo[n];return i?i(e,n):e.getParameter(n)}const n=Array.isArray(t)?t:Object.keys(t),i={};for(const r of n){const t=Jo[r];i[r]=t?t(e,Number(r)):e.getParameter(Number(r))}return i}(e):Object.assign({},Wo),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Po(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];as(this.gl,e),this.stateStack.pop()}_updateCache(e){let t,n=!1;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const r in e){Po(void 0!==r);const o=e[r],s=this.cache[r];ts(o,s)||(n=!0,t=s,i&&!(r in i)&&(i[r]=s),this.cache[r]=o)}return{valueChanged:n,oldValue:t}}}function os(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:n=!0,copyState:i}=t;if(Po(void 0!==i),!e.state){const{polyfillContext:t}=globalThis;t&&t(e),e.state=new rs(e,{copyState:i}),function(e){const t=e.useProgram.bind(e);e.useProgram=function(n){e.state.program!==n&&(t(n),e.state.program=n)}}(e);for(const n in Qo){is(e,n,Qo[n])}ns(e,"getParameter"),ns(e,"isEnabled")}return e.state.enable=n,e}function ss(e){Po(e.state),e.state.pop()}function as(e,t){if(Po(To(e),"setParameters requires a WebGL context"),es(t))return;const n={};for(const r in t){const i=Number(r),o=Zo[r];o&&("string"===typeof o?n[o]=!0:o(e,t[r],i))}const i=e.state&&e.state.cache;if(i)for(const r in n){(0,Ko[r])(e,t,i)}}function ls(e,t,n){if(es(t))return n(e);const{nocatch:i=!0}=t;let r;if(function(e){e.state||os(e,{copyState:!1}),e.state.push()}(e),as(e,t),i)r=n(e),ss(e);else try{r=n(e)}finally{ss(e)}return r}function cs(e){const{luma:t}=e;if(e.canvas&&t){const n=t.canvasSizeInfo,i="clientWidth"in n?n.clientWidth:e.canvas.clientWidth;return i?e.drawingBufferWidth/i:1}return 1}function us(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(e,t,n,i,r){const o=ds(e[0],t,n);let s=hs(e[1],t,i,r),a=ds(e[0]+1,t,n);const l=a===n-1?a:a-1;let c;a=hs(e[1]+1,t,i,r),r?(a=0===a?a:a+1,c=s,s=a):c=a===i-1?a:a-1;return{x:o,y:s,width:Math.max(l-o+1,1),height:Math.max(c-s+1,1)}}(t,cs(e),e.drawingBufferWidth,e.drawingBufferHeight,n)}function ds(e,t,n){return Math.min(Math.round(e*t),n-1)}function hs(e,t,n,i){return i?Math.max(0,n-1-Math.round(e*t)):Math.min(Math.round(e*t),n-1)}const fs=F(),ps=fs&&"undefined"!==typeof document,gs={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function ms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Po(fs,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),e=Object.assign({},gs,e);const{width:t,height:n}=e;function i(t){if(e.throwOnError)throw new Error(t);return console.error(t),null}let r;e.onError=i;const{canvas:o}=e,s=function(e){let t,{canvas:n,width:i=800,height:r=600,onError:o}=e;if("string"===typeof n){ps&&"complete"===document.readyState||o("createGLContext called on canvas '".concat(n,"' before page was loaded")),t=document.getElementById(n)}else n?t=n:(t=document.createElement("canvas"),t.id="lumagl-canvas",t.style.width=Number.isFinite(i)?"".concat(i,"px"):"100%",t.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(t,document.body.firstChild));return t}({canvas:o,width:t,height:n,onError:i});return r=function(e,t){const{onError:n}=t;let i=null;const r=e=>i=e.statusMessage||i;e.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:o=!0,webgl2:s=!0}=t;let a=null;s&&(a=a||e.getContext("webgl2",t),a=a||e.getContext("experimental-webgl2",t));o&&(a=a||e.getContext("webgl",t),a=a||e.getContext("experimental-webgl",t));if(e.removeEventListener("webglcontextcreationerror",r,!1),!a)return n("Failed to create ".concat(s&&!o?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"));t.onContextLost&&e.addEventListener("webglcontextlost",t.onContextLost,!1);t.onContextRestored&&e.addEventListener("webglcontextrestored",t.onContextRestored,!1);return a}(s,e),r?(r=vs(r,e),function(e){const t=Co(e)?"WebGL2":"WebGL1",n=function(e){const t=e.getParameter(7936),n=e.getParameter(7937),i=e.getExtension("WEBGL_debug_renderer_info"),r=i&&e.getParameter(i.UNMASKED_VENDOR_WEBGL||7936),o=i&&e.getParameter(i.UNMASKED_RENDERER_WEBGL||7937);return{vendor:r||t,renderer:o||n,vendorMasked:t,rendererMasked:n,version:e.getParameter(7938),shadingLanguageVersion:e.getParameter(35724)}}(e),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=e.debug?" debug":"";xo.info(1,"".concat(t).concat(r," context ").concat(i))()}(r),r):null}function vs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||e._instrumented)return e;e._version=e._version||function(e){if("undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)return 2;return 1}(e),e.luma=e.luma||{},e.luma.canvasSizeInfo=e.luma.canvasSizeInfo||{},t=Object.assign({},gs,t);const{manageState:n,debug:i}=t;return n&&os(e,{copyState:!1,log:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return xo.log(1,...t)()}}),fs&&i&&(globalThis.makeDebugContext?(e=globalThis.makeDebugContext(e,t),xo.level=Math.max(xo.level,1)):xo.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),e._instrumented=!0,e}function ys(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.canvas){return void function(e,t,n){let i="width"in n?n.width:e.canvas.clientWidth,r="height"in n?n.height:e.canvas.clientHeight;i&&r||(xo.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,i=e.canvas.width||1,r=e.canvas.height||1);e.luma=e.luma||{},e.luma.canvasSizeInfo=e.luma.canvasSizeInfo||{};const o=e.luma.canvasSizeInfo;if(o.clientWidth!==i||o.clientHeight!==r||o.devicePixelRatio!==t){let n=t;const o=Math.floor(i*n),s=Math.floor(r*n);e.canvas.width=o,e.canvas.height=s,e.drawingBufferWidth===o&&e.drawingBufferHeight===s||(xo.warn("Device pixel ratio clamped")(),n=Math.min(e.drawingBufferWidth/i,e.drawingBufferHeight/r),e.canvas.width=Math.floor(i*n),e.canvas.height=Math.floor(r*n)),Object.assign(e.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:t})}}(e,function(e){const t="undefined"===typeof window?1:window.devicePixelRatio||1;return Number.isFinite(e)?e<=0?1:e:e?t:1}(t.useDevicePixels),t)}const n=e.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in t&&"height"in t&&n.resize(t.width,t.height)}const bs="8.5.20";const _s=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new Jn({id:e})),this.stats.get(e)}};if(globalThis.luma&&globalThis.luma.VERSION!==bs)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(bs));globalThis.luma||(F()&&xo.log(1,"luma.gl ".concat(bs," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:bs,version:bs,log:xo,stats:_s,globals:{modules:{},nodeIO:{}}});globalThis.luma;function ws(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}function xs(e,t){if("string"!==typeof t)return t;const n=Number(t);if(!isNaN(n))return n;const i=e[t=t.replace(/^.*\./,"")];return ws(void 0!==i,"Accessing undefined constant GL.".concat(t)),i}function Ps(e,t){t=Number(t);for(const n in e)if(e[n]===t)return"GL.".concat(n);return String(t)}const Ss={};function Es(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";Ss[e]=Ss[e]||1;const t=Ss[e]++;return"".concat(e,"-").concat(t)}function Ts(e){return ws("number"===typeof e,"Input must be a number"),e&&0===(e&e-1)}function Cs(e){let t=!0;for(const n in e){t=!1;break}return t}function As(e,t,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),o=Object.getPrototypeOf(e);i.forEach((e=>{o.methodName||(o[e]=()=>{throw xo.removed("Calling removed method ".concat(t,".").concat(e,": "),r)(),new Error(e)})}))}const ks="Resource subclass must define virtual methods";class Ms{get[Symbol.toStringTag](){return"Resource"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ao(e);const{id:n,userData:i={}}=t;this.gl=e,this.gl2=e,this.id=n||Es(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach((e=>e.delete())),this}bind(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!==typeof t?(this._bindHandle(t),this):(this._bound?e=t():(this._bindHandle(this.handle),this._bound=!0,e=t(),this._bound=!1,this._bindHandle(null)),e)}unbind(){this.bind(null)}getParameter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ws(e=xs(this.gl,e));const n=(this.constructor.PARAMETERS||{})[e];if(n){const e=Co(this.gl);if(!((!("webgl2"in n)||e)&&(!("extension"in n)||this.gl.getExtension(n.extension)))){const t=n.webgl1,i="webgl2"in n?n.webgl2:n.webgl1;return e?i:t}}return this._getParameter(e,t)}getParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:t,keys:n}=e,i=this.constructor.PARAMETERS||{},r=Co(this.gl),o={},s=t||Object.keys(i);for(const a of s){const t=i[a];if(t&&(!("webgl2"in t)||r)&&(!("extension"in t)||this.gl.getExtension(t.extension))){const i=n?Ps(this.gl,a):a;o[i]=this.getParameter(a,e),n&&"GLenum"===t.type&&(o[i]=Ps(this.gl,o[i]))}}return o}setParameter(e,t){ws(e=xs(this.gl,e));const n=(this.constructor.PARAMETERS||{})[e];if(n){const e=Co(this.gl);if(!((!("webgl2"in n)||e)&&(!("extension"in n)||this.gl.getExtension(n.extension))))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(t=xs(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,n){return As(this,e,t,n)}initialize(e){}_createHandle(){throw new Error(ks)}_deleteHandle(){throw new Error(ks)}_bindHandle(e){throw new Error(ks)}_getOptsFromHandle(){throw new Error(ks)}_getParameter(e,t){throw new Error(ks)}_setParameter(e,t){throw new Error(ks)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],t=_s.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get("".concat(e,"s Created")).incrementCount(),t.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];_s.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,t),this._trackAllocatedMemoryForContext(e,t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const i=_s.get("Memory Usage".concat(n));i.get("GPU Memory").addCount(e),i.get("".concat(t," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=_s.get("Memory Usage".concat(t));n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(e," Memory")).subtractCount(this.byteLength)}}const Ls="Failed to deduce GL constant from typed array";function Os(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(Ls)}}function Rs(e){let{clamped:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return t?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Is(e){let{data:t,width:n,height:i}=e;const r=Math.round(n/2),o=Math.round(i/2),s=new Uint8Array(r*o*4);for(let a=0;a<o;a++)for(let e=0;e<r;e++)for(let i=0;i<4;i++)s[4*(a*r+e)+i]=t[4*(2*a*n+2*e)+i];return{data:s,width:r,height:o}}function zs(e,t,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:o={}}=n;for(const a in i)if(a in t){const t=i[a]?"".concat(e,".").concat(i[a]):"N/A";xo.removed("".concat(e,".").concat(a),t)()}for(const a in r)if(a in t){const t=r[a];xo.deprecated("".concat(e,".").concat(a),"".concat(e,".").concat(t))()}let s=null;for(const a in o)if(a in t){const n=o[a];xo.deprecated("".concat(e,".").concat(a),"".concat(e,".").concat(n))(),s=s||Object.assign({},t),s[n]=t[a],delete s[a]}return s||t}const Fs={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Ds={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class js{static getBytesPerElement(e){return Rs(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){ws(e.size);return Rs(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new js(...[Fs,...t])}constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>this._assign(e))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return js.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return js.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=zs("Accessor",e,Ds),void 0!==e.type&&(this.type=e.type,5124!==e.type&&5125!==e.type||(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&("boolean"===typeof e.index?this.index=e.index?1:0:this.index=e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const Ns={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Bs={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:Ns},Us={removedProps:Ns};class Vs extends Ms{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/js.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/js.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=zs("Buffer",e,Bs),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=zs("Buffer",e,Us))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new js(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:n=0,srcOffset:i=0}=e,r=e.byteLength||e.length;ws(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==i||void 0!==r?(ko(this.gl),this.gl.bufferSubData(this.target,n,t,i,r)):this.gl.bufferSubData(o,n,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData(e){let{sourceBuffer:t,readOffset:n=0,writeOffset:i=0,size:r}=e;const{gl:o}=this;return ko(o),o.bindBuffer(36662,t.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,n,i,r),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:t=0,dstOffset:n=0,length:i=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ko(this.gl);const r=Rs(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),s=n;let a,l;e?(l=e.length,a=l-s):(a=Math.min(o,i||o),l=s+a);const c=Math.min(o,a);return i=i||c,ws(i<=c),e=e||new r(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,n,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:n=0,size:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?void 0!==i?this.gl.bindBufferRange(e,t,this.handle,n,i):(ws(0===n),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength+t;ws(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.usage),this.gl.bufferSubData(i,t,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const r=Os(e);return ws(r),this.setAccessor(new js(this.accessor,{type:r})),this}_setByteLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;ws(e>=0),this._trackDeallocatedMemory();let n=e;0===e&&(n=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,t),this.gl.bindBuffer(i,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const t=e/Rs(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-t}_inferType(e){this.accessor.type||this.setAccessor(new js(this.accessor,{type:Os(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return xo.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return xo.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return xo.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return xo.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new js(this.accessor,e),this}}const Ws={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},Gs={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},Hs={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};const qs=[9729,9728],Xs=globalThis.WebGLBuffer||function(){};class Zs extends Ms{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:n,linearFiltering:i}=t;let r=!0;return n&&(r=r&&function(e,t){const n=Ws[t];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const i=Co(e)&&n.gl2||n.gl1;return"string"===typeof i?e.getExtension(i):i}(e,n),r=r&&(!i||function(e,t){const n=Ws[t];switch(n&&n.types[0]){case 5126:return e.getExtension("OES_texture_float_linear");case 5131:return e.getExtension("OES_texture_half_float_linear");default:return!0}}(e,n))),r}constructor(e,t){const{id:n=Es("texture"),handle:i,target:r}=t;super(e,{id:n,handle:i}),this.target=r,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data;if(t instanceof Promise)return t.then((t=>this.initialize(Object.assign({},e,{pixels:t,data:t})))),this;const n="undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(n&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",(()=>this.initialize(e))),this;const{pixels:i=null,format:r=6408,border:o=0,recreate:s=!1,parameters:a={},pixelStore:l={},textureUnit:c}=e;t||(t=i);let{width:u,height:d,dataFormat:h,type:f,compressed:p=!1,mipmaps:g=!0}=e;const{depth:m=0}=e;return({width:u,height:d,compressed:p,dataFormat:h,type:f}=this._deduceParameters({format:r,type:f,dataFormat:h,compressed:p,data:t,width:u,height:d})),this.width=u,this.height=d,this.depth=m,this.format=r,this.type=f,this.dataFormat=h,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),g&&this._isNPOT()&&(xo.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),g=!1,this._updateForNPOT(a)),this.mipmaps=g,this.setImageData({data:t,width:u,height:d,depth:m,format:r,type:f,dataFormat:h,border:o,mipmaps:g,parameters:l,compressed:p}),g&&this.generateMipmap(),this.setParameters(a),s&&(this.data=t),n&&(this._video={video:t,parameters:a,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:n}=this._video;if(n===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:t,width:n,mipmaps:i=!1}=e;return n!==this.width||t!==this.height?this.initialize({width:n,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(xo.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),ls(this.gl,e,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:n=null,level:i=0,format:r=this.format,border:o=this.border,offset:s=0,parameters:a={}}=e;let{data:l=null,type:c=this.type,width:u=this.width,height:d=this.height,dataFormat:h=this.dataFormat,compressed:f=!1}=e;l||(l=n),({type:c,dataFormat:h,compressed:f,width:u,height:d}=this._deduceParameters({format:r,type:c,dataFormat:h,compressed:f,data:l,width:u,height:d}));const{gl:p}=this;p.bindTexture(this.target,this.handle);let g,m=null;({data:l,dataType:m}=this._getDataType({data:l,compressed:f}));let v=0;if(ls(this.gl,a,(()=>{switch(m){case"null":p.texImage2D(t,i,r,u,d,o,h,c,l);break;case"typed-array":p.texImage2D(t,i,r,u,d,o,h,c,l,s);break;case"buffer":g=ko(p),g.bindBuffer(35052,l.handle||l),g.texImage2D(t,i,r,u,d,o,h,c,s),g.bindBuffer(35052,null);break;case"browser-object":Co(p)?p.texImage2D(t,i,r,u,d,o,h,c,l):p.texImage2D(t,i,r,h,c,l);break;case"compressed":for(const[e,n]of l.entries())p.compressedTexImage2D(t,e,n.format,n.width,n.height,o,n.data),v+=n.levelSize;break;default:ws(!1,"Unknown image data type")}})),"compressed"===m)this._trackAllocatedMemory(v,"Texture");else if(l&&l.byteLength)this._trackAllocatedMemory(l.byteLength,"Texture");else{const e=Gs[this.dataFormat]||4,t=Hs[this.type]||1;this._trackAllocatedMemory(this.width*this.height*e*t,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:t=this.target,pixels:n=null,data:i=null,x:r=0,y:o=0,width:s=this.width,height:a=this.height,level:l=0,format:c=this.format,type:u=this.type,dataFormat:d=this.dataFormat,compressed:h=!1,offset:f=0,border:p=this.border,parameters:g={}}=e;if(({type:u,dataFormat:d,compressed:h,width:s,height:a}=this._deduceParameters({format:c,type:u,dataFormat:d,compressed:h,data:i,width:s,height:a})),ws(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=n),i&&i.data){const e=i;i=e.data,s=e.shape[0],a=e.shape[1]}i instanceof Vs&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),ls(this.gl,g,(()=>{if(h)this.gl.compressedTexSubImage2D(t,l,r,o,s,a,c,i);else if(null===i)this.gl.texSubImage2D(t,l,r,o,s,a,d,u,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(t,l,r,o,s,a,d,u,i,f);else if(i instanceof Xs){const e=ko(this.gl);e.bindBuffer(35052,i),e.texSubImage2D(t,l,r,o,s,a,d,u,f),e.bindBuffer(35052,null)}else if(Co(this.gl)){ko(this.gl).texSubImage2D(t,l,r,o,s,a,d,u,i)}else this.gl.texSubImage2D(t,l,r,o,d,u,i)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return xo.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType(e){let{data:t,compressed:n=!1}=e;return n?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof Vs?{data:t.handle,dataType:"buffer"}:t instanceof Xs?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:n}=e;let{width:i,height:r,dataFormat:o,type:s,compressed:a}=e;const l=Ws[t];return o=o||l&&l.dataFormat,s=s||l&&l.types[0],a=a||l&&l.compressed,({width:i,height:r}=this._deduceImageSize(n,i,r)),{dataFormat:o,type:s,compressed:a,width:i,height:r,format:t,data:n}}_deduceImageSize(e,t,n){let i;return i="undefined"!==typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:n}:{width:t>=0?t:1,height:n>=0?n:1},ws(i,"Could not deduced texture size"),ws(void 0===t||i.width===t,"Deduced texture width does not match supplied width"),ws(void 0===n||i.height===n,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:ws(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!Co(this.gl)&&(!(!this.width||!this.height)&&(!Ts(this.width)||!Ts(this.height)))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===qs.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}let Ys="";class Ks extends Zs{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,t){return Zs.isSupported(e,t)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,i;Ao(e),(t instanceof Promise||"string"===typeof t)&&(t={data:t}),"string"===typeof t.data&&(t=Object.assign({},t,{data:(n=t.data,ws("string"===typeof n),n=Ys+n,new Promise(((e,t)=>{try{const r=new Image;r.onload=()=>e(r),r.onerror=()=>t(new Error("Could not load image ".concat(n,"."))),r.crossOrigin=i&&i.crossOrigin||"anonymous",r.src=n}catch(r){t(r)}})))})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const Qs="EXT_color_buffer_float",$s={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Qs,bpp:2},33327:{gl2:Qs,bpp:4},34842:{gl2:Qs,bpp:8},33326:{gl2:Qs,bpp:4},33328:{gl2:Qs,bpp:8},34836:{gl2:Qs,bpp:16},35898:{gl2:Qs,bpp:4}};class Js extends Ms{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!t||function(e,t,n){const i=n[t];if(!i)return!1;const r=Co(e)&&i.gl2||i.gl1;return"string"===typeof r?e.getExtension(r):r}(e,t,$s)}static getSamplesForFormat(e,t){let{format:n}=t;return e.getInternalformatParameter(36161,n,32937)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.initialize(t),Object.seal(this)}initialize(e){let{format:t,width:n=1,height:i=1,samples:r=0}=e;return ws(t,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&Co(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,t,n,i):this.gl.renderbufferStorage(36161,t,n,i),this.format=t,this.width=n,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*$s[this.format].bpp),this}resize(e){let{width:t,height:n}=e;return t!==this.width||n!==this.height?this.initialize({width:t,height:n,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){this.gl.bindRenderbuffer(36161,this.handle);return this.gl.getRenderbufferParameter(36161,e)}}const ea=6144,ta="clear: bad arguments";function na(e){let{framebuffer:t=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o={};t&&(o.framebuffer=t);let s=0;n&&(s|=16384,!0!==n&&(o.clearColor=n)),i&&(s|=256,!0!==i&&(o.clearDepth=i)),r&&(s|=1024,!0!==i&&(o.clearStencil=i)),ws(0!==s,ta),ls(e,o,(()=>{e.clear(s)}))}const ia=[34069,34070,34071,34072,34073,34074];class ra extends Zs{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ao(e),super(e,Object.assign({},t,{target:34067})),this.initialize(t),Object.seal(this)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:t=!0,parameters:n={}}=e;return this.opts=e,this.setCubeMapImageData(e).then((()=>{this.loaded=!0,t&&this.generateMipmap(e),this.setParameters(n)})),this}subImage(e){let{face:t,data:n,x:i=0,y:r=0,mipmapLevel:o=0}=e;return this._subImage({target:t,data:n,x:i,y:r,mipmapLevel:o})}async setCubeMapImageData(e){let{width:t,height:n,pixels:i,data:r,border:o=0,format:s=6408,type:a=5121}=e;const{gl:l}=this,c=i||r,u=await Promise.all(ia.map((e=>{const t=c[e];return Promise.all(Array.isArray(t)?t:[t])})));this.bind(),ia.forEach(((e,i)=>{u[i].length>1&&!1!==this.opts.mipmaps&&xo.warn("".concat(this.id," has mipmap and multiple LODs."))(),u[i].forEach(((i,r)=>{t&&n?l.texImage2D(e,r,s,t,n,o,s,a,i):l.texImage2D(e,r,s,s,a,i)}))})),this.unbind()}setImageDataForFace(e){const{face:t,width:n,height:i,pixels:r,data:o,border:s=0,format:a=6408,type:l=5121}=e,{gl:c}=this,u=r||o;return this.bind(),u instanceof Promise?u.then((n=>this.setImageDataForFace(Object.assign({},e,{face:t,data:n,pixels:n})))):this.width||this.height?c.texImage2D(t,0,a,n,i,s,a,l,u):c.texImage2D(t,0,a,a,l,u),this}}ra.FACES=ia;class oa extends Zs{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Co(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ko(e),t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1}),super(e,t),this.initialize(t),Object.seal(this)}setImageData(e){let{level:t=0,dataFormat:n=6408,width:i,height:r,depth:o=1,border:s=0,format:a,type:l=5121,offset:c=0,data:u,parameters:d={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),ls(this.gl,d,(()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,t,n,i,r,o,s,a,l,u),u instanceof Vs&&(this.gl.bindBuffer(35052,u.handle),this.gl.texImage3D(this.target,t,n,i,r,o,s,a,l,c))})),u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const e=Gs[this.dataFormat]||4,t=Hs[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*e*t,"Texture")}return this.loaded=!0,this}}function sa(e,t){const{gl:n,width:i,height:r,id:o}=e;return new va(n,Object.assign({},t,{id:"framebuffer-for-".concat(o),width:i,height:r,attachments:{36064:e}}))}function aa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=t;let{sourceAttachment:o=36064,target:s=null,sourceWidth:a,sourceHeight:l,sourceType:c}=t;const{framebuffer:u,deleteFramebuffer:d}=ca(e);ws(u);const{gl:h,handle:f,attachments:p}=u;a=a||u.width,l=l||u.height,36064===o&&null===f&&(o=1028),ws(p[o]),c=c||p[o].type,s=function(e,t,n,i,r){if(e)return e;const o=Rs(t=t||5121,{clamped:!1}),s=function(e){switch(e){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return ws(!1),0}}(n);return new o(i*r*s)}(s,c,r,a,l),c=c||Os(s);const g=h.bindFramebuffer(36160,f);return h.readPixels(n,i,a,l,r,c,s),h.bindFramebuffer(36160,g||null),d&&u.delete(),s}function la(e){let{sourceAttachment:t=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=aa(e,{sourceAttachment:t}),{width:r,height:o}=e;for(;o>n;)({data:i,width:r,height:o}=Is({data:i,width:r,height:o}));!function(e){let{data:t,width:n,height:i,bytesPerPixel:r=4,temp:o}=e;const s=n*r;o=o||new Uint8Array(s);for(let a=0;a<i/2;++a){const e=a*s,n=(i-a-1)*s;o.set(t.subarray(e,e+s)),t.copyWithin(e,n,n+s),t.set(o,n)}}({data:i,width:r,height:o});const s=document.createElement("canvas");s.width=r,s.height=o;const a=s.getContext("2d"),l=a.createImageData(r,o);return l.data.set(i),a.putImageData(l,0,0),s.toDataURL()}function ca(e){return e instanceof va?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:sa(e),deleteFramebuffer:!0}}const ua="TIMER_QUERY",da="ELEMENT_INDEX_UINT32";const ha={["WEBGL2"]:[!1,!0],["VERTEX_ARRAY_OBJECT"]:["OES_vertex_array_object",!0],[ua]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],["INSTANCED_RENDERING"]:["ANGLE_instanced_arrays",!0],["MULTIPLE_RENDER_TARGETS"]:["WEBGL_draw_buffers",!0],[da]:["OES_element_index_uint",!0],["BLEND_EQUATION_MINMAX"]:["EXT_blend_minmax",!0],["FLOAT_BLEND"]:["EXT_float_blend"],["COLOR_ENCODING_SRGB"]:["EXT_sRGB",!0],["TEXTURE_DEPTH"]:["WEBGL_depth_texture",!0],["TEXTURE_FLOAT"]:["OES_texture_float",!0],["TEXTURE_HALF_FLOAT"]:["OES_texture_half_float",!0],["TEXTURE_FILTER_LINEAR_FLOAT"]:["OES_texture_float_linear"],["TEXTURE_FILTER_LINEAR_HALF_FLOAT"]:["OES_texture_half_float_linear"],["TEXTURE_FILTER_ANISOTROPIC"]:["EXT_texture_filter_anisotropic"],["COLOR_ATTACHMENT_RGBA32F"]:[function(e){const t=new Ks(e,{format:6408,type:5126,dataFormat:6408}),n=new va(e,{id:"test-framebuffer",check:!1,attachments:{36064:t}}),i=n.getStatus();return t.delete(),n.delete(),36053===i},"EXT_color_buffer_float"],["COLOR_ATTACHMENT_FLOAT"]:[!1,"EXT_color_buffer_float"],["COLOR_ATTACHMENT_HALF_FLOAT"]:["EXT_color_buffer_half_float"],["GLSL_FRAG_DATA"]:["WEBGL_draw_buffers",!0],["GLSL_FRAG_DEPTH"]:["EXT_frag_depth",!0],["GLSL_DERIVATIVES"]:["OES_standard_derivatives",!0],["GLSL_TEXTURE_LOD"]:["EXT_shader_texture_lod",!0]},fa=2;function pa(e,t){return(t=Array.isArray(t)?t:[t]).every((t=>ga(e,t)))}function ga(e,t){return e.luma=e.luma||{},e.luma.caps=e.luma.caps||{},void 0===e.luma.caps[t]&&(e.luma.caps[t]=function(e,t){const n=ha[t];let i;ws(n,t);const r=Co(e)&&n[1]||n[0];if("function"===typeof r)i=r(e);else if(Array.isArray(r)){i=!0;for(const t of r)i=i&&Boolean(e.getExtension(t))}else"string"===typeof r?i=Boolean(e.getExtension(r)):"boolean"===typeof r?i=r:ws(!1);return i}(e,t)),e.luma.caps[t]||xo.log(fa,"Feature: ".concat(t," not supported"))(),e.luma.caps[t]}const ma="Multiple render targets not supported";class va extends Ms{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:n,colorBufferHalfFloat:i}=t;let r=!0;return n&&(r=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(r=r&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),r}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new va(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=ko(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=ko(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:t=1,height:n=1,attachments:i=null,color:r=!0,depth:o=!0,stencil:s=!1,check:a=!0,readBuffer:l,drawBuffers:c}=e;if(ws(t>=0&&n>=0,"Width and height need to be integers"),this.width=t,this.height=n,i)for(const u in i){const e=i[u];(Array.isArray(e)?e[0]:e).resize({width:t,height:n})}else i=this._createDefaultAttachments(r,o,s,t,n);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:t={},readBuffer:n,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:o=!0}=e;this.attach(t,{clearAttachments:r,resizeAttachments:o});const{gl:s}=this,a=s.bindFramebuffer(36160,this.handle);return n&&this._setReadBuffer(n),i&&this._setDrawBuffers(i),s.bindFramebuffer(36160,a||null),this}resize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:t,height:n}=e;if(null===this.handle)return ws(void 0===t&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),t!==this.width&&n!==this.height&&xo.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(t,"x").concat(n))();for(const i in this.attachments)this.attachments[i].resize({width:t,height:n});return this.width=t,this.height=n,this}attach(e){let{clearAttachments:t=!1,resizeAttachments:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i={};t&&Object.keys(this.attachments).forEach((e=>{i[e]=null})),Object.assign(i,e);const r=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){ws(void 0!==o,"Misspelled framebuffer binding point?");const e=Number(o),t=i[e];let r=t;if(r)if(r instanceof Js)this._attachRenderbuffer({attachment:e,renderbuffer:r});else if(Array.isArray(t)){const[n,i=0,o=0]=t;r=n,this._attachTexture({attachment:e,texture:n,layer:i,level:o})}else this._attachTexture({attachment:e,texture:r,layer:0,level:0});else this._unattach(e);n&&r&&r.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,r||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter((e=>!this.attachments[e])).forEach((e=>{delete this.attachments[e]}))}checkStatus(){const{gl:e}=this,t=this.getStatus();if(36053!==t)throw new Error(function(e){return(va.STATUS||{})[e]||"Framebuffer error ".concat(e)}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),n=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),n}clear(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:t,depth:n,stencil:i,drawBuffers:r=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||n||i)&&na(this.gl,{color:t,depth:n,stencil:i}),r.forEach(((e,t)=>{!function(e){let{framebuffer:t=null,buffer:n=ea,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ko(e),ls(e,{framebuffer:t},(()=>{switch(n){case ea:switch(r.constructor){case Int32Array:e.clearBufferiv(n,i,r);break;case Uint32Array:e.clearBufferuiv(n,i,r);break;case Float32Array:default:e.clearBufferfv(n,i,r)}break;case 6145:e.clearBufferfv(6145,0,[r]);break;case 6146:e.clearBufferiv(6146,0,[r]);break;case 34041:const[t,o]=r;e.clearBufferfi(34041,0,t,o);break;default:ws(!1,ta)}}))}(this.gl,{drawBuffer:t,value:e})})),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return xo.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return xo.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return xo.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return xo.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return xo.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return xo.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:t=[],x:n=0,y:i=0,width:r,height:o}=e;const s=ko(this.gl),a=s.bindFramebuffer(36008,this.handle);return 0===n&&0===i&&void 0===r&&void 0===o?s.invalidateFramebuffer(36008,t):s.invalidateFramebuffer(36008,t,n,i,r,o),s.bindFramebuffer(36008,a),this}getAttachmentParameter(e,t,n){let i=this._getAttachmentParameterFallback(t);return null===i&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),n&&i>1e3&&(i=Ps(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const r of n){i[t?Ps(this.gl,r):r]=this.getAttachmentParameter(e,r,t)}return i}getParameters(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=Object.keys(this.attachments),n={};for(const i of t){const t=Number(i);n[e?Ps(this.gl,t):t]=this.getAttachmentParameters(t,e)}return n}show(){return"undefined"!==typeof window&&window.open(la(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e>xo.level||"undefined"===typeof window)return this;t=t||"Framebuffer ".concat(this.id);const n=la(this,{targetMaxHeight:100});return xo.image({logLevel:e,message:t,image:n},t)(),this}bind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,n,i,r){let o=null;return e&&(o=o||{},o[36064]=new Ks(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:r,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&n?(o=o||{},o[33306]=new Js(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new Js(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:r}),this.ownResources.push(o[36096])):n&&ws(!1),o}_unattach(e){const t=this.attachments[e];t&&(t instanceof Js?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:t=36064,renderbuffer:n}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,t,36161,n.handle),this.attachments[t]=n}_attachTexture(e){let{attachment:t=36064,texture:n,layer:i,level:r}=e;const{gl:o}=this;switch(o.bindTexture(n.target,n.handle),n.target){case 35866:case 32879:ko(o).framebufferTextureLayer(36160,t,n.target,r,i);break;case 34067:const e=function(e){return e<34069?e+34069:e}(i);o.framebufferTexture2D(36160,t,e,n.handle,r);break;case 3553:o.framebufferTexture2D(36160,t,3553,n.handle,r);break;default:ws(!1,"Illegal texture type")}o.bindTexture(n.target,null),this.attachments[t]=n}_setReadBuffer(e){const t=Co(n=this.gl)?n:null;var n;t?t.readBuffer(e):ws(36064===e||1029===e,ma),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,n=ko(t);if(n)n.drawBuffers(e);else{const n=t.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(e):ws(1===e.length&&(36064===e[0]||1029===e[0]),ma)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(e){e.luma=e.luma||{},e.luma.caps=e.luma.caps||{};for(const t in ha)void 0===e.luma.caps[t]&&(e.luma.caps[t]=ga(e,t));return e.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}va.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const ya={5126:Oa.bind(null,"uniform1fv",Sa,1,Ra),35664:Oa.bind(null,"uniform2fv",Sa,2,Ra),35665:Oa.bind(null,"uniform3fv",Sa,3,Ra),35666:Oa.bind(null,"uniform4fv",Sa,4,Ra),5124:Oa.bind(null,"uniform1iv",Ea,1,Ra),35667:Oa.bind(null,"uniform2iv",Ea,2,Ra),35668:Oa.bind(null,"uniform3iv",Ea,3,Ra),35669:Oa.bind(null,"uniform4iv",Ea,4,Ra),35670:Oa.bind(null,"uniform1iv",Ea,1,Ra),35671:Oa.bind(null,"uniform2iv",Ea,2,Ra),35672:Oa.bind(null,"uniform3iv",Ea,3,Ra),35673:Oa.bind(null,"uniform4iv",Ea,4,Ra),35674:Oa.bind(null,"uniformMatrix2fv",Sa,4,Ia),35675:Oa.bind(null,"uniformMatrix3fv",Sa,9,Ia),35676:Oa.bind(null,"uniformMatrix4fv",Sa,16,Ia),35678:La,35680:La,5125:Oa.bind(null,"uniform1uiv",Ta,1,Ra),36294:Oa.bind(null,"uniform2uiv",Ta,2,Ra),36295:Oa.bind(null,"uniform3uiv",Ta,3,Ra),36296:Oa.bind(null,"uniform4uiv",Ta,4,Ra),35685:Oa.bind(null,"uniformMatrix2x3fv",Sa,6,Ia),35686:Oa.bind(null,"uniformMatrix2x4fv",Sa,8,Ia),35687:Oa.bind(null,"uniformMatrix3x2fv",Sa,6,Ia),35688:Oa.bind(null,"uniformMatrix3x4fv",Sa,12,Ia),35689:Oa.bind(null,"uniformMatrix4x2fv",Sa,8,Ia),35690:Oa.bind(null,"uniformMatrix4x3fv",Sa,12,Ia),35678:La,35680:La,35679:La,35682:La,36289:La,36292:La,36293:La,36298:La,36299:La,36300:La,36303:La,36306:La,36307:La,36308:La,36311:La},ba={},_a={},wa={},xa=[0];function Pa(e,t,n,i){1===t&&"boolean"===typeof e&&(e=e?1:0),Number.isFinite(e)&&(xa[0]=e,e=xa);const r=e.length;if(r%t&&xo.warn("Uniform size should be multiples of ".concat(t),e)(),e instanceof n)return e;let o=i[r];o||(o=new n(r),i[r]=o);for(let s=0;s<r;s++)o[s]=e[s];return o}function Sa(e,t){return Pa(e,t,Float32Array,ba)}function Ea(e,t){return Pa(e,t,Int32Array,_a)}function Ta(e,t){return Pa(e,t,Uint32Array,wa)}function Ca(e,t,n){const i=ya[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,e,t)}function Aa(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=e.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(e));return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function ka(e){return Array.isArray(e)||ArrayBuffer.isView(e)?function(e){if(0===e.length)return!1;const t=Math.min(e.length,16);for(let n=0;n<t;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e):!!isFinite(e)||(!0===e||!1===e||(e instanceof Zs||(e instanceof Js||e instanceof va&&Boolean(e.texture))))}function Ma(e,t,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(e[t]){const i=e[t];for(let e=0,t=n.length;e<t;++e)i[e]=n[e]}else e[t]=n.slice();else e[t]=n}function La(){let e=null;return(t,n,i)=>{const r=e!==i;return r&&(t.uniform1i(n,i),e=i),r}}function Oa(e,t,n,i){let r=null,o=null;return(s,a,l)=>{const c=t(l,n),u=c.length;let d=!1;if(null===r)r=new Float32Array(u),o=u,d=!0;else{ws(o===u,"Uniform length cannot change.");for(let e=0;e<u;++e)if(c[e]!==r[e]){d=!0;break}}return d&&(i(s,e,a,c),r.set(c)),d}}function Ra(e,t,n,i){e[t](n,i)}function Ia(e,t,n,i){e[t](n,!1,i)}function za(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=e.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:t}const Fa=35632,Da=35633;function ja(e,t,n,i){const r=e.split(/\r?\n/),o={},s={},a=i||za(t)||"(unnamed)",l="".concat(function(e){switch(e){case Fa:return"fragment";case Da:return"vertex";default:return"unknown type"}}(n)," shader ").concat(a);for(let u=0;u<r.length;u++){const t=r[u];if(t.length<=1)continue;const n=t.split(":"),i=n[0],a=parseInt(n[2],10);if(isNaN(a))throw new Error("GLSL compilation error in ".concat(l,": ").concat(e));"WARNING"!==i?o[a]=t:s[a]=t}const c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const i=e.split(/\r?\n/),r=String(i.length+t-1).length;return i.map(((e,i)=>{const o=String(i+t),s=o.length;return Ba(o,r-s)+n+e}))}(t);return{shaderName:l,errors:Na(o,c),warnings:Na(s,c)}}function Na(e,t){let n="";for(let i=0;i<t.length;i++){const r=t[i];if((e[i+3]||e[i+2]||e[i+1])&&(n+="".concat(r,"\n"),e[i+1])){const t=e[i+1],r=t.split(":",3),o=r[0],s=parseInt(r[1],10)||0,a=t.substring(r.join(":").length+1).trim();n+=Ba("^^^ ".concat(o,": ").concat(a,"\n\n"),s)}}return n}function Ba(e,t){let n="";for(let i=0;i<t;++i)n+=" ";return"".concat(n).concat(e)}class Ua extends Ms{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return ws(!1),"unknown"}}constructor(e,t){Ao(e),ws("string"===typeof t.source,"Shader: GLSL source code must be a JavaScript string");super(e,{id:za(t.source,null)||t.id||Es("unnamed ".concat(Ua.getTypeName(t.shaderType)))}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize(e){let{source:t}=e;const n=za(t,null);n&&(this.id=Es(n)),this._compile(t)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Ua.getTypeName(this.shaderType),":").concat(this.id)}getName(){return za(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;e.startsWith("#version ")||(e="#version 100\n".concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle);if(!this.getParameter(35713)){const e=this.gl.getShaderInfoLog(this.handle),{shaderName:t,errors:n,warnings:i}=ja(e,this.source,this.shaderType,this.id);throw xo.error("GLSL compilation errors in ".concat(t,"\n").concat(n))(),xo.warn("GLSL compilation warnings in ".concat(t,"\n").concat(i))(),new Error("GLSL compilation errors in ".concat(t))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Va extends Ua{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,t){"string"===typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Wa extends Ua{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,t){"string"===typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Ga=5120,Ha=5121,qa=5122,Xa=5123,Za=0,Ya=1,Ka=2,Qa=3,$a=4,Ja=5,el=6,tl=5126,nl=5124,il=5125,rl={[tl]:[tl,1,"float"],35664:[tl,2,"vec2"],35665:[tl,3,"vec3"],35666:[tl,4,"vec4"],[nl]:[nl,1,"int"],35667:[nl,2,"ivec2"],35668:[nl,3,"ivec3"],35669:[nl,4,"ivec4"],[il]:[il,1,"uint"],36294:[il,2,"uvec2"],36295:[il,3,"uvec3"],36296:[il,4,"uvec4"],35670:[tl,1,"bool"],35671:[tl,2,"bvec2"],35672:[tl,3,"bvec3"],35673:[tl,4,"bvec4"],35674:[tl,8,"mat2"],35685:[tl,8,"mat2x3"],35686:[tl,8,"mat2x4"],35675:[tl,12,"mat3"],35687:[tl,12,"mat3x2"],35688:[tl,12,"mat3x4"],35676:[tl,16,"mat4"],35689:[tl,16,"mat4x2"],35690:[tl,16,"mat4x3"]};function ol(e){switch(e){case Za:return Za;case Ya:case Qa:case Ka:return Ya;case $a:case Ja:case el:return $a;default:return ws(!1),0}}function sl(e){const t=rl[e];if(!t)return null;const[n,i]=t;return{type:n,components:i}}function al(e,t){switch(e){case Ga:case Ha:case qa:case Xa:e=tl}for(const n in rl){const[i,r,o]=rl[n];if(i===e&&r===t)return{glType:n,name:o}}return null}class ll{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,n=t.getProgramParameter(e.handle,35721);for(let i=0;i<n;i++){const{name:n,type:r,size:o}=t.getActiveAttrib(e.handle,i),s=t.getAttribLocation(e.handle,n);s>=0&&this._addAttribute(s,n,r,o)}this.attributeInfos.sort(((e,t)=>e.location-t.location))}_readVaryingsFromProgram(e){const{gl:t}=e;if(!Co(t))return;const n=t.getProgramParameter(e.handle,35971);for(let i=0;i<n;i++){const{name:n,type:r,size:o}=t.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,n,r,o)}this.varyingInfos.sort(((e,t)=>e.location-t.location))}_addAttribute(e,t,n,i){const{type:r,components:o}=sl(n),s={type:r,size:i*o};this._inferProperties(e,t,s);const a={location:e,name:t,accessor:new js(s)};this.attributeInfos.push(a),this.attributeInfosByLocation[e]=a,this.attributeInfosByName[a.name]=a}_inferProperties(e,t,n){/instance/i.test(t)&&(n.divisor=1)}_addVarying(e,t,n,i){const{type:r,components:o}=sl(n),s={location:e,name:t,accessor:new js({type:r,size:i*o})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}const cl=35981,ul=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class dl extends Ms{get[Symbol.toStringTag](){return"Program"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.stubRemovedMethods("Program","v6.0",ul),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:t,vs:n,fs:i,varyings:r,bufferMode:o=cl}=e;return this.hash=t||"",this.vs="string"===typeof n?new Va(this.gl,{id:"".concat(e.id,"-vs"),source:n}):n,this.fs="string"===typeof i?new Wa(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,ws(this.vs instanceof Va),ws(this.fs instanceof Wa),this.uniforms={},this._textureUniforms={},r&&r.length>0&&(ko(this.gl),this.varyings=r,this.gl2.transformFeedbackVaryings(this.handle,r,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new ll(this),this.setProps(e)}delete(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:t,drawMode:n=4,vertexCount:i,offset:r=0,start:o,end:s,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:u=c>0,vertexArray:d=null,transformFeedback:h,framebuffer:f,parameters:p={},uniforms:g,samplers:m}=e;if((g||m)&&(xo.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(g||{})),xo.priority>=t){const e=f?f.id:"default",r="mode=".concat(Ps(this.gl,n)," verts=").concat(i," ")+"instances=".concat(c," indexType=").concat(Ps(this.gl,l)," ")+"isInstanced=".concat(u," isIndexed=").concat(a," ")+"Framebuffer=".concat(e);xo.log(t,r)()}return ws(d),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||u&&0===c)&&(d.bindForDraw(i,c,(()=>{if(void 0!==f&&(p=Object.assign({},p,{framebuffer:f})),h){const e=ol(n);h.begin(e)}this._bindTextures(),ls(this.gl,p,(()=>{a&&u?this.gl2.drawElementsInstanced(n,i,l,r,c):a&&Co(this.gl)&&!isNaN(o)&&!isNaN(s)?this.gl2.drawRangeElements(n,o,s,i,l,r):a?this.gl.drawElements(n,i,l,r):u?this.gl2.drawArraysInstanced(n,r,i,c):this.gl.drawArrays(n,r,i)})),h&&h.end()})),!0)}setUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};xo.priority>=2&&function(e,t,n){for(const i in e){const r=e[i];if((!n||Boolean(n[i]))&&!ka(r))throw t=t?"".concat(t," "):"",console.error("".concat(t," Bad uniform ").concat(i),r),new Error("".concat(t," Bad uniform ").concat(i))}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const n=e[t],i=this._uniformSetters[t];if(i){let e=n,r=!1;if(e instanceof va&&(e=e.texture),e instanceof Zs)if(r=this.uniforms[t]!==n,r){void 0===i.textureIndex&&(i.textureIndex=this._textureIndexCounter++);const n=e,{textureIndex:r}=i;n.bind(r),e=r,this._textureUniforms[t]=n}else e=i.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(i(e)||r)&&Ma(this.uniforms,t,n)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const n=this._textureUniforms[t];n.update(),e=e&&n.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const t=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(t)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),n={};for(const i of t){switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new Va({handle:i});break;case 35632:n.fs=new Wa({handle:i})}}return n}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const e=this._getName();this.id=Es(e)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),xo.time(4,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),xo.timeEnd(4,"linkProgram for ".concat(this._getName()))(),e.debug||xo.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));e.validateProgram(this.handle);if(!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const n=this.gl.getActiveUniform(this.handle,t),{name:i}=Aa(n.name);let r=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=Ca(e,r,n),n.size>1)for(let t=0;t<n.size;t++)r=e.getUniformLocation(this.handle,"".concat(i,"[").concat(t,"]")),this._uniformSetters["".concat(i,"[").concat(t,"]")]=Ca(e,r,n)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class hl{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new hl(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find((t=>t.name===e.name))||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"===typeof e?e:e.name;this._defaultModules=this._defaultModules.filter((e=>e.name!==t)),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:t="",fs:n="",defines:i={},inject:r={},varyings:o=[],bufferMode:s=35981,transpileToGLSL100:a=!1}=e,l=this._getModuleList(e.modules),c=this._getHash(t),u=this._getHash(n),d=l.map((e=>this._getHash(e.name))).sort(),h=o.map((e=>this._getHash(e))),f=Object.keys(i).sort(),p=Object.keys(r).sort(),g=[],m=[];for(const y of f)g.push(this._getHash(y)),g.push(this._getHash(i[y]));for(const y of p)m.push(this._getHash(y)),m.push(this._getHash(r[y]));const v="".concat(c,"/").concat(u,"D").concat(g.join("/"),"M").concat(d.join("/"),"I").concat(m.join("/"),"V").concat(h.join("/"),"H").concat(this.stateHash,"B").concat(s).concat(a?"T":"");if(!this._programCache[v]){const e=function(e,t){const{vs:n,fs:i}=t,r=Fr(t.modules||[]);return{gl:e,vs:_o(e,Object.assign({},t,{source:n,type:kr,modules:r})),fs:_o(e,Object.assign({},t,{source:i,type:Mr,modules:r})),getUniforms:wo(r)}}(this.gl,{vs:t,fs:n,modules:l,inject:r,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:a});this._programCache[v]=new dl(this.gl,{hash:v,vs:e.vs,fs:e.fs,varyings:o,bufferMode:s}),this._getUniforms[v]=e.getUniforms||(e=>{}),this._useCounts[v]=0}return this._useCounts[v]++,this._programCache[v]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Array(this._defaultModules.length+e.length),n={};let i=0;for(let r=0,o=this._defaultModules.length;r<o;++r){const e=this._defaultModules[r],o=e.name;t[i++]=e,n[o]=!0}for(let r=0,o=e.length;r<o;++r){const o=e[r],s=o.name;n[s]||(t[i++]=o,n[s]=!0)}return t.length=i,t}}const fl={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},pl="#define SMOOTH_EDGE_RADIUS 0.5",gl={name:"geometry",vs:"\n".concat(pl,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(pl,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},ml=Object.keys(It).map((e=>"const int COORDINATE_SYSTEM_".concat(e," = ").concat(It[e],";"))).join(""),vl=Object.keys(zt).map((e=>"const int PROJECTION_MODE_".concat(e," = ").concat(zt[e],";"))).join(""),yl=Object.keys(Ft).map((e=>"const int UNIT_".concat(e.toUpperCase()," = ").concat(Ft[e],";"))).join(""),bl="".concat(ml,"\n").concat(vl,"\n").concat(yl,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n");function _l(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0}return!1}function wl(e){let t,n={};return i=>{for(const r in i)if(!_l(i[r],n[r])){t=e(i),n=i;break}return t}}const xl=[0,0,0,0],Pl=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Sl=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],El=[0,0,0],Tl=[0,0,0],Cl=wl((function(e){let{viewport:t,devicePixelRatio:n,coordinateSystem:i,coordinateOrigin:r}=e;const{projectionCenter:o,viewProjectionMatrix:s,originCommon:a,cameraPosCommon:l,shaderCoordinateOrigin:c,geospatialOrigin:u}=function(e,t,n){const{viewMatrixUncentered:i,projectionMatrix:r}=e;let{viewMatrix:o,viewProjectionMatrix:s}=e,a=xl,l=xl,c=e.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:d,offsetMode:h}=Al(e,t,n);h&&(l=e.projectPosition(u||d),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=He([],l,s),o=i||o,s=Re([],r,o),s=Re([],s,Pl));return{viewMatrix:o,viewProjectionMatrix:s,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:d,geospatialOrigin:u}}(t,i,r),d=t.getDistanceScales(),h=[t.width*n,t.height*n],f=He([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,p={project_uCoordinateSystem:i,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:c,project_uCommonOrigin:a.slice(0,3),project_uCenter:o,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:h,project_uDevicePixelRatio:n,project_uFocalDistance:f,project_uCommonUnitsPerMeter:d.unitsPerMeter,project_uCommonUnitsPerWorldUnit:d.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:El,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:Sl,project_uCameraPosition:l};if(u){const e=t.getDistanceScales(u);switch(i){case It.METER_OFFSETS:p.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,p.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case It.LNGLAT:case It.LNGLAT_OFFSETS:t._pseudoMeters||(p.project_uCommonUnitsPerMeter=e.unitsPerMeter),p.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,p.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case It.CARTESIAN:p.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],p.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return p}));function Al(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Tl;n.length<3&&(n=[n[0],n[1],0]);let i,r=n,o=!0;switch(i=t===It.LNGLAT_OFFSETS||t===It.METER_OFFSETS?n:e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case zt.WEB_MERCATOR:t!==It.LNGLAT&&t!==It.CARTESIAN||(i=[0,0,0],o=!1);break;case zt.WEB_MERCATOR_AUTO_OFFSET:t===It.LNGLAT?r=i:t===It.CARTESIAN&&(r=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],i=e.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case zt.IDENTITY:r=e.position.map(Math.fround),r[2]=r[2]||0;break;case zt.GLOBE:o=!1,i=null;break;default:o=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:o}}const kl={};const Ml={name:"project",dependencies:[fl,gl],vs:bl,getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kl;return"viewport"in e?function(e){let{viewport:t,devicePixelRatio:n=1,modelMatrix:i=null,coordinateSystem:r=It.DEFAULT,coordinateOrigin:o=Tl,autoWrapLongitude:s=!1}=e;r===It.DEFAULT&&(r=t.isGeospatial?It.LNGLAT:It.CARTESIAN);const a=Cl({viewport:t,devicePixelRatio:n,coordinateSystem:r,coordinateOrigin:o});return a.project_uWrapLongitude=s,a.project_uModelMatrix=i||Sl,a}(e):{}}},Ll=[Ml],Ol=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Rl(e){const t=hl.getDefaultProgramManager(e);for(const n of Ll)t.addDefaultModule(n);for(const n of Ol)t.addShaderHook(n);return t}class Il{constructor(e){let{deck:t,stats:n,viewport:i,timeline:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};I(this,"layers",void 0),I(this,"context",void 0),I(this,"resourceManager",void 0),I(this,"_lastRenderedLayers",[]),I(this,"_needsRedraw",!1),I(this,"_needsUpdate",!1),I(this,"_nextLayers",null),I(this,"_debug",!1),I(this,"activateViewport",(e=>{Xn("layerManager.activateViewport",this,e),e&&(this.context.viewport=e)})),this.layers=[],this.resourceManager=new Ar({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:t,programManager:e&&Rl(e),stats:n||new Jn({id:"deck.gl"}),viewport:i||new Vt({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:r||new On,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(e);t=t||i}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers(){let{layerIds:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?this.layers.filter((t=>e.find((e=>0===t.id.indexOf(e))))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){Xn("layerManager.setLayers",this,t,e),this._lastRenderedLayers=e;const n=Zn(e,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,t,n){n.raiseError(t,"".concat(e," of ").concat(n))}_updateLayers(e,t){const n={};for(const o of e)n[o.id]?ne.warn("Multiple old layers with same id ".concat(o.id))():n[o.id]=o;const i=[];this._updateSublayersRecursively(t,n,i),this._finalizeOldLayers(n);let r=!1;for(const o of i)if(o.hasUniformTransition()){r="Uniform transition in ".concat(o);break}this._needsUpdate=r,this.layers=i}_updateSublayersRecursively(e,t,n){for(const r of e){r.context=this.context;const e=t[r.id];null===e&&ne.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let o=null;try{this._debug&&e!==r&&r.validateProps(),e?(this._transferLayerState(e,r),this._updateLayer(r)):this._initializeLayer(r),n.push(r),o=r.isComposite?r.getSubLayers():null}catch(i){this._handleError("matching",i,r)}o&&this._updateSublayersRecursively(o,t,n)}}_finalizeOldLayers(e){for(const t in e){const n=e[t];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=zn}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=In,t!==e&&(e.lifecycle=Fn)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Dn;try{e._finalize(),e.lifecycle=jn}catch(t){this._handleError("finalization",t,e)}}}class zl{constructor(e){I(this,"width",void 0),I(this,"height",void 0),I(this,"views",void 0),I(this,"viewState",void 0),I(this,"controllers",void 0),I(this,"timeline",void 0),I(this,"_viewports",void 0),I(this,"_viewportMap",void 0),I(this,"_isUpdating",void 0),I(this,"_needsRedraw",void 0),I(this,"_needsUpdate",void 0),I(this,"_eventManager",void 0),I(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter((t=>t.containsPixel(e))):this._viewports}getViews(){const e={};return this.views.forEach((t=>{e[t.id]=t})),e}getView(e){return this.views.find((t=>t.id===e))}getViewState(e){const t="string"===typeof e?this.getView(e):e,n=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,t){const n=this.getViewports(),i={x:e[0],y:e[1]};for(let r=n.length-1;r>=0;--r){const o=n[r];if(o.containsPixel(i)){const n=e.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Zn(e,Boolean);this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){if(e){!qt(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e}else ne.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...t,viewId:e})}_createController(e,t){return new(0,t.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:t=>{var n;return null===(n=this.getView(e.id))||void 0===n?void 0:n.makeViewport({viewState:t,width:this.width,height:this.height})}})}_updateController(e,t,n,i){const r=e.controller;if(r&&n){const o={...t,...r,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height};return i||(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=e.length;i--;){const r=e[i],o=this.getViewState(r),s=r.makeViewport({viewState:o,width:this.width,height:this.height});let a=t[r.id];const l=Boolean(r.controller);l&&!a&&(n=!0),!n&&l||!a||(a.finalize(),a=null),this.controllers[r.id]=this._updateController(r,o,s,a),s&&this._viewports.unshift(s)}for(const i in t){const e=t[i];e&&!this.controllers[i]&&e.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)}))}_diffViews(e,t){return e.length!==t.length||e.some(((n,i)=>!e[i].equals(t[i])))}}class Fl extends Vt{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{latitude:t=0,longitude:n=0,zoom:i=0,pitch:r=0,bearing:o=0,nearZMultiplier:s=.1,farZMultiplier:a=1.01,orthographic:l=!1,projectionMatrix:c,repeat:u=!1,worldOffset:d=0,position:h,padding:f,legacyMeterSizes:p=!1}=e;let{width:g,height:m,altitude:v=1.5}=e;const y=Math.pow(2,i);let b;g=g||1,m=m||1;let _=null;if(c)v=c[5]/2,b=Pt(v);else{let n;if(e.fovy?(b=e.fovy,v=St(b)):b=Pt(v),f){const{top:e=0,bottom:t=0}=f;n=[0,ae((e+m-t)/2,0,m)-m/2]}_=xt({width:g,height:m,scale:y,center:h&&[0,0,h[2]*bt(t)],offset:n,pitch:r,fovy:b,nearZMultiplier:s,farZMultiplier:a})}let w=function(e){const{height:t,pitch:n,bearing:i,altitude:r,scale:o,center:s}=e,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Ie(a,a,[0,0,-r]),Fe(a,a,-n*ct),De(a,a,i*ct);const l=o/t;var c,u;return ze(a,a,[l,l,l]),s&&Ie(a,a,((c=[])[0]=-(u=s)[0],c[1]=-u[1],c[2]=-u[2],c)),a}({height:m,pitch:r,bearing:o,scale:y,altitude:v});if(d){w=(new $e).translate([512*d,0,0]).multiplyLeft(w)}super({...e,width:g,height:m,viewMatrix:w,longitude:n,latitude:t,zoom:i,..._,fovy:b,focalDistance:v}),I(this,"longitude",void 0),I(this,"latitude",void 0),I(this,"pitch",void 0),I(this,"bearing",void 0),I(this,"altitude",void 0),I(this,"fovy",void 0),I(this,"orthographic",void 0),I(this,"_subViewports",void 0),I(this,"_pseudoMeters",void 0),this.latitude=t,this.longitude=n,this.zoom=i,this.pitch=r,this.bearing=o,this.altitude=v,this.fovy=b,this.orthographic=l,this._subViewports=u?[]:null,this._pseudoMeters=p,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let i=t;i<=n;i++){const e=i?new Fl({...this,worldOffset:i}):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*bt(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)/bt(n)]}addMetersToLngLat(e,t){return wt(e,t)}panByPosition(e,t){const n=Tt(t,this.pixelUnprojectionMatrix),i=Be([],this.projectFlat(e),((r=[])[0]=-(o=n)[0],r[1]=-o[1],r));var r,o;const s=Be([],this.center,i),[a,l]=this.unprojectFlat(s);return{longitude:a,latitude:l}}getBounds(){const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:n,height:i,unproject:r}=e,o={targetZ:t},s=r([0,i],o),a=r([n,i],o);let l,c;return(e.fovy?.5*e.fovy*At:Math.atan(.5/e.altitude))>(90-e.pitch)*At-.01?(l=kt(e,0,t),c=kt(e,n,t)):(l=r([0,0],o),c=r([n,0],o)),[s,a,c,l]}(this,(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{width:n,height:i}=this,{longitude:r,latitude:o,zoom:s}=Ct({width:n,height:i,bounds:e,...t});return new Fl({width:n,height:i,longitude:r,latitude:o,zoom:s})}}I(Fl,"displayName","WebMercatorViewport");class Dl extends Zt{get ViewportType(){return Fl}get ControllerType(){return Tn}}I(Dl,"displayName","MapView");const jl=[255,255,255],Nl=1;let Bl=0;class Ul{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};I(this,"id",void 0),I(this,"color",void 0),I(this,"intensity",void 0),I(this,"type","ambient");const{color:t=jl}=e,{intensity:n=Nl}=e;this.id=e.id||"ambient-".concat(Bl++),this.color=t,this.intensity=n}}const Vl=[255,255,255],Wl=1,Gl=[0,0,-1];let Hl=0;class ql{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};I(this,"id",void 0),I(this,"color",void 0),I(this,"intensity",void 0),I(this,"type","directional"),I(this,"direction",void 0),I(this,"shadow",void 0);const{color:t=Vl}=e,{intensity:n=Wl}=e,{direction:i=Gl}=e,{_shadow:r=!1}=e;this.id=e.id||"directional-".concat(Hl++),this.color=t,this.intensity=n,this.type="directional",this.direction=new Ee(i).normalize().toArray(),this.shadow=r}getProjectedLight(e){return this}}class Xl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:"pass"};I(this,"id",void 0),I(this,"gl",void 0),I(this,"props",void 0);const{id:n}=t;this.id=n,this.gl=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class Zl extends Xl{constructor(){super(...arguments),I(this,"_lastRenderIndex",-1)}render(e){return as(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:t,moduleParameters:n,viewports:i,views:r,onViewportActive:o,clearStack:s=!0,clearCanvas:a=!0}=e;e.pass=e.pass||"unknown";const l=this.gl;a&&function(e,t){const n=t?t.width:e.drawingBufferWidth,i=t?t.height:e.drawingBufferHeight;as(e,{viewport:[0,0,n,i]}),e.clear(16640)}(l,t),s&&(this._lastRenderIndex=-1);const c=[];for(const u of i){const i=r&&r[u.id];null===o||void 0===o||o(u);const s=this._getDrawLayerParams(u,e),a=u.subViewports||[u];for(const r of a){const o=this._drawLayersInViewport(l,{target:t,moduleParameters:n,viewport:r,view:i,pass:e.pass,layers:e.layers},s);c.push(o)}}return c}_getDrawLayerParams(e,t){let{layers:n,pass:i,isPicking:r=!1,layerFilter:o,cullRect:s,effects:a,moduleParameters:l}=t,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const u=[],d=Yl(this._lastRenderIndex+1),h={layer:n[0],viewport:e,isPicking:r,renderPass:i,cullRect:s},f={};for(let p=0;p<n.length;p++){const t=n[p],r=this._shouldDrawLayer(t,h,o,f),s={shouldDrawLayer:r};r&&!c&&(s.layerRenderIndex=d(t,r),s.moduleParameters=this._getModuleParameters(t,a,i,l),s.layerParameters=this.getLayerParameters(t,p,e)),u[p]=s}return u}_drawLayersInViewport(e,t,n){let{layers:i,moduleParameters:r,pass:o,target:s,viewport:a,view:l}=t;const c=function(e,t){let{moduleParameters:n,target:i,viewport:r}=t;const o=i&&"default-framebuffer"!==i.id,s=n&&n.devicePixelRatio||cs(e),a=o?i.height:e.drawingBufferHeight,l=r;return[l.x*s,a-(l.y+l.height)*s,l.width*s,l.height*s]}(e,{moduleParameters:r,target:s,viewport:a});if(l&&l.props.clear){const t=!0===l.props.clear?{color:!0,depth:!0}:l.props.clear;ls(e,{scissorTest:!0,scissor:c},(()=>na(e,t)))}const u={totalCount:i.length,visibleCount:0,compositeCount:0,pickableCount:0};as(e,{viewport:c});for(let h=0;h<i.length;h++){const e=i[h],{shouldDrawLayer:t,layerRenderIndex:r,moduleParameters:s,layerParameters:l}=n[h];if(t&&e.props.pickable&&u.pickableCount++,e.isComposite)u.compositeCount++;else if(t){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,r),s.viewport=a;try{e._drawLayer({moduleParameters:s,uniforms:{layerIndex:r},parameters:l})}catch(d){e.raiseError(d,"drawing ".concat(e," to ").concat(o))}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t,n){return e.props.parameters}_shouldDrawLayer(e,t,n,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let r=e.parent;for(;r;){if(!r.props.visible||!r.filterSubLayer(t))return!1;t.layer=r,r=r.parent}if(n){const e=t.layer.id;if(e in i||(i[e]=n(t)),!i[e])return!1}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,n,i){var r;const o=Object.assign(Object.create((null===(r=e.internalState)||void 0===r?void 0:r.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:cs(this.gl)});if(t)for(const a of t){var s;Object.assign(o,null===(s=a.getModuleParameters)||void 0===s?void 0:s.call(a,e))}return Object.assign(o,this.getModuleParameters(e,t),i)}}function Yl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={},i=(r,o)=>{const s=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in t)&&i(r.parent,!1),l in n){const e=n[l]=n[l]||Yl(t[l],t);c=e(r,o),n[a]=e}else Number.isFinite(s)?(c=s+(t[l]||0),n[a]=null):c=e;return o&&c>=e&&(e=c+1),t[a]=c,c};return i}class Kl extends Zl{constructor(e,t){super(e,t),I(this,"shadowMap",void 0),I(this,"depthBuffer",void 0),I(this,"fbo",void 0),this.shadowMap=new Ks(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Js(e,{format:33189,width:1,height:1}),this.fbo=new va(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;ls(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const n=e.viewports[0],i=cs(this.gl),r=n.width*i,o=n.height*i;r===t.width&&o===t.height||t.resize({width:r,height:o}),super.render({...e,target:t,pass:"shadow"})}))}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const Ql=wl((function(e){let{viewport:t,center:n}=e;return new $e(t.viewProjectionMatrix).invert().transform(n)})),$l=wl((function(e){let{viewport:t,shadowMatrices:n}=e;const i=[],r=t.pixelUnprojectionMatrix,o=t.isGeospatial?void 0:1,s=[[0,0,o],[t.width,0,o],[0,t.height,o],[t.width,t.height,o],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((e=>function(e,t){const[n,i,r]=e,o=Tt([n,i,r],t);if(Number.isFinite(r))return o;return[o[0],o[1],0]}(e,r)));for(const a of n){const e=a.clone().translate(new Ee(t.center).negate()),n=s.map((t=>e.transform(t))),r=(new $e).ortho({left:Math.min(...n.map((e=>e[0]))),right:Math.max(...n.map((e=>e[0]))),bottom:Math.min(...n.map((e=>e[1]))),top:Math.max(...n.map((e=>e[1]))),near:Math.min(...n.map((e=>-e[2]))),far:Math.max(...n.map((e=>-e[2])))});i.push(r.multiplyRight(a))}return i})),Jl=[0,0,0,1],ec=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];const tc={name:"shadow",dependencies:[Ml],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"viewport"in e&&(e.drawToShadowMap||e.shadowMaps&&e.shadowMaps.length>0)?function(e,t){const{shadowEnabled:n=!0}=e;if(!n||!e.shadowMatrices||!e.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:Boolean(e.drawToShadowMap),shadow_uUseShadowMap:!!e.shadowMaps&&e.shadowMaps.length>0,shadow_uColor:e.shadowColor||Jl,shadow_uLightId:e.shadowLightId||0,shadow_uLightCount:e.shadowMatrices.length},r=Ql({viewport:e.viewport,center:t.project_uCenter}),o=[],s=$l({shadowMatrices:e.shadowMatrices,viewport:e.viewport}).slice();for(let a=0;a<e.shadowMatrices.length;a++){const n=s[a],i=n.clone().translate(new Ee(e.viewport.center).negate());t.project_uCoordinateSystem===It.LNGLAT&&t.project_uProjectionMode===zt.WEB_MERCATOR?(s[a]=i,o[a]=r):(s[a]=n.clone().multiplyRight(ec),o[a]=i.transform(r))}for(let a=0;a<s.length;a++)i["shadow_uViewProjectionMatrices[".concat(a,"]")]=s[a],i["shadow_uProjectCenters[".concat(a,"]")]=o[a],e.shadowMaps&&e.shadowMaps.length>0?i["shadow_uShadowMap".concat(a)]=e.shadowMaps[a]:i["shadow_uShadowMap".concat(a)]=e.dummyShadowMap;return i}(e,t):{}}},nc={color:[255,255,255],intensity:1},ic=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],rc=[0,0,0,200/255];class oc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};I(this,"id","lighting-effect"),I(this,"props",void 0),I(this,"shadowColor",rc),I(this,"shadow",void 0),I(this,"ambientLight",void 0),I(this,"directionalLights",void 0),I(this,"pointLights",void 0),I(this,"shadowPasses",[]),I(this,"shadowMaps",[]),I(this,"dummyShadowMap",null),I(this,"programManager",void 0),I(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const t in e){const n=e[t];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((e=>e.shadow)),this.props=e}preRender(e,t){let{layers:n,layerFilter:i,viewports:r,onViewportActive:o,views:s}=t;if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=hl.getDefaultProgramManager(e),tc&&this.programManager.addDefaultModule(tc)),this.dummyShadowMap||(this.dummyShadowMap=new Ks(e,{width:1,height:1}));for(let e=0;e<this.shadowPasses.length;e++){this.shadowPasses[e].render({layers:n,layerFilter:i,viewports:r,onViewportActive:o,views:s,moduleParameters:{shadowLightId:e,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((t=>t.getProjectedLight({layer:e}))),pointLights:this.pointLights.map((t=>t.getProjectedLight({layer:e})))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(tc),this.programManager=null)}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const n=(new $e).lookAt({eye:new Ee(t.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const n=new Kl(e);this.shadowPasses[t]=n,this.shadowMaps[t]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:n}=this;e||0!==t.length||0!==n.length||(this.ambientLight=new Ul(nc),this.directionalLights.push(new ql(ic[0]),new ql(ic[1])))}}const sc=new oc;class ac{constructor(){I(this,"effects",void 0),I(this,"_resolvedEffects",[]),I(this,"_defaultEffects",[]),I(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find((t=>t.id===e.id))){const n=t.findIndex((t=>function(e,t){var n,i;return(null!==(n=e.order)&&void 0!==n?n:1/0)-(null!==(i=t.order)&&void 0!==i?i:1/0)}(t,e)>0));n<0?t.push(e):t.splice(n,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(qt(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const i of this.effects)t[i.id]=i;const n=[];for(const i of e){const e=t[i.id];e&&e!==i?e.setProps?(e.setProps(i.props),n.push(e)):(e.cleanup(),n.push(i)):n.push(i),delete t[i.id]}for(const i in t)t[i].cleanup();this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some((e=>e instanceof oc))||this._resolvedEffects.push(sc),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class lc extends Zl{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}const cc={blendFunc:[1,0,32771,0],blendEquation:32774};class uc extends Zl{constructor(){super(...arguments),I(this,"pickZ",void 0),I(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer(e){let{layers:t,layerFilter:n,views:i,viewports:r,onViewportActive:o,pickingFBO:s,deviceRect:{x:a,y:l,width:c,height:u},cullRect:d,effects:h,pass:f="picking",pickZ:p,moduleParameters:g}=e;const m=this.gl;this.pickZ=p;const v=this._resetColorEncoder(p),y=ls(m,{scissorTest:!0,scissor:[a,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...cc,blend:!p},(()=>super.render({target:s,layers:t,layerFilter:n,views:i,viewports:r,onViewportActive:o,cullRect:d,effects:null===h||void 0===h?void 0:h.filter((e=>e.useInPicking)),pass:f,isPicking:!0,moduleParameters:g})));this._colorEncoderState=null;return{decodePickingColor:v&&dc.bind(null,v),stats:y}}shouldDrawLayer(e){const{pickable:t,operation:n}=e.props;return t&&n.includes("draw")||n.includes("terrain")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t,n){const i={...e.props.parameters},{pickable:r,operation:o}=e.props;return this._colorEncoderState?r&&o.includes("draw")&&(Object.assign(i,cc),i.blend=!0,i.blendColor=function(e,t,n){const{byLayer:i,byAlpha:r}=e;let o,s=i.get(t);s?(s.viewports.push(n),o=s.a):(o=i.size+1,o<=255?(s={a:o,layer:t,viewports:[n]},i.set(t,s),r[o]=s):(ne.warn("Too many pickable layers, only picking the first 255")(),o=0));return[0,0,0,o/255]}(this._colorEncoderState,e,n)):i.blend=!1,o.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function dc(e,t){const n=e.byAlpha[t[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(t)}}class hc{constructor(e){I(this,"gl",void 0),I(this,"layerFilter",void 0),I(this,"drawPickingColors",void 0),I(this,"drawLayersPass",void 0),I(this,"pickLayersPass",void 0),I(this,"renderCount",void 0),I(this,"_needsRedraw",void 0),I(this,"renderBuffers",void 0),I(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new lc(e),this.pickLayersPass=new uc(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||va.getDefaultFramebuffer(this.gl)};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target,r=t.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,Xn("deckRenderer.renderLayers",this,r,e)}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const n of e)t.preRenderStats[n.id]=n.preRender(this.gl,t),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new va(this.gl),new va(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:n}=this,i={...t,inputBuffer:n[0],swapBuffer:n[1],target:null};for(const r of e)if(r.postRender){if(r.id===this.lastPostProcessEffect){i.target=t.target,r.postRender(this.gl,i);break}const e=r.postRender(this.gl,i);i.inputBuffer=e,i.swapBuffer=e===n[0]?n[1]:n[0]}}}const fc={pickedColor:null,pickedObjectIndex:-1};function pc(e){let{pickedColors:t,decodePickingColor:n,deviceX:i,deviceY:r,deviceRadius:o,deviceRect:s}=e;const{x:a,y:l,width:c,height:u}=s;let d=o*o,h=-1,f=0;for(let p=0;p<u;p++){const e=p+l-r,n=e*e;if(n>d)f+=4*c;else for(let r=0;r<c;r++){if(t[f+3]-1>=0){const e=r+a-i,t=e*e+n;t<=d&&(d=t,h=f)}f+=4}}if(h>=0){const e=t.slice(h,h+4),i=n(e);if(i){const t=Math.floor(h/4/c),n=h/4-t*c;return{...i,pickedColor:e,pickedX:a+n,pickedY:l+t}}ne.error("Picked non-existent layer. Is picking buffer corrupt?")()}return fc}function gc(e){let t,{pickInfo:n,viewports:i,pixelRatio:r,x:o,y:s,z:a}=e,l=i[0];if(i.length>1&&(l=function(e,t){for(let n=e.length-1;n>=0;n--){const i=e[n];if(i.containsPixel(t))return i}return e[0]}((null===n||void 0===n?void 0:n.pickedViewports)||i,{x:o,y:s})),l){const e=[o-l.x,s-l.y];void 0!==a&&(e[2]=a),t=l.unproject(e)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:o,y:s,pixel:[o,s],coordinate:t,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:r}}function mc(e){const{pickInfo:t,lastPickedInfo:n,mode:i,layers:r}=e,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=t,l=s?[s]:[];if("hover"===i){const e=n.index,t=n.layerId,i=s?s.props.id:null;if(i!==t||a!==e){if(i!==t){const e=r.find((e=>e.props.id===t));e&&l.unshift(e)}n.layerId=i,n.index=a,n.info=null}}const c=gc(e),u=new Map;return u.set(null,c),l.forEach((e=>{let t={...c};e===s&&(t.color=o,t.index=a,t.picked=!0),t=vc({layer:e,info:t,mode:i});const r=t.layer;e===s&&"hover"===i&&(n.info=t),u.set(r.id,t),"hover"===i&&r.updateAutoHighlight(t)})),u}function vc(e){let{layer:t,info:n,mode:i}=e;for(;t&&n;){const e=n.layer||null;n.sourceLayer=e,n.layer=t,n=t.getPickingInfo({info:n,mode:i,sourceLayer:e}),t=t.parent}return n}class yc{constructor(e){I(this,"gl",void 0),I(this,"pickingFBO",void 0),I(this,"depthFBO",void 0),I(this,"pickLayersPass",void 0),I(this,"layerFilter",void 0),I(this,"lastPickedInfo",void 0),I(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new uc(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject(e){let{x:t,y:n,layers:i,viewports:r}=e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastPickedInfo.info;const s=o&&o.layer&&o.layer.id,a=o&&o.viewport&&o.viewport.id,l=s?i.find((e=>e.id===s)):null,c=a&&r.find((e=>e.id===a))||r[0],u=c&&c.unproject([t-c.x,n-c.y]),d={x:t,y:n,viewport:c,coordinate:u,layer:l};return{...o,...d}}_resizeBuffer(){var e,t;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new va(n),va.isSupported(n,{colorBufferFloat:!0}))){const e=new va(n);e.attach({36064:new Ks(n,{format:Co(n)?34836:6408,type:5126})}),this.depthFBO=e}null===(e=this.pickingFBO)||void 0===e||e.resize({width:n.canvas.width,height:n.canvas.height}),null===(t=this.depthFBO)||void 0===t||t.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter((e=>this.pickLayersPass.shouldDrawLayer(e)&&!e.isComposite));return t.length?t:null}_pickClosestObject(e){let{layers:t,views:n,viewports:i,x:r,y:o,radius:s=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:d}=e;const h=this._getPickable(t),f=cs(this.gl);if(!h)return{result:[],emptyInfo:gc({viewports:i,x:r,y:o,pixelRatio:f})};this._resizeBuffer();const p=us(this.gl,[r,o],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],m=Math.round(s*f),{width:v,height:y}=this.pickingFBO,b=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:v,deviceHeight:y}),_={x:r-s,y:o-s,width:2*s+1,height:2*s+1};let w;const x=[],P=new Set;for(let S=0;S<a;S++){let e,t;if(b){e=pc({...this._drawAndSample({layers:h,views:n,viewports:i,onViewportActive:u,deviceRect:b,cullRect:_,effects:d,pass:"picking:".concat(l)}),deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:b})}else e={pickedColor:null,pickedObjectIndex:-1};if(e.pickedLayer&&c&&this.depthFBO){const{pickedColors:r}=this._drawAndSample({layers:[e.pickedLayer],views:n,viewports:i,onViewportActive:u,deviceRect:{x:e.pickedX,y:e.pickedY,width:1,height:1},cullRect:_,effects:d,pass:"picking:".concat(l,":z")},!0);r[3]&&(t=r[0])}e.pickedLayer&&S+1<a&&(P.add(e.pickedLayer),e.pickedLayer.disablePickingIndex(e.pickedObjectIndex)),w=mc({pickInfo:e,lastPickedInfo:this.lastPickedInfo,mode:l,layers:h,viewports:i,x:r,y:o,z:t,pixelRatio:f});for(const n of w.values())n.layer&&x.push(n);if(!e.pickedColor)break}for(const S of P)S.restorePickingColors();return{result:x,emptyInfo:w.get(null)}}_pickVisibleObjects(e){let{layers:t,views:n,viewports:i,x:r,y:o,width:s=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:d}=e;const h=this._getPickable(t);if(!h)return[];this._resizeBuffer();const f=cs(this.gl),p=us(this.gl,[r,o],!0),g=p.x,m=p.y+p.height,v=us(this.gl,[r+s,o+a],!0),y=v.x+v.width,b=v.y,_={x:g,y:b,width:y-g,height:m-b},w=function(e){let{pickedColors:t,decodePickingColor:n}=e;const i=new Map;if(t)for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const e=t.slice(r,r+4),o=e.join(",");if(!i.has(o)){const t=n(e);t?i.set(o,{...t,color:e}):ne.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(i.values())}(this._drawAndSample({layers:h,views:n,viewports:i,onViewportActive:u,deviceRect:_,cullRect:{x:r,y:o,width:s,height:a},effects:d,pass:"picking:".concat(l)})),x=new Map,P=Number.isFinite(c);for(let S=0;S<w.length&&!(P&&c&&x.size>=c);S++){const e=w[S];let t={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:r,y:o,pixelRatio:f};t=vc({layer:e.pickedLayer,info:t,mode:l}),x.has(t.object)||x.set(t.object,t)}return Array.from(x.values())}_drawAndSample(e){let{layers:t,views:n,viewports:i,onViewportActive:r,deviceRect:o,cullRect:s,effects:a,pass:l}=e,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const u=c?this.depthFBO:this.pickingFBO,d={layers:t,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:r,pickingFBO:u,deviceRect:o,cullRect:s,effects:a,pass:l,pickZ:c,preRenderStats:{}};for(const y of a)y.useInPicking&&(d.preRenderStats[y.id]=y.preRender(this.gl,d));const{decodePickingColor:h}=this.pickLayersPass.render(d),{x:f,y:p,width:g,height:m}=o,v=new(c?Float32Array:Uint8Array)(g*m*4);return aa(u,{sourceX:f,sourceY:p,sourceWidth:g,sourceHeight:m,target:v}),{pickedColors:v,decodePickingColor:h}}_getPickingRect(e){let{deviceX:t,deviceY:n,deviceRadius:i,deviceWidth:r,deviceHeight:o}=e;const s=Math.max(0,t-i),a=Math.max(0,n-i),l=Math.min(r,t+i+1)-s,c=Math.min(o,n+i+1)-a;return l<=0||c<=0?null:{x:s,y:a,width:l,height:c}}}const bc={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class _c{constructor(e){I(this,"el",null),I(this,"isVisible",!1);const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,bc),t.appendChild(this.el))}setTooltip(e,t,n){const i=this.el;if(i){if("string"===typeof e)i.innerText=e;else{if(!e)return this.isVisible=!1,void(i.style.display="none");e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className),Object.assign(i.style,e.style)}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(t,"px, ").concat(n,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}const{_parseImageNode:wc}=globalThis,xc="undefined"!==typeof Image,Pc="undefined"!==typeof ImageBitmap,Sc=Boolean(wc),Ec=!!Ti||Sc;function Tc(e){const t=Ac(e);if(!t)throw new Error("Not an image");return t}function Cc(e){switch(Tc(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function Ac(e){return"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!==typeof Image&&e instanceof Image?"image":e&&"object"===typeof e&&e.data&&e.width&&e.height?"data":null}const kc=/^data:image\/svg\+xml/,Mc=/\.svg((\?|#).*)?$/;function Lc(e){return e&&(kc.test(e)||Mc.test(e))}function Oc(e,t){if(Lc(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function Rc(e,t,n){const i=function(e,t){if(Lc(t)){let t=(new TextDecoder).decode(e);try{"function"===typeof unescape&&"function"===typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(n){throw new Error(n.message)}return"data:image/svg+xml;base64,".concat(btoa(t))}return Oc(e,t)}(e,n),r=self.URL||self.webkitURL,o="string"!==typeof i&&r.createObjectURL(i);try{return await async function(e,t){const n=new Image;if(n.src=e,t.image&&t.image.decode&&n.decode)return await n.decode(),n;return await new Promise(((t,i)=>{try{n.onload=()=>t(n),n.onerror=t=>i(new Error("Could not load image ".concat(e,": ").concat(t)))}catch(r){i(r)}}))}(o||i,t)}finally{o&&r.revokeObjectURL(o)}}const Ic={};let zc=!0;async function Fc(e,t,n){let i;if(Lc(n)){i=await Rc(e,t,n)}else i=Oc(e,n);const r=t&&t.imagebitmap;return await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e){for(const t in e||Ic)return!1;return!0}(t)&&zc||(t=null);if(t)try{return await createImageBitmap(e,t)}catch(n){console.warn(n),zc=!1}return await createImageBitmap(e)}(i,r)}const Dc=!1,jc=!0;function Nc(e){const t=Bc(e);return function(e){const t=Bc(e),n=t.byteLength>=24&&2303741511===t.getUint32(0,Dc);if(!n)return null;return{mimeType:"image/png",width:t.getUint32(16,Dc),height:t.getUint32(20,Dc)}}(t)||function(e){const t=Bc(e),n=t.byteLength>=3&&65496===t.getUint16(0,Dc)&&255===t.getUint8(2);if(!n)return null;const{tableMarkers:i,sofMarkers:r}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)e.add(n);const t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}();let o=2;for(;o+9<t.byteLength;){const e=t.getUint16(o,Dc);if(r.has(e))return{mimeType:"image/jpeg",height:t.getUint16(o+5,Dc),width:t.getUint16(o+7,Dc)};if(!i.has(e))return null;o+=2,o+=t.getUint16(o,Dc)}return null}(t)||function(e){const t=Bc(e),n=t.byteLength>=10&&1195984440===t.getUint32(0,Dc);if(!n)return null;return{mimeType:"image/gif",width:t.getUint16(6,jc),height:t.getUint16(8,jc)}}(t)||function(e){const t=Bc(e),n=t.byteLength>=14&&16973===t.getUint16(0,Dc)&&t.getUint32(2,jc)===t.byteLength;if(!n)return null;return{mimeType:"image/bmp",width:t.getUint32(18,jc),height:t.getUint32(22,jc)}}(t)}function Bc(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}const Uc={id:"image",module:"images",name:"Images",version:"3.3.4",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:async function(e,t,n){const i=((t=t||{}).image||{}).type||"auto",{url:r}=n||{};let o;switch(function(e){switch(e){case"auto":case"data":return function(){if(Pc)return"imagebitmap";if(xc)return"image";if(Ec)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return Pc||xc||Ec;case"imagebitmap":return Pc;case"image":return xc;case"data":return Ec;default:throw new Error("@loaders.gl/images: image ".concat(e," not supported in this environment"))}}(e),e}}(i)){case"imagebitmap":o=await Fc(e,t,r);break;case"image":o=await Rc(e,t,r);break;case"data":o=await async function(e,t){const{mimeType:n}=Nc(e)||{},i=globalThis._parseImageNode;return ui(i),await i(e,n)}(e);break;default:ui(!1)}return"data"===i&&(o=Cc(o)),o},tests:[e=>Boolean(Nc(new DataView(e)))],options:{image:{type:"auto",decode:!0}}};const Vc={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(e){const t=e[0],n=e[e.length-1];return"{"===t&&"}"===n||"["===t&&"]"===n},parseTextSync:JSON.parse};const Wc=function(){const e="8.9.13",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==e)throw new Error("deck.gl - multiple versions detected: ".concat(t," vs ").concat(e));return t||(ne.log(1,"deck.gl ".concat(e))(),globalThis.deck={...globalThis.deck,VERSION:e,version:e,log:ne,_registerLoggers:qn},function(e){const t=gr();e=Array.isArray(e)?e:[e];for(const n of e){const e=hi(n);t.find((t=>e===t))||t.unshift(e)}}([Vc,[Uc,{imagebitmap:{premultiplyAlpha:"none"}}]])),e}(),Gc=globalThis;function Hc(e){if(!e&&!F())return"Node";if(z(e))return"Electron";const t="undefined"!==typeof navigator?navigator:{},n=e||t.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r?"IE":Gc.chrome?"Chrome":Gc.safari?"Safari":Gc.mozInnerScreenX?"Firefox":"Unknown"}class qc extends Ms{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=Co(e),i=pa(e,ua);let r=n||i;for(const o of t)switch(o){case"queries":r=r&&n;break;case"timers":r=r&&i;break;default:ws(!1)}return r}constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise(((n,i)=>{const r=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):t++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(r)};requestAnimationFrame(r)})),this._pollingPromise}_createHandle(){return qc.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Xc=F()&&"undefined"!==typeof document;let Zc=0;class Yc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:t=(e=>ms(e)),onAddHTML:n=null,onInitialize:i=(()=>{}),onRender:r=(()=>{}),onFinalize:o=(()=>{}),onError:s,gl:a=null,glOptions:l={},debug:c=!1,createFramebuffer:u=!1,autoResizeViewport:d=!0,autoResizeDrawingBuffer:h=!0,stats:f=_s.get("animation-loop-".concat(Zc++))}=e;let{useDevicePixels:p=!0}=e;"useDevicePixelRatio"in e&&(xo.deprecated("useDevicePixelRatio","useDevicePixels")(),p=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:n,onInitialize:i,onRender:r,onFinalize:o,onError:s,gl:a,glOptions:l,debug:c,createFramebuffer:u},this.gl=a,this.needsRedraw=null,this.timeline=null,this.stats=f,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:d,autoResizeDrawingBuffer:h,useDevicePixels:p}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return ws("string"===typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then((()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=qc.isSupported(this.gl,["timers"])?new qc(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps)))).then((e=>{this._running&&(this._addCallbackData(e||{}),!1!==e&&this._startLoop())}));return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((e=>{this._resolveNextFrame=e}))),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=document.getElementById(e);return n?Number(n.value):t}setViewParameters(){return xo.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Xc?new Promise(((e,t)=>{Xc&&"complete"===document.readyState?e(document):window.addEventListener("load",(()=>{e(document)}))})):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):(t=e,"undefined"!==typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t));var t}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):(t=e,"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60));var t}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:n}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"===typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!==typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?vs(this.props.gl,e):this.onCreateContext(e),!To(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");as(this.gl,Wo),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let n=1;const{canvas:i}=this.gl;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:e>0&&t>0&&(n=e/t),{width:e,height:t,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&ys(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new va(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var Kc=n(97);const Qc={mousedown:1,mousemove:2,mouseup:4};!function(e){const t=e.prototype.handler;e.prototype.handler=function(e){const n=this.store;e.button>0&&"pointerdown"===e.type&&(function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}(n,(t=>t.pointerId===e.pointerId))||n.push(e)),t.call(this,e)}}(Kc.PointerEventInput),Kc.MouseInput.prototype.handler=function(e){let t=Qc[e.type];1&t&&e.button>=0&&(this.pressed=!0),2&t&&0===e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))};const $c=Kc.Manager,Jc=Kc;class eu{constructor(e,t,n){this.element=e,this.callback=t,this.options={enable:!0,...n}}}const tu=Jc?[[Jc.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Jc.Rotate,{enable:!1}],[Jc.Pinch,{enable:!1}],[Jc.Swipe,{enable:!1}],[Jc.Pan,{threshold:0,enable:!1}],[Jc.Press,{enable:!1}],[Jc.Tap,{event:"doubletap",taps:2,enable:!1}],[Jc.Tap,{event:"anytap",enable:!1}],[Jc.Tap,{enable:!1}]]:null,nu={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},iu={doubletap:["tap"]},ru={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},ou={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},su={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},au={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},lu="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",cu="undefined"!==typeof window?window:n.g;"undefined"!==typeof n.g?n.g:window,"undefined"!==typeof document&&document;let uu=!1;try{const e={get passive(){return uu=!0,!0}};cu.addEventListener("test",null,e),cu.removeEventListener("test",null)}catch(Tg){uu=!1}const du=-1!==lu.indexOf("firefox"),{WHEEL_EVENTS:hu}=ou,fu="wheel",pu=4.000244140625;class gu extends eu{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{if(!this.options.enable)return;let t=e.deltaY;cu.WheelEvent&&(du&&e.deltaMode===cu.WheelEvent.DOM_DELTA_PIXEL&&(t/=cu.devicePixelRatio),e.deltaMode===cu.WheelEvent.DOM_DELTA_LINE&&(t*=40)),0!==t&&t%pu===0&&(t=Math.floor(t/pu)),e.shiftKey&&t&&(t*=.25),this.callback({type:fu,center:{x:e.clientX,y:e.clientY},delta:-t,srcEvent:e,pointerType:"mouse",target:e.target})},this.events=(this.options.events||[]).concat(hu),this.events.forEach((t=>e.addEventListener(t,this.handleEvent,!!uu&&{passive:!1})))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===fu&&(this.options.enable=t)}}const{MOUSE_EVENTS:mu}=ou,vu="pointermove",yu="pointerover",bu="pointerout",_u="pointerenter",wu="pointerleave";class xu extends eu{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{this.handleOverEvent(e),this.handleOutEvent(e),this.handleEnterEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(mu),this.events.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===vu&&(this.enableMoveEvent=t),e===yu&&(this.enableOverEvent=t),e===bu&&(this.enableOutEvent=t),e===_u&&(this.enableEnterEvent=t),e===wu&&(this.enableLeaveEvent=t)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit(yu,e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit(bu,e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit(_u,e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit(wu,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this._emit(vu,e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const{KEY_EVENTS:Pu}=ou,Su="keydown",Eu="keyup";class Tu extends eu{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:Su,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:Eu,srcEvent:e,key:e.key,target:e.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Pu),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){this.events.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){e===Su&&(this.enableDownEvent=t),e===Eu&&(this.enableUpEvent=t)}}const Cu="contextmenu";class Au extends eu{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{this.options.enable&&this.callback({type:Cu,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===Cu&&(this.options.enable=t)}}const ku={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function Mu(e){const t=ku[e.srcEvent.type];if(!t)return null;const{buttons:n,button:i,which:r}=e.srcEvent;let o=!1,s=!1,a=!1;return 4===t||2===t&&!Number.isFinite(n)?(o=1===r,s=2===r,a=3===r):2===t?(o=Boolean(1&n),s=Boolean(4&n),a=Boolean(2&n)):1===t&&(o=0===i,s=1===i,a=2===i),{leftButton:o,middleButton:s,rightButton:a}}function Lu(e,t){const n=e.center;if(!n)return null;const i=t.getBoundingClientRect(),r=i.width/t.offsetWidth||1,o=i.height/t.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-i.left-t.clientLeft)/r,y:(n.y-i.top-t.clientTop)/o}}}const Ou={srcElement:"root",priority:0};class Ru{constructor(e){this.handleEvent=e=>{if(this.isEmpty())return;const t=this._normalizeEvent(e);let n=e.srcEvent.target;for(;n&&n!==t.rootElement;){if(this._emit(t,n),t.handled)return;n=n.parentNode}this._emit(t,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{handlers:o,handlersByElement:s}=this;let a=Ou;"string"===typeof n||n&&n.addEventListener?a={...Ou,srcElement:n}:n&&(a={...Ou,...n});let l=s.get(a.srcElement);l||(l=[],s.set(a.srcElement,l));const c={type:e,handler:t,srcElement:a.srcElement,priority:a.priority};i&&(c.once=!0),r&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(e,t){const{handlers:n,handlersByElement:i}=this;for(let r=n.length-1;r>=0;r--){const o=n[r];if(o.type===e&&o.handler===t){n.splice(r,1);const e=i.get(o.srcElement);e.splice(e.indexOf(o),1),0===e.length&&i.delete(o.srcElement)}}this._active=n.some((e=>!e.passive))}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let t=!1;const i=()=>{e.handled=!0},r=()=>{e.handled=!0,t=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:l,once:c}=n[s];if(l({...e,type:a,stopPropagation:i,stopImmediatePropagation:r}),c&&o.push(n[s]),t)break}for(let e=0;e<o.length;e++){const{type:t,handler:n}=o[e];this.remove(t,n)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...Mu(e),...Lu(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}const Iu={events:null,recognizers:null,recognizerOptions:{},Manager:$c,touchAction:"none",tabIndex:0};class zu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;this._onBasicInput=e=>{const{srcEvent:t}=e,n=ru[t.type];n&&this.manager.emit(n,e)},this._onOtherEvent=e=>{this.manager.emit(e.type,e)},this.options={...Iu,...t},this.events=new Map,this.setElement(e);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this,n=t.Manager;this.manager=new n(e,{touchAction:t.touchAction,recognizers:t.recognizers||tu}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(nu).forEach((e=>{const t=this.manager.get(e);t&&nu[e].forEach((e=>{t.recognizeWith(e)}))}));for(const i in t.recognizerOptions){const e=this.manager.get(i);if(e){const n=t.recognizerOptions[i];delete n.enable,e.set(n)}}this.wheelInput=new gu(e,this._onOtherEvent,{enable:!1}),this.moveInput=new xu(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Tu(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new Au(e,this._onOtherEvent,{enable:!1});for(const[i,r]of this.events)r.isEmpty()||(this._toggleRecognizer(r.recognizerName,!0),this.manager.on(i,r.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:n}=this;if(!n)return;const i=n.get(e);if(i&&i.options.enable!==t){i.set({enable:t});const r=iu[e];r&&!this.options.recognizers&&r.forEach((r=>{const o=n.get(r);t?(o.requireFailure(e),i.dropRequireFailure(r)):o.dropRequireFailure(e)}))}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,n,i,r){if("string"!==typeof e){n=t;for(const t in e)this._addEventHandler(t,e[t],n,i,r);return}const{manager:o,events:s}=this,a=au[e]||e;let l=s.get(a);l||(l=new Ru(this),s.set(a,l),l.recognizerName=su[a]||a,o&&o.on(a,l.handleEvent)),l.add(e,t,n,i,r),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(e,t){if("string"!==typeof e){for(const t in e)this._removeEventHandler(t,e[t]);return}const{events:n}=this,i=au[e]||e,r=n.get(i);if(r&&(r.remove(e,t),r.isEmpty())){const{recognizerName:e}=r;let t=!1;for(const i of n.values())if(i.recognizerName===e&&!i.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}}function Fu(){}const Du={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Fu,onResize:Fu,onViewStateChange:Fu,onInteractionStateChange:Fu,onBeforeRender:Fu,onAfterRender:Fu,onLoad:Fu,onError:e=>ne.error(e.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:e=>{let{isDragging:t}=e;return t?"grabbing":"grab"},getTooltip:null,debug:!1,drawPickingColors:!1};class ju{constructor(e){I(this,"props",void 0),I(this,"width",0),I(this,"height",0),I(this,"userData",{}),I(this,"canvas",null),I(this,"viewManager",null),I(this,"layerManager",null),I(this,"effectManager",null),I(this,"deckRenderer",null),I(this,"deckPicker",null),I(this,"eventManager",null),I(this,"tooltip",null),I(this,"metrics",void 0),I(this,"animationLoop",void 0),I(this,"stats",void 0),I(this,"viewState",void 0),I(this,"cursorState",void 0),I(this,"_needsRedraw",void 0),I(this,"_pickRequest",void 0),I(this,"_lastPointerDownInfo",null),I(this,"_metricsCounter",void 0),I(this,"_onPointerMove",(e=>{const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const n=e.offsetCenter;if(!n)return;t.x=n.x,t.y=n.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e})),I(this,"_onEvent",(e=>{const t=Dt[e.type],n=e.offsetCenter;if(!t||!n||!this.layerManager)return;const i=this.layerManager.getLayers(),r=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:i,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=r,s=o&&(o[t.handler]||o.props[t.handler]),a=this.props[t.handler];let l=!1;s&&(l=s.call(o,r,e)),!l&&a&&a(r,e)})),I(this,"_onPointerDown",(e=>{const t=e.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:t.x,y:t.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo})),this.props={...Du,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&ne.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===Hc()&&ne.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||"undefined"!==typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new Jn({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&ie.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,t,n,i,r,o,s,a;(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(e=this.layerManager)||void 0===e||e.finalize(),this.layerManager=null,null===(t=this.viewManager)||void 0===t||t.finalize(),this.viewManager=null,null===(n=this.effectManager)||void 0===n||n.finalize(),this.effectManager=null,null===(i=this.deckRenderer)||void 0===i||i.finalize(),this.deckRenderer=null,null===(r=this.deckPicker)||void 0===r||r.finalize(),this.deckPicker=null,null===(o=this.eventManager)||void 0===o||o.destroy(),this.eventManager=null,null===(s=this.tooltip)||void 0===s||s.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas)||(null===(a=this.canvas.parentElement)||void 0===a||a.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&ne.removed("onLayerHover","onHover")(),"onLayerClick"in e&&ne.removed("onLayerClick","onClick")(),e.initialViewState&&!qt(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),r=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||n||i||r||o,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return null!==this.viewManager}getViews(){return Xt(this.viewManager),this.viewManager.views}getViewports(e){return Xt(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,t,n){Xt(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(t).timeStart();const r=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(t).timeEnd(),r}_createCanvas(e){let t=e.canvas;if("string"===typeof t&&(t=document.getElementById(t),Xt(t)),!t){t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay";(e.parent||document.body).appendChild(t)}return Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:n}=e;if(t||0===t){const e=Number.isFinite(t)?"".concat(t,"px"):t;this.canvas.style.width=e}if(n||0===n){var i;const t=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=(null===(i=e.style)||void 0===i?void 0:i.position)||"absolute",this.canvas.style.height=t}}_updateCanvasSize(){var e,t;const{canvas:n}=this;if(!n)return;const i=null!==(e=n.clientWidth)&&void 0!==e?e:n.width,r=null!==(t=n.clientHeight)&&void 0!==t?t:n.height;var o;i===this.width&&r===this.height||(this.width=i,this.height=r,null===(o=this.viewManager)||void 0===o||o.setProps({width:i,height:r}),this.props.onResize({width:i,height:r}))}_createAnimationLoop(e){const{width:t,height:n,gl:i,glOptions:r,debug:o,onError:s,onBeforeRender:a,onAfterRender:l,useDevicePixels:c}=e;return new Yc({width:t,height:n,useDevicePixels:c,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:e=>ms({...r,...e,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:e=>this._setGLContext(e.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:l,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Dl({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:n,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=n.length>0;let r=i,o=!1;for(const s of n){var t;r=s,o=(null===(t=s.layer)||void 0===t?void 0:t.onHover(s,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(r,e.event),this.props.getTooltip&&this.tooltip){const e=this.props.getTooltip(r);this.tooltip.setTooltip(e,r.x,r.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,vs(e,{enable:!0,copyState:!0})),this.tooltip=new _c(this.canvas),as(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new On;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new zu(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in Dt)this.eventManager.on(i,this._onEvent);this.viewManager=new zl({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new Il(e,{deck:this,stats:this.stats,viewport:n,timeline:t}),this.effectManager=new ac,this.deckRenderer=new hc(e),this.deckPicker=new yc(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:n}=this.layerManager.context;as(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...t}),this.props.onAfterRender({gl:n})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),ne.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const n=_s.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}I(ju,"defaultProps",Du),I(ju,"VERSION",Wc);const Nu="undefined"!==typeof window?e.useLayoutEffect:e.useEffect;function Bu(e,t){for(;e;){if(e===t)return!0;e=Object.getPrototypeOf(e)}return!1}class Uu{constructor(e,t){I(this,"opts",void 0),I(this,"source",void 0),this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:n}=this.source,{size:i}=t;let r=n;if(n&&n.length!==i){r=new Float32Array(i);const e=t.elementOffset||0;for(let t=0;t<i;++t)r[t]=n[e+t]}return r}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function Vu(e){return e.stride||e.size*e.bytesPerElement}function Wu(e,t){t.offset&&ne.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Vu(e),i=(void 0!==t.vertexOffset?t.vertexOffset:e.vertexOffset||0)*n+(t.elementOffset||0)*e.bytesPerElement+(e.offset||0);return{...t,offset:i,stride:n}}class Gu{constructor(e,t,n){I(this,"gl",void 0),I(this,"id",void 0),I(this,"size",void 0),I(this,"settings",void 0),I(this,"value",void 0),I(this,"doublePrecision",void 0),I(this,"_buffer",void 0),I(this,"state",void 0),this.gl=e,this.id=t.id||"",this.size=t.size||1;const i=t.logicalType||t.type,r=5130===i;let o,{defaultValue:s}=t;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),o=r?5126:!i&&t.isIndexed?e&&function(e,t){return pa(e,t)}(e,da)?5125:5123:i||5126;let a=function(e){switch(e){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||o||5126);this.doublePrecision=r,r&&!1===t.fp64&&(a=Float32Array),this.value=null,this.settings={...t,defaultType:a,defaultValue:s,logicalType:i,type:o,size:this.size,bytesPerElement:a.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new Vs(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Vu(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),ie.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const n={},i=this.value instanceof Float64Array,r=function(e,t){const n=Wu(e,t);return{high:n,low:{...n,offset:n.offset+4*e.size}}}(this.getAccessor(),t||{});return n[e]=new Uu(this,r.high),n["".concat(e,"64Low")]=i?new Uu(this,r.low):new Float32Array(this.size),n}if(t){const n=Wu(this.getAccessor(),t);return{[e]:new Uu(this,n)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:n,size:i}=this,r=n*i;if(t&&r&&t.length>=r){const n=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let e=0;e<r;)for(let r=0;r<i;r++){const i=t[e++];i<n[r]&&(n[r]=i),i>o[r]&&(o[r]=i)}e=[n,o]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let n;n=ArrayBuffer.isView(e)?{value:e}:e instanceof Vs?{buffer:e}:e;const i={...this.settings,...n};if(t.bufferAccessor=i,t.bounds=null,n.constant){let e=n.value;e=this._normalizeValue(e,[],0),this.settings.normalized&&(e=this.normalizeConstant(e));if(!(!t.constant||!this._areValuesEqual(e,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=e}else if(n.buffer){const e=n.buffer;t.externalBuffer=e,t.constant=!1,this.value=n.value||null;const r=n.value instanceof Float64Array;i.type=n.type||e.accessor.type,i.bytesPerElement=e.accessor.BYTES_PER_ELEMENT*(r?2:1),i.stride=Vu(i)}else if(n.value){this._checkExternalBuffer(n);let e=n.value;t.externalBuffer=null,t.constant=!1,this.value=e,i.bytesPerElement=e.BYTES_PER_ELEMENT,i.stride=Vu(i);const{buffer:r,byteOffset:o}=this;this.doublePrecision&&e instanceof Float64Array&&(e=ke(e,i));const s=e.byteLength+o+2*i.stride;r.byteLength<s&&r.reallocate(s),r.setAccessor(null),r.subData({data:e,offset:o}),i.type=n.type||r.accessor.type}return!0}updateSubBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.bounds=null;const t=this.value,{startOffset:n=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?ke(t,{size:this.size,startIndex:n,endIndex:i}):t.subarray(n,i),offset:n*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{state:n}=this,i=n.allocatedValue,r=ie.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=r;const{buffer:o,byteOffset:s}=this;return o.byteLength<r.byteLength+s&&(o.reallocate(r.byteLength+s),t&&i&&o.subData({data:i instanceof Float64Array?ke(i,this):i,offset:s})),n.allocatedValue=r,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=t.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));t instanceof n||!this.settings.normalized||"normalized"in e||ne.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map((e=>(e+128)/255*2-1));case 5122:return new Float32Array(e).map((e=>(e+32768)/65535*2-1));case 5121:return new Float32Array(e).map((e=>e/255));case 5123:return new Float32Array(e).map((e=>e/65535));default:return e}}_normalizeValue(e,t,n){const{defaultValue:i,size:r}=this.settings;if(Number.isFinite(e))return t[n]=e,t;if(!e){let e=r;for(;--e>=0;)t[n+e]=i[e];return t}switch(r){case 4:t[n+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:t[n+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:t[n+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:t[n+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=r;for(;--o>=0;)t[n+o]=Number.isFinite(e[o])?e[o]:i[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0}}const Hu=[],qu=[];function Xu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,i=Hu;const r={index:-1,data:e,target:[]};return e?"function"===typeof e[Symbol.iterator]?i=e:e.length>0&&(qu.length=e.length,i=qu):i=Hu,(t>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(t,n),r.index=t-1),{iterable:i,objectInfo:r}}function Zu(e){return e&&e[Symbol.asyncIterator]}function Yu(e,t){const{size:n,stride:i,offset:r,startIndices:o,nested:s}=t,a=e.BYTES_PER_ELEMENT,l=i?i/a:n,c=r?r/a:0,u=Math.floor((e.length-c)/l);return(t,i)=>{let{index:r,target:a}=i;if(!o){const t=r*l+c;for(let i=0;i<n;i++)a[i]=e[t+i];return a}const d=o[r],h=o[r+1]||u;let f;if(s){f=new Array(h-d);for(let t=d;t<h;t++){const i=t*l+c;a=new Array(n);for(let t=0;t<n;t++)a[t]=e[i+t];f[t-d]=a}}else if(l===n)f=e.subarray(d*n+c,h*n+c);else{f=new e.constructor((h-d)*n);let t=0;for(let i=d;i<h;i++){const r=i*l+c;for(let i=0;i<n;i++)f[t++]=e[r+i]}}return f}}const Ku=[],Qu=[[0,1/0]];function $u(e){const{source:t,target:n,start:i=0,size:r,getData:o}=e,s=e.end||n.length,a=t.length,l=s-i;if(a>l)return void n.set(t.subarray(0,l),i);if(n.set(t,i),!o)return;let c=a;for(;c<l;){const e=o(c,t);for(let t=0;t<r;t++)n[i+c]=e[t]||0,c++}}const Ju={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function ed(e,t){if(!e)return null;Number.isFinite(e)&&(e={type:"interpolation",duration:e});const n=e.type||"interpolation";return{...Ju[n],...t,...e,type:n}}function td(e,t){const n=t.getBuffer();return n?[n,{divisor:0,size:t.size,normalized:t.settings.normalized}]:t.value}function nd(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(e,'"'))}}function id(e){e.push(e.shift())}function rd(e,t){const{doublePrecision:n,settings:i,value:r,size:o}=e,s=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:t*o)*s}function od(e){let{buffer:t,numInstances:n,attribute:i,fromLength:r,fromStartIndices:o,getData:s=(e=>e)}=e;const a=i.doublePrecision&&i.value instanceof Float64Array?2:1,l=i.size*a,c=i.byteOffset,u=i.startIndices,d=o&&u,h=rd(i,n),f=i.isConstant;if(!d&&r>=h)return;const p=f?i.value:i.getBuffer().getData({srcByteOffset:c});if(i.settings.normalized&&!f){const e=s;s=(t,n)=>i.normalizeConstant(e(t,n))}const g=f?(e,t)=>s(p,t):(e,t)=>s(p.subarray(e,e+l),t),m=t.getData({length:r}),v=new Float32Array(h);!function(e){let{source:t,target:n,size:i,getData:r,sourceStartIndices:o,targetStartIndices:s}=e;if(!Array.isArray(s))return $u({source:t,target:n,size:i,getData:r}),n;let a=0,l=0;const c=r&&((e,t)=>r(e+l,t)),u=Math.min(o.length,s.length);for(let d=1;d<u;d++){const e=o[d]*i,r=s[d]*i;$u({source:t.subarray(a,e),target:n,start:l,end:r,size:i,getData:c}),a=e,l=r}l<n.length&&$u({source:[],target:n,start:l,size:i,getData:c})}({source:m,target:v,sourceStartIndices:o,targetStartIndices:u,size:l,getData:g}),t.byteLength<v.byteLength+c&&t.reallocate(v.byteLength+c),t.subData({data:v,offset:c})}class sd extends Gu{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Qu}),I(this,"constant",!1),this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!==typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,n=this.settings.transition;return ed(Array.isArray(t)?e[t.find((t=>e[t]))]:e[t],n)}setNeedsUpdate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:e=0,endRow:n=1/0}=t;this.state.updateRanges=function(e,t){if(e===Qu)return e;if(t[0]<0&&(t[0]=0),t[0]>=t[1])return e;const n=[],i=e.length;let r=0;for(let o=0;o<i;o++){const i=e[o];i[1]<t[0]?(n.push(i),r=o+1):i[0]>t[1]?n.push(i):t=[Math.min(i[0],t[0]),Math.max(i[1],t[1])]}return n.splice(r,0,t),n}(this.state.updateRanges,[e,n])}else this.state.updateRanges=Qu}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Ku}setNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate(e,t.updateRanges!==Qu),!0))}updateBuffer(e){let{numInstances:t,data:n,props:i,context:r}=e;if(!this.needsUpdate())return!1;const{state:{updateRanges:o},settings:{update:s,noAlloc:a}}=this;let l=!0;if(s){for(const[e,a]of o)s.call(r,this,{data:n,startRow:e,endRow:a,props:i,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of o){const i=Number.isFinite(e)?this.getVertexOffset(e):0,r=Number.isFinite(n)?this.getVertexOffset(n):a||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:i,endOffset:r})}else;this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){if(void 0===e||"function"===typeof e)return!1;return this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{state:n,settings:i}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;n.binaryValue=e,this.setNeedsRedraw();if(i.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const r=e;Xt(ArrayBuffer.isView(r.value),"invalid ".concat(i.accessor));const o=Boolean(r.size)&&r.size!==this.size;return n.binaryAccessor=Yu(r.value,{size:r.size||this.size,stride:r.stride,offset:r.offset,startIndices:t,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const n in e)Object.assign(t,super.getShaderAttributes(n,e[n]));return t}_autoUpdater(e,t){let{data:n,startRow:i,endRow:r,props:o,numInstances:s}=t;if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:d}=e,{accessor:h,transform:f}=a,p=l.binaryAccessor||("function"===typeof h?h:o[h]);Xt("function"===typeof p,'accessor "'.concat(h,'" is not a function'));let g=e.getVertexOffset(i);const{iterable:m,objectInfo:v}=Xu(n,i,r);for(const y of m){v.index++;let t=p(y,v);if(f&&(t=f.call(this,t)),d){const n=(v.index<d.length-1?d[v.index+1]:s)-d[v.index];if(t&&Array.isArray(t[0])){let n=g;for(const i of t)e._normalizeValue(i,c,n),n+=u}else t&&t.length>u?c.set(t,g):(e._normalizeValue(t,v.target,0),Kn({target:c,source:v.target,start:g,count:n}));g+=n*u}else e._normalizeValue(t,c,g),g+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||"function"===typeof e.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let n=!0;switch(t){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const ad="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",ld="#version 300 es\n".concat(ad);function cd(e,t){t=Array.isArray(t)?t:[t];const n=e.replace(/^\s+/,"").split(/\s+/),[i,r,o]=n;if(!t.includes(i)||!r||!o)return null;return{qualifier:i,type:r,name:o.split(";")[0]}}function ud(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:t=100,input:n,inputType:i,output:r}=e;if(!n)return 300===t?ld:t>300?"#version ".concat(t,"\n").concat(ad):"void main() {gl_FragColor = vec4(0);}";const o=function(e,t){switch(t){case"float":return"vec4(".concat(e,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(e,", 0.0, 1.0)");case"vec3":return"vec4(".concat(e,", 1.0)");case"vec4":return e;default:return Lr(!1),null}}(n,i);return t>=300?"#version ".concat(t," ").concat(300===t?"es":"","\nin ").concat(i," ").concat(n,";\nout vec4 ").concat(r,";\nvoid main() {\n  ").concat(r," = ").concat(o,";\n}"):"varying ".concat(i," ").concat(n,";\nvoid main() {\n  gl_FragColor = ").concat(o,";\n}")}class dd extends Ms{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Co(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ko(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Cs(this.buffers)||this.bind((()=>this._unbindBuffers())),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind((()=>{for(const t in e)this.setBuffer(t,e[t])})),this}setBuffer(e,t){const n=this._getVaryingIndex(e),{buffer:i,byteSize:r,byteOffset:o}=this._getBufferParams(t);return n<0?(this.unused[e]=i,xo.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[n]=t,this.bindOnUse||this._bindBuffer(n,i,o,r),this)}begin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,n,i;return e instanceof Vs===!1?(i=e.buffer,n=e.byteSize,t=e.byteOffset):i=e,void 0===t&&void 0===n||(t=t||0,n=n||i.byteLength-t),{buffer:i,byteOffset:t,byteSize:n}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:n,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,i,n)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const r=t&&t.handle;return r&&void 0!==i?this.gl.bindBufferRange(35982,e,r,n,i):this.gl.bindBufferBase(35982,e,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class hd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:i}=t;return{attributes:Object.assign({},n,e.attributes),transformFeedback:i}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],n=e?t[e]:null;return n?n instanceof Vs?n:n.buffer:null}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:t}=e,n=this.getBuffer(t);return n?n.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&ws(Co(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const e=this.feedbackMap[i];i in t&&(n[e]=i)}Object.assign(n,e.feedbackBuffers);for(const i in n){const e=n[i];if("string"===typeof e){const r=t[e],{byteLength:o,usage:s,accessor:a}=r;n[i]=this._createNewBuffer(i,{byteLength:o,usage:s,accessor:a})}}return n}_setupBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const n=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:n})}_setupTransformFeedback(e,t){let{model:n}=t;const{program:i}=n;e.transformFeedback=new dd(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:e,feedbackBuffers:t}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:e,feedbackBuffers:t})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),n=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const r=this.feedbackMap[i];t[i]=e.feedbackBuffers[r],n[r]=e.sourceBuffers[i],ws(n[r]instanceof Vs)}return{sourceBuffers:t,feedbackBuffers:n}}_createNewBuffer(e,t){const n=new Vs(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}function fd(e){let t=100;const n=e.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const e=parseInt(n[1],10);Number.isFinite(e)&&(t=e)}return t}const pd={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},gd="transform_uSampler_",md="transform_uSize_",vd="transform_position";function yd(e){let{vs:t,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=e;let o=Object.keys(n).length,s=null;const a={};let l=t,c={};if(o>0||i){const e=l.split("\n"),t=e.slice();if(e.forEach(((e,r,l)=>{if(o>0){const i=function(e,t){const n={},i=function(e){return cd(e,["attribute","in"])}(e);if(!i)return null;const{type:r,name:o}=i;if(o&&t[o]){const t="// ".concat(e," => Replaced by Transform with a sampler"),{samplerName:i,sizeName:s,uniformDeclerations:a}=function(e){const t="".concat(gd).concat(e),n="".concat(md).concat(e),i="  uniform sampler2D ".concat(t,";\n  uniform vec2 ").concat(n,";");return{samplerName:t,sizeName:n,uniformDeclerations:i}}(o),l=function(e){switch(e){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Lr(!1),null}}(r),c="  ".concat(r," ").concat(o," = transform_getInput(").concat(i,", ").concat(s,").").concat(l,";\n");n[i]=o;return{updatedLine:t,inject:{"vs:#decl":a,"vs:#main-start":c},samplerTextureMap:n}}return null}(e,n);if(i){const{updatedLine:e,inject:n}=i;t[r]=e,c=io([c,n]),Object.assign(a,i.samplerTextureMap),o--}}i&&!s&&(s=function(e,t){const n=cd(e,["varying","out"]);if(!n)return null;return n.name===t?n.type:null}(e,i))})),i){ws(r);const e="".concat(md).concat(i),t="uniform vec2 ".concat(e,";\n"),n="     vec2 ".concat(vd," = transform_getPos(").concat(e,");\n     gl_Position = vec4(").concat(vd,", 0, 1.);\n");c=io([c,{"vs:#decl":t,"vs:#main-start":n}])}l=t.join("\n")}return{vs:l,targetTextureType:s,inject:c,samplerTextureMap:a}}const bd={10241:9728,10240:9728,10242:33071,10243:33071};class _d{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t,sourceTextures:n,framebuffer:i,targetTexture:r}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),s=Object.assign({},e.uniforms),a=Object.assign({},e.parameters);let l=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const t in this.samplerTextureMap){const e=this.samplerTextureMap[t];s[t]=n[e]}this._setSourceTextureParameters();const e=function(e){let{sourceTextureMap:t,targetTextureVarying:n,targetTexture:i}=e;const r={};let o,s;n&&(({width:o,height:s}=i),r["".concat(md).concat(n)]=[o,s]);for(const a in t)({width:o,height:s}=t[a]),r["".concat(md).concat(a)]=[o,s];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r});Object.assign(s,e)}return this.hasTargetTexture&&(l=!1,a.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:s,discard:l,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:t}=this.bindings[this.currentIndex],n=aa(t);if(!e)return n;const i=n.constructor,r=function(e){switch(e){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Lr(!1),null}}(this.targetTextureType),o=new i(n.length*r/4);let s=0;for(let a=0;a<n.length;a+=4)for(let e=0;e<r;e++)o[s++]=n[a+e];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:t,_swapTexture:n}=e;this._swapTexture=n,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:n}=e;if(n instanceof Ks)return n;const i=t[n];return i?(this._targetRefTexName=n,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t,_sourceTextures:n={},_targetTexture:i}=e,r=this._createTargetTexture({sourceTextures:n,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:n,targetTexture:r}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!==typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach(((e,t,n)=>{n[t]=t})),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new Vs(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:e,targetTexture:t}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:e,targetTexture:t})}}_updateBinding(e,t){const{sourceBuffers:n,sourceTextures:i,targetTexture:r}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,n),r){e.targetTexture=r;const{width:t,height:n}=r,{framebuffer:i}=e;i?(i.update({attachments:{36064:r},resizeAttachments:!1}),i.resize({width:t,height:n})):e.framebuffer=new va(this.gl,{id:"transform-framebuffer",width:t,height:n,attachments:{36064:r}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const n in t)t[n].setParameters(bd)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);t[this._swapTexture]=e.targetTexture;return{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=function(e,t){ws(e instanceof Ks||e instanceof ra||e instanceof oa);const n=e.constructor,{gl:i,width:r,height:o,format:s,type:a,dataFormat:l,border:c,mipmaps:u}=e;return new n(i,Object.assign({width:r,height:o,format:s,type:a,dataFormat:l,border:c,mipmaps:u},t))}(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:t,targetTexture:n}=this.bindings[this.currentIndex],{vs:i,uniforms:r,targetTextureType:o,inject:s,samplerTextureMap:a}=yd({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),l=io([e.inject||{},s]);this.targetTextureType=o,this.samplerTextureMap=a;return{vs:i,fs:e._fs||ud({version:fd(i),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[pd].concat(e.modules||[]):e.modules,uniforms:r,inject:l}}}let wd=null;function xd(e,t){var n;return new e((n=e.BYTES_PER_ELEMENT*t,(!wd||wd.byteLength<n)&&(wd=new ArrayBuffer(n)),wd),0,t)}class Pd extends Ms{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||(Co(e)||"Chrome"===Hc())}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Pd(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Pd.MAX_ATTRIBUTES=Pd.MAX_ATTRIBUTES||e.getParameter(34921),Pd.MAX_ATTRIBUTES}static setConstant(e,t,n){switch(n.constructor){case Float32Array:Pd._setConstantFloatArray(e,t,n);break;case Int32Array:Pd._setConstantIntArray(e,t,n);break;case Uint32Array:Pd._setConstantUintArray(e,t,n);break;default:ws(!1)}}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.id||t.program&&t.program.id;super(e,Object.assign({},t,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Pd.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return ws(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind((()=>{this.gl.bindBuffer(34963,e?e.handle:null)})),this}setBuffer(e,t,n){if(34963===t.target)return this.setElementBuffer(t,n);const{size:i,type:r,stride:o,offset:s,normalized:a,integer:l,divisor:c}=n,{gl:u,gl2:d}=this;return e=Number(e),this.bind((()=>{u.bindBuffer(34962,t.handle),l?(ws(Co(u)),d.vertexAttribIPointer(e,i,r,o,s)):u.vertexAttribPointer(e,i,r,a,o,s),u.enableVertexAttribArray(e),d.vertexAttribDivisor(e,c||0)})),this}enable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!t&&0===e&&!Pd.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind((()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e)))),this}getConstantBuffer(e,t){const n=this._normalizeConstantArrayValue(t),i=n.byteLength*e,r=n.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new Vs(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(n,this.bufferValue),o){const e=xd(t.constructor,r);!function(e){let{target:t,source:n,start:i=0,count:r=1}=e;const o=n.length,s=r*o;let a=0;for(let l=i;a<o;a++)t[l++]=n[a];for(;a<s;)a<s-a?(t.copyWithin(i+a,i,i+a),a*=2):(t.copyWithin(i+a,i,i+s-a),a=s)}({target:e,source:n,start:0,count:r}),this.buffer.subData(e),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}static _setConstantFloatArray(e,t,n){switch(n.length){case 1:e.vertexAttrib1fv(t,n);break;case 2:e.vertexAttrib2fv(t,n);break;case 3:e.vertexAttrib3fv(t,n);break;case 4:e.vertexAttrib4fv(t,n);break;default:ws(!1)}}static _setConstantIntArray(e,t,n){switch(ws(Co(e)),n.length){case 1:e.vertexAttribI1iv(t,n);break;case 2:e.vertexAttribI2iv(t,n);break;case 3:e.vertexAttribI3iv(t,n);break;case 4:e.vertexAttribI4iv(t,n);break;default:ws(!1)}}static _setConstantUintArray(e,t,n){switch(ws(Co(e)),n.length){case 1:e.vertexAttribI1uiv(t,n);break;case 2:e.vertexAttribI2uiv(t,n);break;case 3:e.vertexAttribI3uiv(t,n);break;case 4:e.vertexAttribI4uiv(t,n);break;default:ws(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,t){let{location:n}=t;return ws(Number.isFinite(n)),this.bind((()=>34373===e?this.gl.getVertexAttribOffset(n,e):this.gl.getVertexAttrib(n,e)))}}const Sd=/^(.+)__LOCATION_([0-9]+)$/,Ed=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Td{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.id||t.program&&t.program.id;this.id=n,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Pd(e),As(this,"VertexArray","v6.0",Ed),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind((()=>{for(const t in e){const n=e[t];this._setAttribute(t,n)}this.gl.bindBuffer(34962,null)})),this}setElementBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===t.target)return this.setElementBuffer(t,n);const{location:i,accessor:r}=this._resolveLocationAndAccessor(e,t,t.accessor,n);return i>=0&&(this.values[i]=t,this.accessors[i]=r,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,t,r)),this}setConstant(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:i,accessor:r}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},n));return i>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[i]=t,this.accessors[i]=r,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Vs(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Vs&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))})),this}bindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof Vs&&this.setBuffer(e,t)}})),this}bindForDraw(e,t,n){let i;return this.vertexArrayObject.bind((()=>{this._setConstantAttributes(e,t),i=n()})),i}_resolveLocationAndAccessor(e,t,n,i){const r={location:-1,accessor:null},{location:o,name:s}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,xo.once(3,(()=>"unused value ".concat(e," in ").concat(this.id)))(),r;const a=this._getAttributeInfo(s||o);if(!a)return r;const l=this.accessors[o]||{},c=js.resolve(a.accessor,l,n,i),{size:u,type:d}=c;return ws(Number.isFinite(u)&&Number.isFinite(d)),{location:o,accessor:c}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const n=Sd.exec(e),i=n?n[1]:e,r=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+r,name:i}:{location:-1}}_setAttribute(e,t){if(t instanceof Vs)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof Vs){const n=t[0],i=t[1];this.setBuffer(e,n,i)}else if(ArrayBuffer.isView(t)||Array.isArray(t)){const n=t;this.setConstant(e,n)}else{if(!(t.buffer instanceof Vs))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const n=t;this.setBuffer(e,n.buffer,n)}}}_setConstantAttributes(e,t){const n=Math.max(0|e,0|t);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,n);for(let r=1;r<this.vertexArrayObject.MAX_ATTRIBUTES;r++)i=this.values[r],ArrayBuffer.isView(i)&&this._setConstantAttribute(r,i)}_setConstantAttributeZero(e,t){if(Pd.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const n=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(e,t){Pd.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const n=this.values[t],i=this.accessors[t];if(!n)return;const{divisor:r}=i,o=r>0;if(e.isInstanced=e.isInstanced||o,n instanceof Vs){const t=n;if(o){const n=t.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,n)}else{const n=t.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,n)}}}setElements(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return xo.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function Cd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{isInteger:n=!1}=t;if(Array.isArray(e)||ArrayBuffer.isView(e))return function(e,t){const{maxElts:n=16,size:i=1}=t;let r="[";for(let s=0;s<e.length&&s<n;++s)s>0&&(r+=",".concat(s%i===0?" ":"")),r+=Cd(e[s],t);const o=e.length>n?"...":"]";return"".concat(r).concat(o)}(e,t);if(!Number.isFinite(e))return String(e);if(Math.abs(e)<1e-16)return n?"0":"0.";if(n)return e.toFixed(0);if(Math.abs(e)>100&&Math.abs(e)<1e4)return e.toFixed(0);const i=e.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function Ad(e,t,n,i){const{gl:r}=e;if(!t)return{[i]:"null","Format ":"N/A"};let o,s,a,l="NOT PROVIDED",c=1,u=0,d=0;if(n&&(l=n.type,c=n.size,l=String(l).replace("Array",""),o=-1!==l.indexOf("nt")),t instanceof Vs){const e=t,{data:h,changed:f}=e.getDebugData();let p;if(s=f?"*":"",a=h,d=e.byteLength,u=d/h.BYTES_PER_ELEMENT/c,n){const e=n.divisor>0;p="".concat(e?"I ":"P "," ").concat(u," (x").concat(c,"=").concat(d," bytes ").concat(Ps(r,l),")")}else o=!0,p="".concat(d," bytes");return{[i]:"".concat(s).concat(Cd(a,{size:c,isInteger:o})),"Format ":p}}return a=t,c=t.length,l=String(t.constructor.name).replace("Array",""),o=-1!==l.indexOf("nt"),{[i]:"".concat(Cd(a,{size:c,isInteger:o})," (constant)"),"Format ":"".concat(c,"x").concat(l," (constant)")}}function kd(e,t){const{type:n,size:i}=t,r=al(n,i);return r?"".concat(e," (").concat(r.name,")"):e}function Md(e){let{header:t="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=e;ws(n);const o=".*Matrix",s=n._uniformSetters,a={},l=Object.keys(s).sort();let c=0;for(const h of l)h.match(".*_.*")||h.match(o)||Ld({table:a,header:t,uniforms:i,uniformName:h,undefinedOnly:r})&&c++;for(const h of l)h.match(o)&&Ld({table:a,header:t,uniforms:i,uniformName:h,undefinedOnly:r})&&c++;for(const h of l)a[h]||Ld({table:a,header:t,uniforms:i,uniformName:h,undefinedOnly:r})&&c++;let u=0;const d={};if(!r)for(const h in i){const e=i[h];a[h]||(u++,d[h]={Type:"NOT USED: ".concat(e),[t]:Cd(e)})}return{table:a,count:c,unusedTable:d,unusedCount:u}}function Ld(e){let{table:t,header:n,uniforms:i,uniformName:r,undefinedOnly:o}=e;const s=i[r],a=function(e){return void 0!==e&&null!==e}(s);return(!o||!a)&&(t[r]={[n]:a?Cd(s):"N/A","Uniform Type":a?s:"NOT PROVIDED"},!0)}function Od(e){const{type:t,size:n}=e.accessor,i=al(t,n);return i?"".concat(i.name," ").concat(e.name):e.name}const Rd={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Id(e,t){const{attributeMap:n=Rd}=t||{};return n&&n[e]||e}function zd(e,t){let n;switch(e){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":t.size=t.size||3;break;case"uvs":t.size=t.size||2}ws(Number.isFinite(t.size),"attribute ".concat(e," needs size"))}const Fd=()=>{},Dd={};class jd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:n=Es("model")}=t;ws(To(e)),this.id=n,this.gl=e,this.id=t.id||Es("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||hl.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c}=e;this.programProps={program:t,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},ws(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c}=e;this.programProps={program:t,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return ws(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return ws(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(e,t,n){const i={};let r=t.indices;for(const o in t.attributes){const s=t.attributes[o],a=Id(o,n);if("indices"===o)r=s;else if(s.constant)i[a]=s.value;else{const t=s.value,n={...s};delete n.value,i[a]=[new Vs(e,t),n],zd(o,n)}}if(r){const t=r.value||r;ws(t instanceof Uint16Array||t instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new Vs(e,{data:t,target:34963}),n]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Cs(e))return this;const t={};for(const n in e){const i=e[n];t[n]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(t),this}setUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return na(this.program.gl,e),this}draw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:t=null,framebuffer:n,uniforms:i={},attributes:r={},transformFeedback:o=this.transformFeedback,parameters:s={},vertexArray:a=this.vertexArray}=e;let l;this.setAttributes(r),this.updateModuleSettings(t),this.setUniforms(i),xo.priority>=2&&(l=this._logDrawCallStart(2));const c=this.vertexArray.getDrawParams(),{isIndexed:u=c.isIndexed,indexType:d=c.indexType,indexOffset:h=c.indexOffset,vertexArrayInstanced:f=c.isInstanced}=this.props;f&&!this.isInstanced&&xo.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:p,instanceCount:g}=this,{onBeforeRender:m=Fd,onAfterRender:v=Fd}=this.props;m(),this.program.setUniforms(this.uniforms);const y=this.program.draw(Object.assign(Dd,e,{logPriority:l,uniforms:null,framebuffer:n,parameters:s,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:a,transformFeedback:o,isIndexed:u,indexType:d,isInstanced:p,instanceCount:g,offset:u?h:0}));return v(),xo.priority>=2&&this._logDrawCallEnd(l,a,n),y}transform(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:t=!0,feedbackBuffers:n,unbindModels:i=[]}=e;let{parameters:r}=e;n&&this._setFeedbackBuffers(n),t&&(r=Object.assign({},r,{35977:t})),i.forEach((e=>e.vertexArray.unbindBuffers()));try{this.draw(Object.assign({},e,{parameters:r}))}finally{i.forEach((e=>e.vertexArray.bindBuffers()))}return this}render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return xo.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:e}=this.programProps;if(e)this._managedProgram=!1;else{const{vs:t,fs:n,modules:i,inject:r,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}=this.programProps;e=this.programManager.get({vs:t,fs:n,modules:i,inject:r,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}ws(e instanceof dl,"Model needs a program"),this._programDirty=!1,e!==this.program&&(this.program=e,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Td(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof Vs&&t.delete()}}_setAnimationProps(e){this.animated&&ws(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Cs(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new dd(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),xo.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:xo.level<=2})(),e}_logDrawCallEnd(e,t,n,i){if(void 0===e)return;const r=function(e){let{vertexArray:t,header:n="Attributes"}=e;if(!t.configuration)return{};const i={};t.elements&&(i.ELEMENT_ARRAY_BUFFER=Ad(t,t.elements,null,n));const r=t.values;for(const o in r){const e=t._getAttributeInfo(o);if(e){let s="".concat(o,": ").concat(e.name);const a=t.accessors[e.location];a&&(s="".concat(o,": ").concat(kd(e.name,a))),i[s]=Ad(t,r[o],a,n)}}return i}({vertexArray:t,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:s,unusedCount:a}=Md({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:l,count:c}=Md({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});c>0&&xo.log("MISSING UNIFORMS",Object.keys(l))(),a>0&&xo.log("UNUSED UNIFORMS",Object.keys(s))();const u=function(e){const t={},n="Accessors for ".concat(e.id);for(const i of e.attributeInfos)if(i){const e=Od(i);t["in ".concat(e)]={[n]:JSON.stringify(i.accessor)}}for(const i of e.varyingInfos)if(i){const e=Od(i);t["out ".concat(e)]={[n]:JSON.stringify(i.accessor)}}return t}(this.vertexArray.configuration);xo.table(e,r)(),xo.table(e,o)(),xo.table(e+1,u)(),i&&i.log({logLevel:2,message:"Rendered to ".concat(i.id)}),xo.groupEnd(2)()}}class Nd{static isSupported(e){return Co(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:n}=this;e&&e.delete(),t&&t.delete(),n&&n.delete()}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:t=!0}=e,n=this._updateDrawOptions(e);t&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t)e=e||n.swap();ws(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t){const t=n.getData(e);if(t)return t}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t)n.update(e)}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new jd(t,Object.assign({},e,{fs:e.fs||ud({version:fd(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)t=i.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(e){if(!Cs(e.feedbackBuffers)||!Cs(e.feedbackMap)||e.varyings&&e.varyings.length>0)return!0;return!1})(t)&&(this.bufferTransform=new hd(e,t)),function(e){if(!Cs(e._sourceTextures)||e._targetTexture||e._targetTextureVarying)return!0;return!1}(t)&&(this.textureTransform=new _d(e,t)),ws(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)t=Object.assign(t,i.getDrawOptions(t));return t}}const Bd="\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n";const Ud={interpolation:class{constructor(e){let{gl:t,attribute:n,timeline:i}=e;I(this,"gl",void 0),I(this,"type","interpolation"),I(this,"attributeInTransition",void 0),I(this,"settings",void 0),I(this,"attribute",void 0),I(this,"transition",void 0),I(this,"currentStartIndices",void 0),I(this,"currentLength",void 0),I(this,"transform",void 0),I(this,"buffers",void 0),this.gl=t,this.transition=new nn(i),this.attribute=n,this.attributeInTransition=new sd(t,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=function(e,t){const n=nd(t.size);return new Nd(e,{vs:Bd,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(t,n);const r={byteLength:0,usage:35050};this.buffers=[new Vs(t,r),new Vs(t,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();this.settings=e;const{gl:n,buffers:i,attribute:r}=this;id(i);const o={numInstances:t,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const s of i)od({buffer:s,...o});this.currentStartIndices=r.startIndices,this.currentLength=rd(r,t),this.attributeInTransition.setData({buffer:i[1],value:r.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aFrom:i[0],aTo:td(0,r)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:e,easing:t}=this.settings,{time:n}=this.transition;let i=n/e;t&&(i=t(i)),this.transform.run({uniforms:{time:i}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}},spring:class{constructor(e){let{gl:t,attribute:n,timeline:i}=e;I(this,"gl",void 0),I(this,"type","spring"),I(this,"attributeInTransition",void 0),I(this,"settings",void 0),I(this,"attribute",void 0),I(this,"transition",void 0),I(this,"currentStartIndices",void 0),I(this,"currentLength",void 0),I(this,"texture",void 0),I(this,"framebuffer",void 0),I(this,"transform",void 0),I(this,"buffers",void 0),this.gl=t,this.type="spring",this.transition=new nn(i),this.attribute=n,this.attributeInTransition=new sd(t,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=function(e){return new Ks(e,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function(e,t){return new va(e,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:t}})}(t,this.texture),this.transform=function(e,t,n){const i=nd(t.size);return new Nd(e,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(t,n,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new Vs(t,r),new Vs(t,r),new Vs(t,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{gl:n,buffers:i,attribute:r}=this,o={numInstances:t,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const s of i)od({buffer:s,...o});this.settings=e,this.currentStartIndices=r.startIndices,this.currentLength=rd(r,t),this.attributeInTransition.setData({buffer:i[1],value:r.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aTo:td(0,r)}})}update(){const{buffers:e,transform:t,framebuffer:n,transition:i}=this;if(!i.update())return!1;const r=this.settings;t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.stiffness,damping:r.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),id(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value});return aa(n)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class Vd{constructor(e,t){let{id:n,timeline:i}=t;I(this,"id",void 0),I(this,"isSupported",void 0),I(this,"gl",void 0),I(this,"timeline",void 0),I(this,"transitions",void 0),I(this,"needsRedraw",void 0),I(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Nd.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update(e){let{attributes:t,transitions:n,numInstances:i}=e;this.numInstances=i||1;for(const r in t){const e=t[r],i=e.getTransitionSetting(n);i&&this._updateAttribute(r,e,i)}for(const r in this.transitions){const e=t[r];e&&e.getTransitionSetting(n)||this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const n=this.transitions[t];n.inProgress&&(e[t]=n.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions){this.transitions[t].update()&&(this.needsRedraw=!0)}const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,n){const i=this.transitions[e];let r=!i||i.type!==n.type;if(r){if(!this.isSupported)return void ne.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();i&&this._removeTransition(e);const o=Ud[n.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(ne.error("unsupported transition type '".concat(n.type,"'"))(),r=!1)}(r||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const Wd="attributeManager.invalidate";class Gd{constructor(e){let{id:t="attribute-manager",stats:n,timeline:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};I(this,"id",void 0),I(this,"gl",void 0),I(this,"attributes",void 0),I(this,"updateTriggers",void 0),I(this,"needsRedraw",void 0),I(this,"userData",void 0),I(this,"stats",void 0),I(this,"attributeTransitionManager",void 0),I(this,"mergeBoundsMemoized",wl(Me)),this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new Vd(e,{id:"".concat(t,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const t of e)void 0!==this.attributes[t]&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const n=this._invalidateTrigger(e,t);Xn(Wd,this,e,n)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);Xn(Wd,this,"all")}update(e){let{data:t,numInstances:n,startIndices:i=null,transitions:r,props:o={},buffers:s={},context:a={}}=e,l=!1;Xn("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const e=this.attributes[c],r=e.settings.accessor;e.startIndices=i,e.numInstances=n,o[c]&&ne.removed("props.".concat(c),"data.attributes.".concat(c))(),e.setExternalBuffer(s[c])||e.setBinaryValue("string"===typeof r?s[r]:void 0,t.startIndices)||"string"===typeof r&&!s[r]&&e.setConstantValue(o[r])||e.needsUpdate()&&(l=!0,this._updateAttribute({attribute:e,numInstances:n,data:t,props:o,context:a})),this.needsRedraw=this.needsRedraw||e.needsRedraw()}l&&Xn("attributeManager.updateEnd",this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getBounds(e){const t=e.map((e=>{var t;return null===(t=this.attributes[e])||void 0===t?void 0:t.getBounds()}));return this.mergeBoundsMemoized(t)}getChangedAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearChangedFlags:!1};const{attributes:t,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const r in t){const o=t[r];o.needsRedraw(e)&&!n.hasAttribute(r)&&(i[r]=o)}return i}getShaderAttributes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e||(e=this.getAttributes());const n={};for(const i in e)t[i]||Object.assign(n,e[i].getShaderAttributes());return n}_add(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(const n in e){const i=e[n];this.attributes[n]=this._createAttribute(n,i,t)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,n){const i={...t,id:e,size:(t.isIndexed?1:t.size)||1,divisor:n.instanced?1:t.divisor||0};return new sd(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes){this.attributes[t].getUpdateTriggers().forEach((n=>{e[n]||(e[n]=[]),e[n].push(t)}))}this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:n,updateTriggers:i}=this,r=i[e];return r&&r.forEach((e=>{const i=n[e];i&&i.setNeedsUpdate(i.id,t)})),r}_updateAttribute(e){const{attribute:t,numInstances:n}=e;if(Xn("attribute.updateStart",t),t.constant)return void t.setConstantValue(t.value);t.allocate(n)&&Xn("attribute.allocate",t,n);t.updateBuffer(e)&&(this.needsRedraw=!0,Xn("attribute.updateEnd",t,n))}}const Hd=1e-5;function qd(e,t,n,i,r){const o=t-e;return(n-t)*r+-o*i+o+t}function Xd(e,t){if(Array.isArray(e)){let n=0;for(let i=0;i<e.length;i++){const r=e[i]-t[i];n+=r*r}return Math.sqrt(n)}return Math.abs(e-t)}const Zd={interpolation:class extends nn{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:n,duration:i,easing:r}}=this,o=r(e/i);this._value=le(t,n,o)}},spring:class extends nn{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:n,stiffness:i}=this.settings,{_prevValue:r=e,_currValue:o=e}=this;let s=function(e,t,n,i,r){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=qd(e[s],t[s],n[s],i,r);return o}return qd(e,t,n,i,r)}(r,o,t,n,i);const a=Xd(s,t),l=Xd(s,o);a<Hd&&l<Hd&&(s=t,this.end()),this._prevValue=o,this._currValue=s}}};class Yd{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,n,i){const{transitions:r}=this;if(r.has(e)){const n=r.get(e),{value:i=n.settings.fromValue}=n;t=i,this.remove(e)}if(!(i=ed(i)))return;const o=Zd[i.type];if(!o)return void ne.error("unsupported transition type '".concat(i.type,"'"))();const s=new o(this.timeline);s.start({...i,fromValue:t,toValue:n}),r.set(e,s)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,n]of this.transitions)n.update(),e[t]=n.value,n.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Kd(e,t){const n=$d({newProps:e,oldProps:t,propTypes:e[Bn],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(e,t){if(null===t)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=e;i?i(e.data,t.data)||(n="Data comparator detected a change"):e.data!==t.data&&(n="A new data container was supplied");n&&r&&(n=r(e.data,t.data)||n);return n}(e,t);let r=!1;return i||(r=function(e,t){if(null===t)return{all:!0};if("all"in e.updateTriggers){if(th(e,t,"all"))return{all:!0}}const n={};let i=!1;for(const r in e.updateTriggers)if("all"!==r){th(e,t,r)&&(n[r]=!0,i=!0)}return!!i&&n}(e,t)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:eh(e,t),transitionsChanged:Qd(e,t)}}function Qd(e,t){if(!e.transitions)return!1;const n={},i=e[Bn];let r=!1;for(const o in e.transitions){const s=i[o],a=s&&s.type;("number"===a||"color"===a||"array"===a)&&Jd(e[o],t[o],s)&&(n[o]=!0,r=!0)}return!!r&&n}function $d(e){let{newProps:t,oldProps:n,ignoreProps:i={},propTypes:r={},triggerName:o="props"}=e;if(n===t)return!1;if("object"!==typeof t||null===t)return"".concat(o," changed shallowly");if("object"!==typeof n||null===n)return"".concat(o," changed shallowly");for(const s of Object.keys(t))if(!(s in i)){if(!(s in n))return"".concat(o,".").concat(s," added");const e=Jd(t[s],n[s],r[s]);if(e)return"".concat(o,".").concat(s," ").concat(e)}for(const s of Object.keys(n))if(!(s in i)){if(!(s in t))return"".concat(o,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const e=Jd(t[s],n[s],r[s]);if(e)return"".concat(o,".").concat(s," ").concat(e)}}return!1}function Jd(e,t,n){let i=n&&n.equal;return i&&!i(e,t,n)?"changed deeply":i||(i=e&&t&&e.equals,!i||i.call(e,t))?i||t===e?null:"changed shallowly":"changed deeply"}function eh(e,t){if(null===t)return!0;const n=t.extensions,{extensions:i}=e;if(i===n)return!1;if(!n||!i)return!0;if(i.length!==n.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(n[r]))return!0;return!1}function th(e,t,n){let i=e.updateTriggers[n];i=void 0===i||null===i?{}:i;let r=t.updateTriggers[n];r=void 0===r||null===r?{}:r;return $d({oldProps:r,newProps:i,triggerName:n})}function nh(e){if(null===(t=e)||"object"!==typeof t)throw new Error("count(): argument not an object");var t;if("function"===typeof e.count)return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(function(e){return null!==e&&"object"===typeof e&&e.constructor===Object}(e))return Object.keys(e).length;throw new Error("count(): argument not a container")}function ih(e,t){if(!t)return e;const n={...e,...t};if("defines"in t&&(n.defines={...e.defines,...t.defines}),"modules"in t&&(n.modules=(e.modules||[]).concat(t.modules),t.modules.some((e=>"project64"===e.name)))){const e=n.modules.findIndex((e=>"project32"===e.name));e>=0&&n.modules.splice(e,1)}if("inject"in t)if(e.inject){const i={...e.inject};for(const e in t.inject)i[e]=(i[e]||"")+t.inject[e];n.inject=i}else n.inject=t.inject;return n}const rh=[0,0,0];function oh(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=t.projectPosition(e);if(n&&t instanceof Fl){const[n,r,o=0]=e,s=t.getDistanceScales([n,r]);i[2]=o*s.unitsPerMeter[2]}return i}function sh(e,t){let{viewport:n,modelMatrix:i,coordinateSystem:r,coordinateOrigin:o,offsetMode:s}=t,[a,l,c=0]=e;switch(i&&([a,l,c]=He([],[a,l,c,1],i)),r){case It.LNGLAT:return oh([a,l,c],n,s);case It.LNGLAT_OFFSETS:return oh([a+o[0],l+o[1],c+(o[2]||0)],n,s);case It.METER_OFFSETS:return oh(wt(o,[a,l,c]),n,s);case It.CARTESIAN:default:return n.isGeospatial?[a+o[0],l+o[1],c+o[2]]:n.projectPosition([a,l,c])}}function ah(e,t){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=function(e){const{viewport:t,modelMatrix:n,coordinateOrigin:i}=e;let{coordinateSystem:r,fromCoordinateSystem:o,fromCoordinateOrigin:s}=e;return r===It.DEFAULT&&(r=t.isGeospatial?It.LNGLAT:It.CARTESIAN),void 0===o&&(o=r),void 0===s&&(s=i),{viewport:t,coordinateSystem:r,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:o,fromCoordinateOrigin:s}}(t),{autoOffset:l=!0}=t,{geospatialOrigin:c=rh,shaderCoordinateOrigin:u=rh,offsetMode:d=!1}=l?Al(n,i,r):{},h=sh(e,{viewport:n,modelMatrix:o,coordinateSystem:s,coordinateOrigin:a,offsetMode:d});if(d){const e=n.projectPosition(c||u);be(h,h,e)}return h}const lh={10241:9987,10240:9729,10242:33071,10243:33071},ch={};const uh={boolean:{validate:(e,t)=>!0,equal:(e,t,n)=>Boolean(e)===Boolean(t)},number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},color:{validate:(e,t)=>t.optional&&!e||fh(e)&&(3===e.length||4===e.length),equal:(e,t,n)=>qt(e,t,1)},accessor:{validate(e,t){const n=ph(e);return"function"===n||n===ph(t.value)},equal:(e,t,n)=>"function"===typeof t||qt(e,t,1)},array:{validate:(e,t)=>t.optional&&!e||fh(e),equal(e,t,n){const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?qt(e,t,r):e===t}},object:{equal(e,t,n){if(n.ignore)return!0;const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?qt(e,t,r):e===t}},function:{validate:(e,t)=>t.optional&&!e||"function"===typeof e,equal:(e,t,n)=>!n.compare&&!1!==n.ignore||e===t},data:{transform:(e,t,n)=>{const{dataTransform:i}=n.props;return i&&e?i(e):e}},image:{transform:(e,t,n)=>{const i=n.context;return i&&i.gl?function(e,t,n,i){if(n instanceof Ks)return n;n.constructor&&"Object"!==n.constructor.name&&(n={data:n});let r=null;n.compressed&&(r={10241:n.data.length>1?9985:9729});const o=new Ks(t,{...n,parameters:{...lh,...r,...i}});return ch[o.id]=e,o}(n.id,i.gl,e,{...t.parameters,...n.props.textureParameters}):null},release:(e,t,n)=>{var i,r;i=n.id,(r=e)&&r instanceof Ks&&ch[r.id]===i&&(r.delete(),delete ch[r.id])}}};function dh(e,t){switch(ph(t)){case"object":return hh(e,t);case"array":return hh(e,{type:"array",value:t,compare:!1});case"boolean":return hh(e,{type:"boolean",value:t});case"number":return hh(e,{type:"number",value:t});case"function":return hh(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function hh(e,t){return"type"in t?{name:e,...uh[t.type],...t}:"value"in t?{name:e,type:ph(t.value),...t}:{name:e,type:"object",value:t}}function fh(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function ph(e){return fh(e)?"array":null===e?"null":typeof e}const gh="_mergedDefaultProps";function mh(e,t){let n=gh;if(t)for(const r of t){const e=r.constructor;e&&(n+=":".concat(e.extensionName||e.name))}const i=bh(e,n);return i||(e[n]=function(e,t){const n=e.prototype;if(!n)return null;const i=Object.getPrototypeOf(e),r=mh(i),o=bh(e,"defaultProps")||{},s=function(e){const t={},n={},i={};for(const[r,o]of Object.entries(e)){const e=null===o||void 0===o?void 0:o.deprecatedFor;if(e)i[r]=Array.isArray(e)?e:[e];else{const e=dh(r,o);t[r]=e,n[r]=e.value}}return{propTypes:t,defaultProps:n,deprecatedProps:i}}(o),a=Object.assign(Object.create(null),r,s.defaultProps),l=Object.assign(Object.create(null),null===r||void 0===r?void 0:r[Bn],s.propTypes),c=Object.assign(Object.create(null),null===r||void 0===r?void 0:r[Un],s.deprecatedProps);for(const u of t){const e=mh(u.constructor);e&&(Object.assign(a,e),Object.assign(l,e[Bn]),Object.assign(c,e[Un]))}(function(e,t){const n=function(e){const t=e.componentName;t||ne.warn("".concat(e.name,".componentName not specified"))();return t||e.name}(t);Object.defineProperties(e,{id:{writable:!0,value:n}})})(a,e),function(e,t){const n={},i={};for(const r in t){const e=t[r],{name:o,value:s}=e;e.async&&(n[o]=s,i[o]=vh(o))}e[Vn]=n,e[Wn]={},Object.defineProperties(e,i)}(a,l),function(e,t){for(const n in t)Object.defineProperty(e,n,{enumerable:!1,set(e){const i="".concat(this.id,": ").concat(n);for(const r of t[n])yh(this,r)||(this[r]=e);ne.deprecated(i,t[n].join("/"))()}})}(a,c),a[Bn]=l,a[Un]=c,0!==t.length||yh(e,"_propTypes")||(e._propTypes=l);return a}(e,t||[]))}function vh(e){return{enumerable:!0,set(t){"string"===typeof t||t instanceof Promise||Zu(t)?this[Wn][e]=t:this[Gn][e]=t},get(){if(this[Gn]){if(e in this[Gn]){return this[Gn][e]||this[Vn][e]}if(e in this[Wn]){const t=this[Nn]&&this[Nn].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[Vn][e]}}return this[Vn][e]}}}function yh(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function bh(e,t){return yh(e,t)&&e[t]}let _h=0;class wh{constructor(){I(this,"id",void 0),I(this,"props",void 0),I(this,"count",void 0);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.props=function(e,t){let n;for(let o=t.length-1;o>=0;o--){const e=t[o];"extensions"in e&&(n=e.extensions)}const i=mh(e.constructor,n),r=Object.create(i);r[Nn]=e,r[Wn]={},r[Gn]={};for(let o=0;o<t.length;++o){const e=t[o];for(const t in e)r[t]=e[t]}return Object.freeze(r),r}(this,t),this.id=this.props.id,this.count=_h++}clone(e){const{props:t}=this,n={};for(const i in t[Vn])i in t[Gn]?n[i]=t[Gn][i]:i in t[Wn]&&(n[i]=t[Wn][i]);return new this.constructor({...t,...n,...e})}}I(wh,"componentName","Component"),I(wh,"defaultProps",{});const xh=Object.freeze({});class Ph{constructor(e){I(this,"component",void 0),I(this,"onAsyncPropUpdated",void 0),I(this,"asyncProps",void 0),I(this,"oldProps",void 0),I(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||xh}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[Nn]||this.component;const t=e[Gn]||{},n=e[Wn]||e,i=e[Vn]||{};for(const r in t){const e=t[r];this._createAsyncPropData(r,i[r]),this._updateAsyncProp(r,e),t[r]=this.getAsyncProp(r)}for(const r in n){const e=n[r];this._createAsyncPropData(r,i[r]),this._updateAsyncProp(r,e)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){this._didAsyncInputValueChange(e,t)&&("string"===typeof t&&(t=this._fetch(e,t)),t instanceof Promise?this._watchPromise(e,t):Zu(t)?this._resolveAsyncIterable(e,t):this._setPropValue(e,t))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const n=this.asyncProps[e];return t!==n.resolvedValue&&t!==n.lastValue&&(n.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(t=this._postProcessValue(n,t),n.resolvedValue=t,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,t,n){const i=this.asyncProps[e];i&&n>=i.resolvedLoadCount&&void 0!==t&&(this._freezeAsyncOldProps(),i.resolvedValue=t,i.resolvedLoadCount=n,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;t.then((t=>{this.component&&(t=this._postProcessValue(n,t),this._setAsyncPropValue(e,t,i),this._onResolve(e,t))})).catch((t=>{this._onError(e,t)}))}}async _resolveAsyncIterable(e,t){if("data"!==e)return void this._setPropValue(e,t);const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let r=[],o=0;for await(const s of t){if(!this.component)return;const{dataTransform:t}=this.component.props;r=t?t(s,r):r.concat(s),Object.defineProperty(r,"__diff",{enumerable:!1,value:[{startRow:o,endRow:r.length}]}),o=r.length,this._setAsyncPropValue(e,r,i)}this._onResolve(e,r)}_postProcessValue(e,t){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(t,n,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const n=this.component&&this.component.props[Bn];this.asyncProps[e]={type:n&&n[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class Sh extends Ph{constructor(e){let{attributeManager:t,layer:n}=e;super(n),I(this,"attributeManager",void 0),I(this,"needsRedraw",void 0),I(this,"needsUpdate",void 0),I(this,"subLayers",void 0),I(this,"usesPickingColorCache",void 0),I(this,"hasPickingBuffer",void 0),I(this,"changeFlags",void 0),I(this,"viewport",void 0),I(this,"uniformTransitions",void 0),I(this,"propsInTransition",void 0),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const n=this.layer,i=null===n||void 0===n?void 0:n.props.fetch;return i?i(t,{propName:e,layer:n}):super._fetch(e,t)}_onResolve(e,t){const n=this.layer;if(n){const i=n.props.onDataLoad;"data"===e&&i&&i(t,{propName:e,layer:n})}}_onError(e,t){const n=this.layer;n&&n.raiseError(t,"loading ".concat(e," of ").concat(this.layer))}}const Eh=2**24-1,Th=Object.freeze([]),Ch=wl((e=>{let{oldViewport:t,viewport:n}=e;return t.equals(n)}));let Ah=new Uint8ClampedArray(0);const kh={data:{type:"data",value:Th,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:e=>e&&e.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(e,t)=>{let{propName:n,layer:i,loaders:r,loadOptions:o,signal:s}=t;const{resourceManager:a}=i.context;var l;(o=o||i.getLoadOptions(),r=r||i.props.loaders,s)&&(o={...o,fetch:{...null===(l=o)||void 0===l?void 0:l.fetch,signal:s}});let c=a.contains(e);return c||o||(a.add({resourceId:e,data:Tr(e,r),persistent:!1}),c=!0),c?a.subscribe({resourceId:e,onChange:e=>{var t;return null===(t=i.internalState)||void 0===t?void 0:t.reloadAsyncProp(n,e)},consumerId:i.id,requestId:n}):Tr(e,r,o)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:It.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:e=>{let{layerIndex:t}=e;return[0,100*-t]}},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Mh extends wh{constructor(){super(...arguments),I(this,"internalState",null),I(this,"lifecycle",Rn),I(this,"context",void 0),I(this,"state",void 0),I(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Xt(this.internalState);const t=this.internalState.viewport||this.context.viewport,n=sh(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,r,o]=Et(n,t.pixelProjectionMatrix);return 2===e.length?[i,r]:[i,r,o]}unproject(e){Xt(this.internalState);return(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){Xt(this.internalState);return ah(e,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const t of this.getModels())t.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===It.DEFAULT||e===It.LNGLAT||e===It.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){Xt(e instanceof Uint8Array);const[t,n,i]=e;return t+256*n+65536*i-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:nh(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const t of this.props.extensions)e=ih(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&t)if(Array.isArray(n))for(const i of n)t.invalidateAll(i);else t.invalidateAll();if(t){const{props:n}=e,i=this.internalState.hasPickingBuffer,r=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some((e=>e.getNeedsPickingBuffer.call(this,e)));if(i!==r){this.internalState.hasPickingBuffer=r;const{pickingColors:e,instancePickingColors:n}=t.attributes,i=e||n;i&&(r&&i.constant&&(i.constant=!1,t.invalidate(i.id)),i.value||r||(i.constant=!0,i.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e)}getPickingInfo(e){let{info:t,mode:n,sourceLayer:i}=e;const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}raiseError(e,t){var n,i,r,o;(t&&(e.message="".concat(t,": ").concat(e.message)),null!==(n=(i=this.props).onError)&&void 0!==n&&n.call(i,e))||(null===(r=this.context)||void 0===r||null===(o=r.onError)||void 0===o||o.call(r,e,this))}getNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(e)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var e;return(null===(e=this.internalState)||void 0===e?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,t&&Ch({oldViewport:t,viewport:e})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";const t=this.getAttributeManager();t&&("all"===e?t.invalidateAll():t.invalidate(e))}updateAttributes(e){for(const t of this.getModels())this._setModelAttributes(t,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,n=this.getNumInstances(),i=this.getStartIndices();e.update({data:t.data,numInstances:n,startIndices:i,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const r=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(r)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),n=Object.create(this.props);for(const e in t)Object.defineProperty(n,e,{value:t[e]});return n}return this.props}calculateInstancePickingColors(e,t){let{numInstances:n}=t;if(e.constant)return;const i=Math.floor(Ah.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>Eh&&ne.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ah=ie.allocate(Ah,n,{size:3,copy:!0,maxCount:Math.max(n,Eh)});const e=Math.floor(Ah.length/3),t=[];for(let n=i;n<e;n++)this.encodePickingColor(n,t),Ah[3*n+0]=t[0],Ah[3*n+1]=t[1],Ah[3*n+2]=t[2]}e.value=Ah.subarray(0,3*n)}_setModelAttributes(e,t){const n=this.getAttributeManager(),i=e.userData.excludeAttributes||{},r=n.getShaderAttributes(t,i);e.setAttributes(r)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t))return void this._disablePickingIndex(e);const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,r=n||i,o=r&&t.attributes&&t.attributes[r.id];if(o&&o.value){const n=o.value,i=this.encodePickingColor(e);for(let e=0;e<t.length;e++){const t=r.getVertexOffset(e);n[t]===i[0]&&n[t+1]===i[1]&&n[t+2]===i[2]&&this._disablePickingIndex(e)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:n}=this.getAttributeManager().attributes,i=t||n;if(!i)return;const r=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(o-r),offset:r})}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,n=e||t;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Ah.buffer&&(n.value=Ah.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){Xt(!this.internalState),Xt(Number.isFinite(this.props.coordinateSystem)),Xn("layer.initialize",this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Sh({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(ne.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new Yd(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Xn("layer.matched",this,this===e);const{state:t,internalState:n}=e;this!==e&&(this.internalState=n,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Xn("layer.update",this,e),!e)return;const t=this.props,n=this.context,i=this.internalState,r=n.viewport,o=this._updateUniformTransition();i.propsInTransition=o,n.viewport=i.viewport||r,this.props=o;try{const e=this._getUpdateParams(),t=this.getModels();if(n.gl)this.updateState(e);else try{this.updateState(e)}catch(s){}for(const n of this.props.extensions)n.updateState.call(this,e,n);const i=this.getModels()[0]!==t[0];this._postUpdate(e,i)}finally{n.viewport=r,this.props=t,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Xn("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer(e){let{moduleParameters:t=null,uniforms:n={},parameters:i={}}=e;this._updateAttributeTransition();const r=this.props,o=this.context;this.props=this.internalState.propsInTransition||r;const s=this.props.opacity;n.opacity=Math.pow(s,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:e}=this.props,r=e&&e(n)||[0,0];as(o.gl,{polygonOffset:r}),ls(o.gl,i,(()=>{const e={moduleParameters:t,uniforms:n,parameters:i,context:o};for(const t of this.props.extensions)t.draw.call(this,e,t);this.draw(e)}))}finally{this.props=r}}getChangeFlags(){var e;return null===(e=this.internalState)||void 0===e?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const i in e)if(e[i]){let n=!1;if("dataChanged"===i){const r=e[i],o=t[i];r&&Array.isArray(o)&&(t.dataChanged=Array.isArray(r)?o.concat(r):r,n=!0)}t[i]||(t[i]=e[i],n=!0),n&&Xn("layer.changeFlag",this,i,e)}const n=Boolean(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=n,t.somethingChanged=n||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const n=Kd(e,t);if(n.updateTriggersChanged)for(const r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(n.transitionsChanged)for(const r in n.transitionsChanged){var i;this.internalState.uniformTransitions.add(r,t[r],e[r],null===(i=e.transitions)||void 0===i?void 0:i[r])}return this.setChangeFlags(n)}validateProps(){!function(e){const t=e[Bn];for(const n in t){const i=t[n],{validate:r}=i;if(r&&!r(e[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(e[n]))}}(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={pickingSelectedColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&"function"===typeof n&&(t.pickingHighlightColor=n(e)),this.setModuleParameters(t),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Gd(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:n,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:r}=this.state;null===r||void 0===r||r.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:s,highlightColor:a}=n;if(t||i.autoHighlight!==o||i.highlightedObjectIndex!==s||i.highlightColor!==a){const e={};o||(e.pickingSelectedColor=null),Array.isArray(a)&&(e.pickingHighlightColor=a),(t||s!==i.highlightedObjectIndex)&&(e.pickingSelectedColor=Number.isFinite(s)&&s>=0?this.encodePickingColor(s):null),this.setModuleParameters(e)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=!!n&&n.getNeedsRedraw(e);if(t=t||i,t)for(const r of this.props.extensions)r.onNeedsRedraw.call(this,r);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}I(Mh,"defaultProps",kh),I(Mh,"layerName","Layer");const Lh={position:"absolute",zIndex:-1};function Oh(t,n){if("function"===typeof t)return t(n);if(Array.isArray(t))return t.map((e=>Oh(e,n)));if(Rh(t)){if(function(e){const t=e.type,n=t&&t.defaultProps;return n&&n.mapStyle}(t))return n.style=Lh,(0,e.cloneElement)(t,n);if(function(e){const t=e.type;return t&&t.deckGLViewProps}(t))return(0,e.cloneElement)(t,n)}return t}function Rh(e){return e&&"object"===typeof e&&"type"in e||!1}function Ih(t){if("function"===typeof t)return(0,e.createElement)(Zt,{},t);if(Array.isArray(t))return t.map(Ih);if(Rh(t)){if(t.type===e.Fragment)return Ih(t.props.children);if(Bu(t.type,Zt))return t}return t}const zh={mixBlendMode:null};function Fh(e){e.redrawReason&&(e.deck._drawLayers(e.redrawReason),e.redrawReason=null)}const Dh=(0,e.forwardRef)(((t,n)=>{const[i,r]=(0,e.useState)(0),o=(0,e.useRef)({control:null,version:i,forceUpdate:()=>r((e=>e+1))}).current,s=(0,e.useRef)(null),a=(0,e.useRef)(null),l=(0,e.useMemo)((()=>function(t){let{children:n,layers:i=[],views:r=null}=t;const o=[],s=[],a={};return e.Children.forEach(Ih(n),(e=>{if(Rh(e)){const t=e.type;if(Bu(t,Mh)){const n=function(e,t){const n={},i=e.defaultProps||{};for(const r in t)i[r]!==t[r]&&(n[r]=t[r]);return new e(n)}(t,e.props);s.push(n)}else o.push(e);if(Bu(t,Zt)&&t!==Zt&&e.props.id){const n=new t(e.props);a[n.id]=n}}else e&&o.push(e)})),Object.keys(a).length>0&&(Array.isArray(r)?r.forEach((e=>{a[e.id]=e})):r&&(a[r.id]=r),r=Object.values(a)),i=s.length>0?[...s,...i]:i,{layers:i,children:o,views:r}}(t)),[t.layers,t.views,t.children]);let c=!0;const u=e=>{var n;return c&&t.viewState?(o.viewStateUpdateRequested=e,null):(o.viewStateUpdateRequested=null,null===(n=t.onViewStateChange)||void 0===n?void 0:n.call(t,e))},d=e=>{var n;c?o.interactionStateUpdateRequested=e:(o.interactionStateUpdateRequested=null,null===(n=t.onInteractionStateChange)||void 0===n||n.call(t,e))},h=(0,e.useMemo)((()=>{const e={...t,style:null,width:"100%",height:"100%",parent:s.current,canvas:a.current,layers:l.layers,views:l.views,onViewStateChange:u,onInteractionStateChange:d};return delete e._customRender,o.deck&&o.deck.setProps(e),e}),[t]);(0,e.useEffect)((()=>{const e=t.Deck||ju;return o.deck=function(e,t,n){const i=new t({...n,_customRender:t=>{e.redrawReason=t;const n=i.getViewports();e.lastRenderedViewports!==n?e.forceUpdate():Fh(e)}});return i}(o,e,{...h,parent:s.current,canvas:a.current}),()=>{var e;return null===(e=o.deck)||void 0===e?void 0:e.finalize()}}),[]),Nu((()=>{Fh(o);const{viewStateUpdateRequested:e,interactionStateUpdateRequested:t}=o;e&&u(e),t&&d(t)})),(0,e.useImperativeHandle)(n,(()=>function(e){return{get deck(){return e.deck},pickObject:t=>e.deck.pickObject(t),pickMultipleObjects:t=>e.deck.pickMultipleObjects(t),pickObjects:t=>e.deck.pickObjects(t)}}(o)),[]);const f=o.deck&&o.deck.isInitialized?o.deck.getViewports():void 0,{ContextProvider:p,width:g,height:m,id:v,style:y}=t,{containerStyle:b,canvasStyle:_}=(0,e.useMemo)((()=>function(e){let{width:t,height:n,style:i}=e;const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:n},o={left:0,top:0};if(i)for(const s in i)s in zh?o[s]=i[s]:r[s]=i[s];return{containerStyle:r,canvasStyle:o}}({width:g,height:m,style:y})),[g,m,y]);if(!o.viewStateUpdateRequested&&o.lastRenderedViewports===f||o.version!==i){o.lastRenderedViewports=f,o.version=i;const t=function(t){let{children:n,deck:i,ContextProvider:r}=t;const{viewManager:o}=i||{};if(!o||!o.views.length)return[];const s={},a=o.views[0].id;for(const e of n){let t=a,n=e;Rh(e)&&Bu(e.type,Zt)&&(t=e.props.id||a,n=e.props.children);const i=o.getViewport(t),r=o.getViewState(t);if(i){r.padding=i.padding;const{x:e,y:o,width:a,height:l}=i;n=Oh(n,{x:e,y:o,width:a,height:l,viewport:i,viewState:r}),s[t]||(s[t]={viewport:i,children:[]}),s[t].children.push(n)}}return Object.keys(s).map((t=>{const{viewport:n,children:o}=s[t],{x:a,y:l,width:c,height:u}=n,d={position:"absolute",left:a,top:l,width:c,height:u},h="view-".concat(t),f=(0,e.createElement)("div",{key:h,id:h,style:d},...o);if(r){const o={viewport:n,container:i.canvas.offsetParent,eventManager:i.eventManager,onViewStateChange:e=>{e.viewId=t,i._onViewStateChange(e)}};return(0,e.createElement)(r,{key:h,value:o},f)}return f}))}({children:l.children,deck:o.deck,ContextProvider:p}),n=(0,e.createElement)("canvas",{key:"canvas",id:v||"deckgl-overlay",ref:a,style:_});o.control=(0,e.createElement)("div",{id:"".concat(v||"deckgl","-wrapper"),ref:s,style:b},[n,t])}return c=!1,o.control}));Dh.defaultProps=ju.defaultProps;const jh=Dh;const Nh=n.p+"static/media/logo.5048f749600413101ac3d10ac0edbc59.svg",Bh=(e,t)=>{const{type:n,payload:i}=t;if("increment_timer"===n){const t=e.timer+i.increment,n=e.currentView,r=e.featureEnd,o=e.featureIndex,s=e.views[n].featuresLength;if(t>r){if(o+1<s){const t=e.views[n].features[o+1],i=e.views[n].offset,r={...e.viewState,latitude:t.lat,longitude:t.lng+i};return{...e,featureEnd:e.views[n].pauseTime,featureIndex:o+1,feature:t,timer:0,viewState:r}}{const t=n+1<e.views.length?n+1:0,i=e.views[t].features[0],r=e.views[t].offset,o={...e.viewState,latitude:i.lat,longitude:i.lng+r,zoom:e.views[t].zoom,transitionDuration:e.views[t].pauseTime/5};return{...e,timer:0,currentView:t,featureIndex:0,featureEnd:e.views[t].pauseTime,feature:i,layers:e.views[t].layers,view:e.views[t].view,name:e.views[t].name,lines:e.views[t].lines,viewState:o}}}return{...e,timer:t}}return console.log("error - no matching action",n,i),{...e}},Uh=["bearing","pitch"],Vh={speed:1.2,curve:1.414};const Wh=JSON.parse('[{"loc":"Townsville, Australia","lat":-19.2569,"lng":146.824,"n":1,"order":1},{"loc":"Australia","lat":-24.7761,"lng":134.755,"n":26,"order":2},{"loc":"Perth, Australia","lat":-31.9559,"lng":115.8606,"n":1,"order":3},{"loc":"Melbourne, Australia","lat":-37.8142,"lng":144.9632,"n":1,"order":4},{"loc":"Sydney, Australia","lat":-33.8698,"lng":151.2083,"n":3,"order":5},{"loc":"Brisbane, Australia","lat":-27.469,"lng":153.0235,"n":3,"order":6},{"loc":"Vanuatu","lat":-16.5255,"lng":168.1069,"n":2,"order":7},{"loc":"Solomon Islands","lat":-8.7054,"lng":159.1071,"n":2,"order":8},{"loc":"Kiribati","lat":0.3449,"lng":173.6642,"n":2,"order":9},{"loc":"Fiji","lat":-18.124,"lng":179.0123,"n":19,"order":10},{"loc":"Tonga","lat":-19.9161,"lng":-175.2026,"n":2,"order":11},{"loc":"Samoa","lat":-13.7694,"lng":-172.12,"n":4,"order":12},{"loc":"Western Samoa","lat":-13.7694,"lng":-172.12,"n":1,"order":13},{"loc":"Niue","lat":-19.0536,"lng":-169.8613,"n":1,"order":14},{"loc":"Cook Islands","lat":-19.997,"lng":-157.7859,"n":1,"order":15},{"loc":"Chile","lat":-31.7613,"lng":-71.3188,"n":2,"order":16},{"loc":"Peru","lat":-6.87,"lng":-75.0459,"n":3,"order":17},{"loc":"Guatemala","lat":15.5856,"lng":-90.3458,"n":1,"order":18},{"loc":"United States of America","lat":39.7837,"lng":-100.4459,"n":8,"order":19},{"loc":"Winnipeg, Canada","lat":49.8955,"lng":-97.1385,"n":1,"order":20},{"loc":"Vancouver, Canada","lat":49.2609,"lng":-123.114,"n":1,"order":21},{"loc":"Canada","lat":61.0667,"lng":-107.9917,"n":2,"order":22},{"loc":"Edinburgh, United Kingdom","lat":55.9533,"lng":-3.1884,"n":1,"order":23},{"loc":"United Kingdom","lat":54.7024,"lng":-3.2766,"n":9,"order":24},{"loc":"Belgium","lat":50.6403,"lng":4.6667,"n":1,"order":25},{"loc":"Austria","lat":47.594,"lng":14.1246,"n":2,"order":26},{"loc":"Slovenia","lat":46.1199,"lng":14.8153,"n":1,"order":27},{"loc":"Croatia","lat":45.3658,"lng":15.6575,"n":1,"order":28},{"loc":"Italy","lat":42.6384,"lng":12.6743,"n":2,"order":29},{"loc":"Libya","lat":26.8234,"lng":18.1237,"n":1,"order":30},{"loc":"Turkey","lat":38.9598,"lng":34.925,"n":2,"order":31},{"loc":"Georgia","lat":41.681,"lng":44.0287,"n":1,"order":32},{"loc":"Pakistan","lat":30.3308,"lng":71.2475,"n":1,"order":33},{"loc":"Qatar","lat":25.3337,"lng":51.2295,"n":4,"order":34},{"loc":"Mozambique","lat":-19.3022,"lng":34.9145,"n":1,"order":35},{"loc":"Maldives","lat":3.7204,"lng":73.2244,"n":2,"order":36},{"loc":"India","lat":22.3511,"lng":78.6677,"n":1,"order":37},{"loc":"China","lat":35.0001,"lng":104.9999,"n":11,"order":38},{"loc":"Taiwan","lat":23.9739,"lng":120.982,"n":1,"order":39},{"loc":"Philippines","lat":12.7503,"lng":122.7312,"n":7,"order":40},{"loc":"Hong Kong, ","lat":22.2793,"lng":114.1628,"n":1,"order":41},{"loc":"Laos","lat":20.0171,"lng":103.3783,"n":3,"order":42},{"loc":"Myanmar","lat":17.175,"lng":96,"n":1,"order":43},{"loc":"Thailand","lat":14.8972,"lng":100.8327,"n":1,"order":44},{"loc":"Vietnam","lat":15.9267,"lng":107.9651,"n":2,"order":45},{"loc":"Cambodia","lat":12.5433,"lng":104.8145,"n":2,"order":46},{"loc":"Malaysia","lat":4.5694,"lng":102.2657,"n":3,"order":47},{"loc":"Singapore","lat":1.3571,"lng":103.8195,"n":3,"order":48},{"loc":"Brunei","lat":4.4137,"lng":114.5654,"n":1,"order":49},{"loc":"Indonesia","lat":-2.4834,"lng":117.8903,"n":3,"order":50},{"loc":"Papua New Guinea","lat":-5.6816,"lng":144.2489,"n":4,"order":51}]'),Gh=JSON.parse('[{"Project":"Warragamba Dam Raising Project","type":"International","lat":-33.8488,"lng":150.6052,"client":"Water New South Wales","duration":"2017 -","desc":"Raising existing 142 m concrete dam by 14 m\\r\\n500,000 m3 new concrete","contacts":"Greg Brown, Tim Lusk, Grant Murray, John Sullivan, Nik Devlin, Aaron Drake, Alec Glover","image_name":"WarragambaDamRaisingProject.png","order":2},{"Project":"Huanza Hydro Power Project","type":"International","lat":-11.5323,"lng":-76.4808,"client":"Conenhua","duration":"2010 - 2015","desc":"96 MW dual 6-jet pelton turbine scheme\\r\\n16 m3/s flow\\r\\n710m head\\r\\n10km of 3,700mm diameter conveyance tunnel\\r\\n39.4m concrete gravity dam","contacts":"Aaron Drake","image_name":"HuanzaHydroPowerProject.png","order":3},{"Project":"Santa Teresa Hydro Power Project","type":"International","lat":-13.1299,"lng":-72.5937,"client":"Luz del Sur S.A.A.","duration":"2013 - 2016","desc":"98 MW dual francis turbines\\r\\nCompletely underground intake, conveyances and station\\r\\n61m3/s flow\\r\\n188m head\\r\\nDownstream of Machu Picchu in the Cusco region","contacts":"Aaron Drake","image_name":"SantaTeresaHydroPowerProject.png","order":4},{"Project":"Koysha Hydro Power Project","type":"International","lat":6.5807,"lng":36.5548,"client":"Ethiopian Electric Power","duration":"2020 -","desc":"2160 MW 6 Francis turbines (2.5 times the size of Manapouri)\\r\\n180m high roller compacted concrete gravity dam\\r\\nSpillway capacity 13,100m3/s using six 20m wide radial gates","contacts":"Aaron Drake","image_name":"KoyshaHydroPowerProject.png","order":5},{"Project":"Cambodia Location Referencing and Condition Survey","type":"International","lat":12.3528,"lng":104.8017,"client":"Ministry of Public Works and Transport Cambodia","duration":"2002 - 2007","desc":"2 survey vehicles equipped + 4 motorcycles\\r\\n12 local staff trained to operate survey equipment and software\\r\\n11,000km of videoed, mapped, and condition and traffic assessed\\r\\nMaintenance and renewal strategy developed based on modelling of data produced","contacts":"Peter Hill","image_name":"CambodiaLocationReferencingandConditionSurvey.png","order":6},{"Project":"Tina River Hydro Power Project","type":"International","lat":-9.4481,"lng":160.161,"client":"Tian River Power Limited","duration":"2017 -","desc":"15 MW powerhouse\\r\\n3,3 km length tunnel, 3.0 - 3.8 m diameter\\r\\n176,000 m3 concrete RCC dam\\r\\n21.5 km of new access roads","contacts":"Greg Brown, Alec Glover, Aaron Drake, Tim Lusk, Kirsten Norquay","image_name":"TinaRiverHydroPowerProject.png","order":7},{"Project":"Nadarivatu Renewable Energy Hydro Project","type":"International","lat":-17.6235,"lng":177.9258,"client":"Fiji Electricity Authority (now Energy Fiji Limited)","duration":"2001 to 2013","desc":"44 MW powerhouse\\r\\n2 km length tunnel, 3 m diameter\\r\\n35 m high, 40,000 m3 concrete gravity dam\\r\\nTransmission line and substation\\r\\n5 km roading network","contacts":"Greg Brown, Tim Lusk, Grant Murray, John Sullivan, Nik Devlin, Aaron Drake, Alec Glover","image_name":"NadarivatuRenewableEnergyHydroProject.png","order":8},{"Project":"Apia Urban Drainage Improvements and Climate Change Mitigation (from funding application to Green Climate Fund from MFAT)","type":"International","lat":-13.8502,"lng":-171.7503,"client":"Land Transport Authority","duration":"Funding application 2016 | Drainage Project 2020 to 2023","desc":"Funded from MFATs US$65M GCF\\r\\nDesign and implementation of critical drainage improvements in flood prone urban area","contacts":"Peter White","image_name":"ApiaUrbanDrainageImprovementsandClimateChangeMitigation.png","order":9},{"Project":"Manihiki Cyclone Rebuilding Review","type":"International","lat":-10.4361,"lng":-160.9939,"client":"Ministry of Foreign Affairs and Trade (MFAT)","duration":"2001 - 2004","desc":"Review and recommendations for future projects\\r\\nBuilding condition assessment\\r\\nDesign of building upgrades","contacts":"Peter White","image_name":"ManihikiCycloneRebuildingReview.png","order":10}]'),Hh=JSON.parse('[{"Project":"Cashmere Valley Dam","type":"National","lat":-43.5704,"lng":172.6264,"client":"Christchurch City Council","duration":"2018 - 2022","desc":"Multi-generational outcome that improved the flood protection and biodiversity for the Cashmere Valley community.  The work included the detention dam, along with the development of a landscape masterplan resulting in extensive native planting.","image_name":"CashmereValleyDam.png","order":2},{"Project":"Ground Source Heatpump Achieving Decarbonisation","type":"National","lat":-43.529,"lng":172.6326,"client":"University of Canterbury","duration":"2021 -","desc":"A progressive conversion of the Ilam campus from coal heating to sustainable heating energy source and a long term aim of removing combustion-based heating (boilers) from the campus. \\r\\nThis project replaces the heating for 4 major buildings with ground source heatpumps.","contacts":"Peter Watson, Aaron Drake, Grace Beatson","image_name":"GroundSourceHeatpumpAchievingDecarbonisation.png","order":3},{"Project":"Akarana Water Pumpstation","type":"National","lat":-36.9205,"lng":174.7336,"client":"Watercare Services Limited","duration":"Design, 2021 to 2022 | Construction, 2023 to 2024","desc":"New potable water boost pump station to supply growth in Mt Roskill. \\r\\nResponsible for design, consent and construction within two years of first concept, design developed in partnership with operations and construction partners. Complete LOD350 3D delivery using BIM360 to federate models across structural, mechanical, civil, electrical and architectural and as built underground services.","image_name":"AkaranaWaterPumpstation.png","order":4},{"Project":"Kaitoke Flume Bridge Seismic Upgrade","type":"National","lat":-41.0562,"lng":175.1935,"client":"Wellington Water Limited","duration":"2022 -","desc":"Replacement of the existing Kaitoke pipe bridge, and attached pedestrian crossing, with a new, more resilient bridge to ensure the safe supply of drinking water for the Wellington Region.\\r\\n50% of Wellington\'s water conveyed over the 133m bridge, which is around 150 million litres per day.","image_name":"KaitokeFlumeBridgeSeismicUpgrade.png","order":5},{"Project":"RiverLink","type":"National","lat":-41.1234,"lng":175.0739,"client":"Waka Kotahi, Greater Wellington, Hutt City Council and Mana Whenua","duration":"2023 - 2028 (previously delivered indicative business case and detailed business case)","desc":"A transformational set of projects for Te Awa Kairangi ki Tai Lower Hutt, combining crucial flood protection work, the Melling Transport Improvements, and Hutt City Centre urban revitalisation.  \\r\\n/n Stantec are part of the Alliance that has been procured to provide the final design and construct the project over the next 4 to 5 years.","contacts":"Sarah Connolly","image_name":"RiverLink.png","order":6},{"Project":"Mount Albert Sludge Pipeline","type":"National","lat":-41.3411,"lng":174.8106,"client":"Wellington Water Limited","duration":"2020","desc":"Stantec led a collaborative team to successfully repair the sludge conveyance failure in the two pipelines that transfer sludge from Moa Point WWTP to Carey\'s Gully sludge dewatering plant. \\r\\nThis burst resulted in sludge having to be transferred by road tankers 24 hours a day. \\r\\nThis innovative solution of localised internal patching of the pipes and pulling through 1.7km of non-structural PN35 liner was the first implementation of this liner in New Zealand.  \\r\\nDespite significant supply chain pressure due to Covid-19, materials and specialist personnel were rapidly mobilised from Germany and project was delivered.","image_name":"MountAlbertSludgePipeline.png","order":7},{"Project":"Millbrook Resort Development","type":"National","lat":-44.9387,"lng":168.8498,"client":"Millbrook Country Club Limited","duration":"2005 -","desc":"For over 15 years we were responsible for all engineering planning and design work. We provided technical support during the construction phases and collaborated closely with project managers, landscape and golf-course designers, planners, and utilities providers to develop the design. The result? A five-star lifestyle resort offering luxurious accommodation and two 18-hole championship golf courses.","contacts":"Peter White, Iain Banks","image_name":"MillbrookResortDevelopment.png","order":8},{"Project":"Hanley\'s Farm Housing Development","type":"National","lat":-45.0306,"lng":168.6617,"client":"RCL Group","duration":"2015 -","desc":"From project inception, we\'ve been responsible for all engineering planning and design, and collaborating with the client team, planners, surveyors, and geotechnical engineers. With high demand for residential building sites, we\'re helping our clients ease the housing market burden through their successful developments present and future.","contacts":"Peter White, Iain Banks","image_name":"HanleysFarmHousingDevelopment.png","order":9},{"Project":"Queenstown Eastern Access Road - Hawthorne Drive","type":"National","lat":-45.0216,"lng":168.7338,"client":"Queenstown Lakes District Council","duration":"2015 - 2016","desc":"A new $25M bypass around the back of the Queenstown airport to relieve traffic pressures, including a major stormwater system to serve Frankton Flats, new watermains and foul sewers to integrate with development of the Flats, and the needs of the Airport.  Rapidly designed and constructed.","contacts":"Nick Keenan, Andrew Quigley, Roger Oakley, Aaron Isaacs, Ben Carrick","image_name":"QueenstownEasternAccessRoad.png","order":10},{"Project":"Te Anau Wastewater scheme","type":"National","lat":-45.4162,"lng":167.7221,"client":"Southland District Council","duration":"2012 - 2021","desc":"A $25M state of the art Wastewater scheme for Te Anau, taking the discharge from existing wastewater ponds out of the Upukeroa River to a new land-disposal site 19km away.  \\r\\nThe project included all consenting and environmental studies, the provision of membrane filtration and the conversion of grazing pasture into a 28 Hectare dedicated subsurface drip irrigation scheme.  \\r\\nSubstantially the largest such scheme in New Zealand with 470km of buried driplines, it has a very low environmental footprint, high nitrogen removal and beneficial reuse of the wastewater.","contacts":"Roger Oakley, Tim Lusk, Jethro McCulloch, Sue Bennett\\r\\n","image_name":"TeAnauWastewaterscheme.png","order":11},{"Project":"Lake Dunstan Water Treatment Plant","type":"National","lat":-45.1727,"lng":169.3087,"client":"Central Otago District Council","duration":"2018 - 2021","desc":"Upgrade to the water supply for the townships of Clyde and Alexandra, known as the Lake Dunstan Water Supply (LDWS). \\r\\n18 MLD of safe drinking water is provided via the addition of a new bore, treatment plant, 750m3 reservoir in Clyde and a new 4000m3 reservoir in Alex.","contacts":"Richard Bennett, Kirsten Norquay, Andrew Wong","image_name":"LakeDunstanWaterTreatmentPlant.png","order":12},{"Project":"Clyde Main Wastewater Pump Station","type":"National","lat":-45.1727,"lng":169.3087,"client":"Central Otago District Council","duration":"2020 - 2022","desc":"New pump station and reticulated wastewater system replacing Clyde\'s existing system relying on septic tanks and disposal fields. \\r\\nPump station is designed to convey wastewater water to Alexandra\'s WWTP as well as provide emergency storage avoiding sewer overflows within the network and smoothing peak flows to the Alexandra WWTP. \\r\\nThis upgraded system is helping CODC meet environmental and resource consent requirements, providing the community with an environmentally safe wastewater system.","contacts":"Richard Bennett, John Sullivan","image_name":"ClydeMainWastewaterPumpStation.png","order":13}]'),qh=JSON.parse('[{"Project":"Te Rangihiroa MTHW Pipeline- Albany Street","type":"Dunedin","lat":-45.8674,"lng":170.5138,"client":"University of Otago","duration":"2022 - 2023","desc":"A new medium temperature hot water pipe was designed and installed for the University of Otago to supply heating to Te Rangihiroa College. The project includes connecting the new college to the Information Services Building (ISB) via two insulated 250mm steel pipes laid in parallel approximately 440m in length (880m total) along Albany Street. Stantec provided technical advice throughout the contract with completion expected in the coming weeks.","contacts":"Aaron Drake, Peter Watson, Matt Barber, Ben Carrick","image_name":"TeRangihiroa.png","order":2},{"Project":"Mt Grand C02","type":"Dunedin","lat":-45.8752,"lng":170.4427,"client":"Dunedin City Council","duration":"2023","desc":"Following threefold increases in the price of CO2, Stantec investigated ways that the Mt Grand water treatment plant could minimise its CO2 useage for pH correction.  \\r\\nAfter a  thorough review of the treatment processes, options were devised that retduced the useage by more than 50% without a reduction in treatment outcomes.  \\r\\nThis will provide an operational saving in the order of $600k per annum.","contacts":"Andrew Wong","image_name":"MtGrandC02.png","order":3},{"Project":"New Mosgiel Pool - Gordon Road Access Intersection","type":"Dunedin","lat":-45.8688,"lng":170.3446,"client":"Dunedin City Council","duration":"2022 - 2023","desc":"The design, construction and operation of the new Mosgiel swimming pool has required the design inputs from a wide range of disciplines and organisations i.e. Architects, Local and Regional Authorities, Road Controlling Authority, Local Community, Stakeholders, Contractors,  Service Providers.\\r\\nThe collaborative working environment has produced significant capital cost savings, future proofed additional underground services, streamlined deliverables and set up the construction phase for successful implementation.","contacts":"Susan Lilley, David Machek, Brent Grey, Aaron Isaacs","image_name":"MosgielPool.png","order":4},{"Project":"Southern Water Treatment Plant","type":"Dunedin","lat":-45.8893,"lng":170.4493,"client":"Dunedin City Council","duration":"2000 - 2005","desc":"Winner of the Ingenium national award for major projects. End to end services from concept to commissioning of the greenfields 40,000m3/day Southern Water Treatment Plant, incorporating  leading-edge membrane treatment technology. \\r\\nNow one of two principal WTPs serving Dunedin, the $33M plant was delivered under budget and on time and has reliably delivered high quality potable water since it\'s commisioning in 2005. \\r\\nAt the time, the two 20,000m3 treated water storage reservoirs were the largest in NZ!","contacts":"Roger Oakley, Alec Glover","image_name":"SouthernWaterTreatmentPlantmerge.png","order":5},{"Project":"DCC Raw Water Lifelines","type":"Dunedin","lat":-45.8798,"lng":170.4929,"client":"Dunedin City Council","duration":"2010-2011","desc":"National award-winning strategy to optimise the lifespan and renewal program for Dunedin\'s $110M critical raw water supply mains, while improving resilience and minimising cost. \\r\\nThe Lifelines Strategy saved up to $11.2M on existing, approved LTP budgets and has been adopted as a case study for the International Infrastructure Maintenance Manual.","contacts":"Roger Oakley, Alistair McGaughran","image_name":"DCCRawWaterLifelines.png","order":6},{"Project":"Dunedin City Separated Cycle Lanes","type":"Dunedin","lat":-45.8762,"lng":170.507,"client":"Waka Kotahi Transport Agency","duration":"2018 - 2019","desc":"Due to the ongoing crash rate involving cyclists on Dunedin City\'s one way pair, Waka Kotahi Transport Agency  secured funding in for related safety improvements. This project created a step change in what was accepted as best practice in the industry at the time, bringing international learning in the design of safety improvements for cyclists and other active users of the roading network. \\r\\nStantec\'s Dunedin transportation team led all subsequent consultation, design and construction phases (with national and international support) to deliver a project that provides an integrated central city cycle network, encourages walking and cycling and increases safety for all road users.","contacts":"Andrew Quigley, Ross McCammon, Kylie Huard, Mike Flatters, Brent Grey","image_name":"DunedinCitySeparatedCycleLanes.png","order":7},{"Project":"Musselburgh to Tahuna DWF Rising Main","type":"Dunedin","lat":-45.8964,"lng":170.5175,"client":"Dunedin City Council","duration":"2022 -","desc":"Collaborative ECI delivery with McConnell Dowell to boost system resilience. \\r\\nReuse of existing pumps and DN1050 RC rising main to achieve project objectives \\r\\nDesign and installation of a new dry weather flow manifold with associated connections within the existing pump station and to existing rising mains \\r\\nDesign an associated construction methodology to minimise disruption to existing pump station operation, with flows in the order of 250-4000 l/s\\r\\nIdentified next steps for further mitigation and improved performance.","contacts":"Thomas Apthorp, Richard Bennett, Hendrick Pieterse","image_name":"MusselburghtoTahunaDWFRisingMain.png","order":8},{"Project":"Tahuna WWTP Lime Dosing","type":"Dunedin","lat":-45.9037,"lng":170.5216,"client":"Dunedin City Council","duration":"2022","desc":"Extremely multi-disciplinary project delivered at speed due to it\'s urgent nature.  \\r\\nTechnical expertise was priority sourced at haste across various speciliaties including mechanical, process, geotech, planning, pavements, structural and automation.  \\r\\nTahuna WWTP produces 20 tonnes of sludge daily, previously incinerated or disposed of in special pits in the GI landfill whose capacity was nearly exhausted. Our 2021 investigations showed that treatment with burnt lime made sludge suitable for co-disposal at the general landfill face, saving significant expense.\\r\\n","contacts":"Roger Oakley, Samdrub Dawa, Grace Beatson","image_name":"TahunaWWTPLimeDosingmerge.png","order":9},{"Project":"SH88 Shared Path Extension - Ravensbourne to St Leonards","type":"Dunedin","lat":-45.8642,"lng":170.5549,"client":"Otago Regional Council & Waka Kotahi","duration":"2011 - 2013","desc":"Forming part of the Dunedin to Port Chalmers Cycle and Walkway network, our team undertook the investigation, design and implementation of the pathway from the Boat Harbour to St Leonards.\\r\\nThis work brought to life the SH88: Cycling and walking strategy done by the wider team in 2010.","contacts":"Andrew Quigley, Lee Paterson","image_name":"SH88SharedPathExtension.png","order":10},{"Project":"Edinburgh Street Pipeline Renewals (Stages 1 - 3) and Lead Response","type":"Dunedin","lat":-45.5783,"lng":170.6608,"client":"Dunedin City Council","duration":"2021 -","desc":"Supported DCC in the initial lead event response by providing local, national and international technical expertise. \\r\\nUtilised ECI model with key contractors to collaboratively design a solution to replace old cast iron pipework with lead joining. \\r\\nThis enabled an efficient response, and the project was delivered at a significant pace to remove reliance on tankered water supply and support getting a safe water supply back to the community.","contacts":"Richard Bennett","image_name":"EdinburghStreetPipelineRenewalsStages1to3andLeadResponse.png","order":11}]'),Xh=JSON.parse('[{"lat":-45.8687,"lng":170.494},{"lat":-45.8748,"lng":170.5069},{"lat":-45.8251,"lng":170.5322},{"lat":-45.8701,"lng":170.5045},{"lat":-45.8132,"lng":170.5551},{"lat":-45.8725,"lng":170.5071},{"lat":-45.874,"lng":170.505},{"lat":-45.8426,"lng":170.6418},{"lat":-45.8725,"lng":170.5275},{"lat":-45.9255,"lng":170.3915},{"lat":-45.7162,"lng":-45.7162},{"lat":-45.8535,"lng":170.5737},{"lat":-45.8637,"lng":170.5273},{"lat":-45.8079,"lng":170.6216},{"lat":-45.8796,"lng":170.5602},{"lat":-45.9095,"lng":170.4722},{"lat":-45.6362,"lng":169.8887},{"lat":-45.8768,"lng":170.5027},{"lat":-45.8734,"lng":170.5036},{"lat":-45.8522,"lng":170.5326},{"lat":-45.8912,"lng":170.4887},{"lat":-45.8449,"lng":170.6042},{"lat":-45.8734,"lng":170.5036},{"lat":-45.8743,"lng":170.5031},{"lat":-45.8726,"lng":-45.8726},{"lat":-45.8745,"lng":170.5041},{"lat":-45.8727,"lng":170.5029},{"lat":-45.8734,"lng":170.5037},{"lat":-45.91,"lng":170.5351},{"lat":-45.8684,"lng":170.3444},{"lat":-45.855,"lng":170.5213},{"lat":-45.9073,"lng":170.51},{"lat":-45.8716,"lng":170.3539},{"lat":-45.9079,"lng":170.4839},{"lat":-45.9015,"lng":170.5153},{"lat":-45.8988,"lng":170.5023},{"lat":-45.7477,"lng":170.5699},{"lat":-45.7092,"lng":170.5893},{"lat":-45.9062,"lng":170.5516},{"lat":-45.8551,"lng":170.5189},{"lat":-45.8759,"lng":170.5085},{"lat":-45.5342,"lng":170.3213},{"lat":-45.5412,"lng":170.3124},{"lat":-45.5354,"lng":170.2986},{"lat":-45.5343,"lng":170.2902},{"lat":-45.869,"lng":170.5399},{"lat":-45.8646,"lng":170.3169},{"lat":-45.9013,"lng":170.4306},{"lat":-45.8057,"lng":170.5926},{"lat":-45.7948,"lng":170.3117},{"lat":-45.8942,"lng":170.5274},{"lat":-45.914,"lng":170.488},{"lat":-45.9093,"lng":170.5034},{"lat":-45.8635,"lng":170.5642},{"lat":-45.971,"lng":170.2479},{"lat":-45.9237,"lng":170.1998},{"lat":-45.9037,"lng":170.5431},{"lat":-45.8847,"lng":170.5252},{"lat":-45.8401,"lng":170.336},{"lat":-45.8813,"lng":170.5023},{"lat":-45.8617,"lng":170.3658},{"lat":-45.8797,"lng":170.3749},{"lat":-45.8543,"lng":170.1742},{"lat":-45.8711,"lng":170.5103},{"lat":-45.8692,"lng":170.5081},{"lat":-45.8768,"lng":170.5149},{"lat":-45.8863,"lng":170.5009},{"lat":-45.889,"lng":170.5008},{"lat":-45.3592,"lng":170.4287},{"lat":-45.9025,"lng":170.4955},{"lat":-45.9038,"lng":170.4914},{"lat":-45.8888,"lng":170.502},{"lat":-45.8692,"lng":170.5081},{"lat":-45.859,"lng":170.4729},{"lat":-45.8951,"lng":170.4279},{"lat":-45.815,"lng":170.6283},{"lat":-45.8668,"lng":170.5029},{"lat":-45.8645,"lng":170.5162},{"lat":-45.8675,"lng":170.5135},{"lat":-45.8707,"lng":170.5123},{"lat":-45.869,"lng":170.5077},{"lat":-45.8281,"lng":170.6411},{"lat":-45.8695,"lng":170.5108},{"lat":-45.8672,"lng":170.5094},{"lat":-45.8663,"lng":170.5154},{"lat":-45.862,"lng":170.515},{"lat":-45.8654,"lng":170.5158},{"lat":-45.8951,"lng":170.3461},{"lat":-45.8561,"lng":170.5165},{"lat":-45.8562,"lng":170.5154},{"lat":-46.0192,"lng":170.0975}]'),Zh={longitude:170.50325014707238,latitude:-45.8757087589976,zoom:10,transitionDuration:1e3,transitionInterpolator:new class extends un{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}),I(this,"opts",void 0),this.opts={...Vh,...e}}interpolateProps(e,t,n){const i=function(e,t,n,i){const{startZoom:r,startCenterXY:o,uDelta:s,w0:a,u1:l,S:c,rho:u,rho2:d,r0:h}=Rt(e,t,i);if(l<Mt){const i={};for(const r of Lt){const o=e[r],s=t[r];i[r]=(f=n)*s+(1-f)*o}return i}var f;const p=n*c,g=Math.cosh(h)/Math.cosh(h+u*p),m=a*((Math.cosh(h)*Math.tanh(h+u*p)-Math.sinh(h))/d)/l,v=r+mt(1/g),y=(w=m,(b=[])[0]=(_=s)[0]*w,b[1]=_[1]*w,b);var b,_,w;Be(y,y,o);const x=yt(y);return{longitude:x[0],latitude:x[1],zoom:v}}(e,t,n,this.opts);for(const r of Uh)i[r]=le(e[r]||0,t[r]||0,n);return i}getDuration(e,t){let{transitionDuration:n}=t;return"auto"===n&&(n=function(e,t,n){const i={...Ot,...n},{screenSpeed:r,speed:o,maxDuration:s}=i,{S:a,rho:l}=Rt(e,t,i),c=1e3*a;let u;return u=Number.isFinite(r)?c/(r/l):c/o,Number.isFinite(s)&&u>s?0:u}(e,t,this.opts)),n}}},Yh="Map",Kh="Globe",Qh=[{name:"dunedin",pauseTime:2e4,featuresLength:1,features:Xh,offset:0,zoom:10,view:Yh,lines:{line1:"Stantec Dunedin",line2:"have a",line3:"long history",line4:"with our local clients"}},{name:"local",pauseTime:12e3,featuresLength:qh.length,features:qh,offset:.01,zoom:14,view:Yh,lines:{line1:"Dunedin projects",line2:"delivered by",line3:"our",line4:"local team"}},{name:"national",pauseTime:12e3,featuresLength:Hh.length,features:Hh,offset:.08,zoom:12,view:Yh,lines:{line1:"a selection of our",line2:"national projects",line3:"",line4:""}},{name:"international",pauseTime:12e3,featuresLength:Gh.length,features:Gh,offset:1,zoom:2.5,view:Kh,lines:{line1:"Our Dunedin team",line2:"thinking locally",line3:"working",line4:"globally"}},{name:"staff",pauseTime:2e3,featuresLength:Wh.length,features:Wh,offset:0,zoom:1,view:Kh,lines:{line1:"our Dunedin team",line2:"have vast",line3:"global",line4:"experience"}}],$h={timer:0,currentView:0,featureIndex:0,feature:Qh[0].features[0],featureEnd:Qh[0].pauseTime,viewState:{...Zh,zoom:Qh[0].zoom,latitude:Qh[0].features[0].lat,longitude:Qh[0].features[0].lng},layers:Qh[0].layers,view:Qh[0].view,name:Qh[0].name,views:Qh,lines:Qh[0].lines};var Jh=n(184);const ef=(0,e.createContext)($h),tf=t=>{let{children:n}=t;const[i,r]=(0,e.useReducer)(Bh,$h);(0,e.useEffect)((()=>{const e=setInterval((()=>{r({type:"increment_timer",payload:{increment:100}})}),100);return()=>clearInterval(e)}),[]);const o={...i};return(0,Jh.jsx)(ef.Provider,{value:o,children:n})},nf=()=>{const t=(0,e.useContext)(ef);if(void 0===t)throw new Error("useCrashData must be used within AppContext");return t},rf={name:"project32",dependencies:[Ml],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},of="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",sf={lightSources:{}};function af(){let{color:e=[0,0,0],intensity:t=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.map((e=>e*t/255))}const lf={name:"lights",vs:of,fs:of,getUniforms:function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sf;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:i}=t.lightSources||{};return e||n&&n.length>0||i&&i.length>0?Object.assign({},function(e){let{ambientLight:t,pointLights:n=[],directionalLights:i=[]}=e;const r={};return r["lighting_uAmbientLight.color"]=t?af(t):[0,0,0],n.forEach(((e,t)=>{r["lighting_uPointLight[".concat(t,"].color")]=af(e),r["lighting_uPointLight[".concat(t,"].position")]=e.position,r["lighting_uPointLight[".concat(t,"].attenuation")]=e.attenuation||[1,0,0]})),r.lighting_uPointLightCount=n.length,i.forEach(((e,t)=>{r["lighting_uDirectionalLight[".concat(t,"].color")]=af(e),r["lighting_uDirectionalLight[".concat(t,"].direction")]=e.direction})),r.lighting_uDirectionalLightCount=i.length,r}({ambientLight:e,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const n={pointLights:[],directionalLights:[]};for(const e of t.lights||[])switch(e.type){case"ambient":n.ambientLight=e;break;case"directional":n.directionalLights.push(e);break;case"point":n.pointLights.push(e)}return e({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}},cf="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",uf={};function df(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uf;if(!("material"in e))return{};const{material:t}=e;return t?function(e){const{ambient:t=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=e;return{lighting_uAmbient:t,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map((e=>e/255))}}(t):{lighting_uEnabled:!1}}const hf={name:"gouraud-lighting",dependencies:[lf],vs:cf,defines:{LIGHTING_VERTEX:1},getUniforms:df},ff={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1};const pf={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:#decl":"\nuniform bool picking_uAttribute;\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ff;const t={};if(void 0!==e.pickingSelectedColor)if(e.pickingSelectedColor){const n=e.pickingSelectedColor.slice(0,3);t.picking_uSelectedColorValid=1,t.picking_uSelectedColor=n}else t.picking_uSelectedColorValid=0;if(e.pickingHighlightColor){const n=Array.from(e.pickingHighlightColor,(e=>e/255));Number.isFinite(n[3])||(n[3]=1),t.picking_uHighlightColor=n}return void 0!==e.pickingActive&&(t.picking_uActive=Boolean(e.pickingActive),t.picking_uAttribute=Boolean(e.pickingAttribute)),t}}},gf={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class mf{static get DRAW_MODE(){return gf}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=Es("geometry"),drawMode:n=gf.TRIANGLES,attributes:i={},indices:r=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(i,r),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const n in e){let t=e[n];t=ArrayBuffer.isView(t)?{value:t}:t,ws(ArrayBuffer.isView(t.value),"".concat(this._print(n),": must be typed array or object with value as typed array")),"POSITION"!==n&&"positions"!==n||t.size||(t.size=3),"indices"===n?(ws(!this.indices),this.indices=t):this.attributes[n]=t}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let n=1/0;for(const i in e){const t=e[i],{value:r,size:o,constant:s}=t;!s&&r&&o>=1&&(n=Math.min(n,r.length/o))}return ws(Number.isFinite(n)),n}}var vf=n(89),yf=n.n(vf);const bf=1,_f=-1;function wf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Math.sign(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{start:n=0,end:i=e.length}=t,r=t.size||2;let o=0;for(let s=n,a=i-r;s<i;s+=r)o+=(e[s]-e[a])*(e[s+1]+e[a+1]),a=s;return o/2}(e,t))}(e,n);return i!==t&&(function(e,t){const{start:n=0,end:i=e.length,size:r=2}=t,o=(i-n)/r,s=Math.floor(o/2);for(let a=0;a<s;++a){const t=n+a*r,i=n+(o-1-a)*r;for(let n=0;n<r;++n){const r=e[t+n];e[t+n]=e[i+n],e[i+n]=r}}}(e,n),!0)}function xf(e,t,n,i){let r,o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(8&n)r=(i[3]-e[1])/(t[1]-e[1]),o=3;else if(4&n)r=(i[1]-e[1])/(t[1]-e[1]),o=1;else if(2&n)r=(i[2]-e[0])/(t[0]-e[0]),o=2;else{if(!(1&n))return null;r=(i[0]-e[0])/(t[0]-e[0]),o=0}for(let a=0;a<e.length;a++)s[a]=(1&o)===a?i[o]:r*(t[a]-e[a])+e[a];return s}function Pf(e,t){let n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function Sf(e,t){const n=t.length,i=e.length;if(i>0){let r=!0;for(let o=0;o<n;o++)if(e[i-n+o]!==t[o]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)e[i+r]=t[r];return!0}function Ef(e,t){const n=t.length;for(let i=0;i<n;i++)e[i]=t[i]}function Tf(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const o=i+t*n;for(let s=0;s<n;s++)r[s]=e[o+s];return r}function Cf(e,t){const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=e.length}=t||{},l=(a-s)/n;let c=[];const u=[c],d=Tf(e,0,n,s);let h,f;const p=Rf(d,r,o,[]),g=[];Sf(c,d);for(let m=1;m<l;m++){for(h=Tf(e,m,n,s,h),f=Pf(h,p);f;){xf(d,h,f,p,g);const e=Pf(g,p);e&&(xf(d,g,e,p,g),f=e),Sf(c,g),Ef(d,g),If(p,r,f),i&&c.length>n&&(c=[],u.push(c),Sf(c,d)),f=Pf(h,p)}Sf(c,h),Ef(d,h)}return i?u:u[0]}const Af=0,kf=1;function Mf(e,t){for(let n=0;n<t.length;n++)e.push(t[n]);return e}function Lf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;if(!e.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n||{},a=[],l=[{pos:e,types:s?new Array(e.length/i).fill(kf):null,holes:t||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:e,types:t,holes:n}=l.shift();zf(e,i,n[0]||e.length,c),u=Rf(c[0],r,o,u);const d=Pf(c[1],u);if(d){let r=Of(e,t,i,0,n[0]||e.length,u,d);const o={pos:r[0].pos,types:r[0].types,holes:[]},a={pos:r[1].pos,types:r[1].types,holes:[]};l.push(o,a);for(let l=0;l<n.length;l++)r=Of(e,t,i,n[l],n[l+1]||e.length,u,d),r[0]&&(o.holes.push(o.pos.length),o.pos=Mf(o.pos,r[0].pos),s&&(o.types=Mf(o.types,r[0].types))),r[1]&&(a.holes.push(a.pos.length),a.pos=Mf(a.pos,r[1].pos),s&&(a.types=Mf(a.types,r[1].types)))}else{const i={positions:e};s&&(i.edgeTypes=t),n.length&&(i.holeIndices=n),a.push(i)}}return a}function Of(e,t,n,i,r,o,s){const a=(r-i)/n,l=[],c=[],u=[],d=[],h=[];let f,p,g;const m=Tf(e,a-1,n,i);let v=Math.sign(8&s?m[1]-o[3]:m[0]-o[2]),y=t&&t[a-1],b=0,_=0;for(let w=0;w<a;w++)f=Tf(e,w,n,i,f),p=Math.sign(8&s?f[1]-o[3]:f[0]-o[2]),g=t&&t[i/n+w],p&&v&&v!==p&&(xf(m,f,s,o,h),Sf(l,h)&&u.push(y),Sf(c,h)&&d.push(y)),p<=0?(Sf(l,f)&&u.push(g),b-=p):u.length&&(u[u.length-1]=Af),p>=0?(Sf(c,f)&&d.push(g),_+=p):d.length&&(d[d.length-1]=Af),Ef(m,f),v=p,y=g;return[b?{pos:l,types:t&&u}:null,_?{pos:c,types:t&&d}:null]}function Rf(e,t,n,i){const r=Math.floor((e[0]-n[0])/t)*t+n[0],o=Math.floor((e[1]-n[1])/t)*t+n[1];return i[0]=r,i[1]=o,i[2]=r+t,i[3]=o+t,i}function If(e,t,n){8&n?(e[1]+=t,e[3]+=t):4&n?(e[1]-=t,e[3]-=t):2&n?(e[0]+=t,e[2]+=t):1&n&&(e[0]-=t,e[2]-=t)}function zf(e,t,n,i){let r=1/0,o=-1/0,s=1/0,a=-1/0;for(let l=0;l<n;l+=t){const t=e[l],n=e[l+1];r=t<r?t:r,o=t>o?t:o,s=n<s?n:s,a=n>a?n:a}return i[0][0]=r,i[0][1]=s,i[1][0]=o,i[1][1]=a,i}const Ff=85.051129;function Df(e,t,n,i){let r=-1,o=-1;for(let s=n+1;s<i;s+=t){const t=Math.abs(e[s]);t>r&&(r=t,o=s-1)}return o}function jf(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ff;const o=e[n],s=e[i-t];if(Math.abs(o-s)>180){const i=Tf(e,0,t,n);i[0]+=360*Math.round((s-o)/360),Sf(e,i),i[1]=Math.sign(i[1])*r,Sf(e,i),i[0]=o,Sf(e,i)}}function Nf(e,t,n,i){let r,o=e[0];for(let s=n;s<i;s+=t){r=e[s];const t=r-o;(t>180||t<-180)&&(r-=360*Math.round(t/360)),e[s]=o=r}}function Bf(e,t){let n;const i=e.length/t;for(let o=0;o<i&&(n=e[o*t],(n+180)%360===0);o++);const r=360*-Math.round(n/360);if(0!==r)for(let o=0;o<i;o++)e[o*t]+=r}const Uf=bf,Vf=_f,Wf={isClosed:!0};function Gf(e){return"positions"in e?e.positions:e}function Hf(e){return"holeIndices"in e?e.holeIndices:null}function qf(e,t,n,i,r){let o=t;const s=n.length;for(let a=0;a<s;a++)for(let t=0;t<i;t++)e[o++]=n[a][t]||0;if(!function(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}(n))for(let a=0;a<i;a++)e[o++]=n[0][a]||0;return Wf.start=t,Wf.end=o,Wf.size=i,wf(e,r,Wf),o}function Xf(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;o=o||n.length;const a=o-r;if(a<=0)return t;let l=t;for(let c=0;c<a;c++)e[l++]=n[r+c];if(!function(e,t,n,i){for(let r=0;r<t;r++)if(e[n+r]!==e[i-t+r])return!1;return!0}(n,i,r,o))for(let c=0;c<i;c++)e[l++]=n[r+c];return Wf.start=t,Wf.end=l,Wf.size=i,wf(e,s,Wf),l}function Zf(e,t){!function(e){if(e=e&&e.positions||e,!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error("invalid polygon")}(e);const n=[],i=[];if("positions"in e){const{positions:r,holeIndices:o}=e;if(o){let e=0;for(let s=0;s<=o.length;s++)e=Xf(n,e,r,t,o[s-1],o[s],0===s?Uf:Vf),i.push(e);return i.pop(),{positions:n,holeIndices:i}}e=r}if(!function(e){return Array.isArray(e[0])}(e))return Xf(n,0,e,t,0,n.length,Uf),n;if(!function(e){return e.length>=1&&e[0].length>=2&&Number.isFinite(e[0][0])}(e)){let r=0;for(const[o,s]of e.entries())r=qf(n,r,s,t,0===o?Uf:Vf),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return qf(n,0,e,t,Uf),n}function Yf(e,t,n){const i=e.length/3;let r=0;for(let o=0;o<i;o++){const s=(o+1)%i;r+=e[3*o+t]*e[3*s+n],r-=e[3*s+t]*e[3*o+n]}return Math.abs(r/2)}function Kf(e,t,n,i){const r=e.length/3;for(let o=0;o<r;o++){const r=3*o,s=e[r+0],a=e[r+1],l=e[r+2];e[r+t]=s,e[r+n]=a,e[r+i]=l}}class Qf{constructor(e){I(this,"opts",void 0),I(this,"typedArrayManager",void 0),I(this,"indexStarts",[0]),I(this,"vertexStarts",[0]),I(this,"vertexCount",0),I(this,"instanceCount",0),I(this,"attributes",void 0),I(this,"_attributeDefs",void 0),I(this,"data",void 0),I(this,"getGeometry",void 0),I(this,"geometryBuffer",void 0),I(this,"buffers",void 0),I(this,"positionSize",void 0),I(this,"normalize",void 0);const{attributes:t={}}=e;this.typedArrayManager=ie,this.attributes={},this._attributeDefs=t,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:t,buffers:n={},getGeometry:i,geometryBuffer:r,positionFormat:o,dataChanged:s,normalize:a=!0}=this.opts;if(this.data=t,this.getGeometry=i,this.positionSize=r&&r.size||("XY"===o?2:3),this.buffers=n,this.normalize=a,r&&(Xt(t.startIndices),this.getGeometry=this.getGeometryFromBuffer(r),a||(n.positions=r)),this.geometryBuffer=n.positions,Array.isArray(s))for(const l of s)this._rebuildGeometry(l);else this._rebuildGeometry()}updatePartialGeometry(e){let{startRow:t,endRow:n}=e;this._rebuildGeometry({startRow:t,endRow:n})}getGeometryFromBuffer(e){const t=e.value||e;return ArrayBuffer.isView(t)?Yu(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,t){const{attributes:n,buffers:i,_attributeDefs:r,typedArrayManager:o}=this;for(const s in r)if(s in i)o.release(n[s]),n[s]=null;else{const i=r[s];i.copy=t,n[s]=o.allocate(n[s],e,i)}}_forEachGeometry(e,t,n){const{data:i,getGeometry:r}=this,{iterable:o,objectInfo:s}=Xu(i,t,n);for(const a of o){s.index++;e(r?r(a,s):null,s.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:t,vertexStarts:n,instanceCount:i}=this;const{data:r,geometryBuffer:o}=this,{startRow:s=0,endRow:a=1/0}=e||{},l={};if(e||(t=[0],n=[0]),this.normalize||!o)this._forEachGeometry(((e,t)=>{const i=e&&this.normalizeGeometry(e);l[t]=i,n[t+1]=n[t]+(i?this.getGeometrySize(i):0)}),s,a),i=n[n.length-1];else if(n=r.startIndices,i=n[r.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof Vs){const e=o.accessor.stride||4*this.positionSize;i=i||o.byteLength/e}else if(o.buffer){const e=o.stride||4*this.positionSize;i=i||o.buffer.byteLength/e}else if(o.value){const e=o.value,t=o.stride/e.BYTES_PER_ELEMENT||this.positionSize;i=i||e.length/t}this._allocate(i,Boolean(e)),this.indexStarts=t,this.vertexStarts=n,this.instanceCount=i;const c={};this._forEachGeometry(((e,r)=>{const o=l[r]||e;c.vertexStart=n[r],c.indexStart=t[r];const s=r<n.length-1?n[r+1]:i;c.geometrySize=s-n[r],c.geometryIndex=r,this.updateGeometryAttributes(o,c)}),s,a),this.vertexCount=t[t.length-1]}}class $f extends Qf{constructor(e){const{fp64:t,IndexType:n=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(e){const{attributes:t}=this;return"indices"===e?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);const t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const t=Zf(e,this.positionSize);return this.opts.resolution?Lf(Gf(t),Hf(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;const{size:i=2,normalize:r=!0,edgeTypes:o=!1}=n||{};t=t||[];const s=[],a=[];let l=0,c=0;for(let d=0;d<=t.length;d++){const r=t[d]||e.length,o=c,u=Df(e,i,l,r);for(let t=u;t<r;t++)s[c++]=e[t];for(let t=l;t<u;t++)s[c++]=e[t];Nf(s,i,o,c),jf(s,i,o,c,null===n||void 0===n?void 0:n.maxLatitude),l=r,a[d]=c}a.pop();const u=Lf(s,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(r)for(const d of u)Bf(d.positions,i);return u}(Gf(t),Hf(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return e}getGeometrySize(e){if(Jf(e)){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}return Gf(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,t){if(e&&Jf(e))for(const n of e){const e=this.getGeometrySize(n);t.geometrySize=e,this.updateGeometryAttributes(n,t),t.vertexStart+=e,t.indexStart=this.indexStarts[t.geometryIndex+1]}else this._updateIndices(e,t),this._updatePositions(e,t),this._updateVertexValid(e,t)}_updateIndices(e,t){let{geometryIndex:n,vertexStart:i,indexStart:r}=t;const{attributes:o,indexStarts:s,typedArrayManager:a}=this;let l=o.indices;if(!l||!e)return;let c=r;const u=function(e,t,n,i){let r=Hf(e);r&&(r=r.map((e=>e/t)));let o=Gf(e);const s=i&&3===t;if(n){const e=o.length;o=o.slice();const i=[];for(let r=0;r<e;r+=t){i[0]=o[r],i[1]=o[r+1],s&&(i[2]=o[r+2]);const e=n(i);o[r]=e[0],o[r+1]=e[1],s&&(o[r+2]=e[2])}}if(s){const e=Yf(o,0,1),t=Yf(o,0,2),i=Yf(o,1,2);if(!e&&!t&&!i)return[];e>t&&e>i||(t>i?(n||(o=o.slice()),Kf(o,0,2,1)):(n||(o=o.slice()),Kf(o,1,2,0)))}return yf()(o,r,t)}(e,this.positionSize,this.opts.preproject,this.opts.full3d);l=a.allocate(l,r+u.length,{copy:!0});for(let d=0;d<u.length;d++)l[c++]=u[d]+i;s[n+1]=r+u.length,o.indices=l}_updatePositions(e,t){let{vertexStart:n,geometrySize:i}=t;const{attributes:{positions:r},positionSize:o}=this;if(!r||!e)return;const s=Gf(e);for(let a=n,l=0;l<i;a++,l++){const e=s[l*o],t=s[l*o+1],n=o>2?s[l*o+2]:0;r[3*a]=e,r[3*a+1]=t,r[3*a+2]=n}}_updateVertexValid(e,t){let{vertexStart:n,geometrySize:i}=t;const{positionSize:r}=this,o=this.attributes.vertexValid,s=e&&Hf(e);if(e&&e.edgeTypes?o.set(e.edgeTypes,n):o.fill(1,n,n+i),s)for(let a=0;a<s.length;a++)o[n+s[a]/r-1]=0;o[n+i-1]=0}}function Jf(e){return Array.isArray(e)&&e.length>0&&!Number.isFinite(e[0])}const ep="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",tp="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(ep,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),np="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(ep,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n"),ip=[0,0,0,255],rp={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:e=>e.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:ip},getLineColor:{type:"accessor",value:ip},material:!0},op={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class sp extends Mh{constructor(){super(...arguments),I(this,"state",void 0)}getShaders(e){return super.getShaders({vs:"top"===e?tp:np,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[rf,hf,pf]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:t}=this.context;let{coordinateSystem:n}=this.props;const{_full3d:i}=this.props;let r;t.isGeospatial&&n===It.DEFAULT&&(n=It.LNGLAT),n===It.LNGLAT&&(r=i?t.projectPosition.bind(t):t.projectFlat.bind(t)),this.setState({numInstances:0,polygonTesselator:new $f({preproject:r,fp64:this.use64bitPositions(),IndexType:!e||pa(e,da)?Uint32Array:Uint16Array})});const o=this.getAttributeManager(),s=!0;o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:op,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,transition:op,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:op,accessor:"getFillColor",defaultValue:ip,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:op,accessor:"getLineColor",defaultValue:ip,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(e,t)=>{let{index:n,target:i}=t;return this.encodePickingColor(e&&e.__source?e.__source.index:n,i)},shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,{data:i}=this.props;return i[0]&&i[0].__source&&(t.object=i.find((e=>e.__source.index===n))),t}disablePickingIndex(e){const{data:t}=this.props;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else super.disablePickingIndex(e)}draw(e){let{uniforms:t}=e;const{extruded:n,filled:i,wireframe:r,elevationScale:o}=this.props,{topModel:s,sideModel:a,polygonTesselator:l}=this.state,c={...t,extruded:Boolean(n),elevationScale:o};a&&(a.setInstanceCount(l.instanceCount-1),a.setUniforms(c),r&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),i&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),s&&(s.setVertexCount(l.vertexCount),s.setUniforms(c).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:t,oldProps:n,changeFlags:i}=e,r=this.getAttributeManager();var o;(i.extensionsChanged||t.filled!==n.filled||t.extruded!==n.extruded)&&(null===(o=this.state.models)||void 0===o||o.forEach((e=>e.delete())),this.setState(this._getModels(this.context.gl)),r.invalidateAll())}updateGeometry(e){let{props:t,oldProps:n,changeFlags:i}=e;if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state,n=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:n.getPolygon,buffers:n,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged,full3d:t._full3d}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:t,filled:n,extruded:i}=this.props;let r,o;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,r=new jd(e,{...n,id:"".concat(t,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(o=new jd(e,{...this.getShaders("side"),id:"".concat(t,"-side"),geometry:new mf({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,r].filter(Boolean),topModel:r,sideModel:o}}calculateIndices(e){const{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){const{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}I(sp,"defaultProps",rp),I(sp,"layerName","SolidPolygonLayer");class ap extends Mh{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((e=>e.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo(e){let{info:t}=e;const{object:n}=t;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id?(t.object=n.__source.object,t.index=n.__source.index,t):t}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:n}=this.props;return n&&n[e]&&n[e].type||t}getSubLayerRow(e,t,n){return e.__source={parent:this,object:t,index:n},e}getSubLayerAccessor(e){if("function"===typeof e){const t={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(t.index=n.__source.index,e(n.__source.object,t)):e(n,i)}return e}getSubLayerProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const{opacity:n,pickable:i,visible:r,parameters:o,getPolygonOffset:s,highlightedObjectIndex:a,autoHighlight:l,highlightColor:c,coordinateSystem:u,coordinateOrigin:d,wrapLongitude:h,positionFormat:f,modelMatrix:p,extensions:g,fetch:m,operation:v,_subLayerProps:y}=this.props,b={id:"",updateTriggers:{},opacity:n,pickable:i,visible:r,parameters:o,getPolygonOffset:s,highlightedObjectIndex:a,autoHighlight:l,highlightColor:c,coordinateSystem:u,coordinateOrigin:d,wrapLongitude:h,positionFormat:f,modelMatrix:p,extensions:g,fetch:m,operation:v},_=y&&e.id&&y[e.id],w=_&&_.updateTriggers,x=e.id||"sublayer";if(_){const t=this.props[Bn],n=e.type?e.type._propTypes:{};for(const e in _){const i=n[e]||t[e];i&&"accessor"===i.type&&(_[e]=this.getSubLayerAccessor(_[e]))}}Object.assign(b,e,_),b.id="".concat(this.props.id,"-").concat(x),b.updateTriggers={all:null===(t=this.props.updateTriggers)||void 0===t?void 0:t.all,...e.updateTriggers,...w};for(const P of g){const e=P.getSubLayerProps.call(this,P);e&&Object.assign(b,e,{updateTriggers:Object.assign(b.updateTriggers,e.updateTriggers)})}return b}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();if(i){n=Zn(this.renderLayers(),Boolean),this.internalState.subLayers=n}Xn("compositeLayer.renderLayers",this,i,n);for(const r of n)r.parent=this}}function lp(e){let{data:t,getIndex:n,dataRange:i,replace:r}=e;const{startRow:o=0,endRow:s=1/0}=i,a=t.length;let l=a,c=a;for(let h=0;h<a;h++){const e=n(t[h]);if(l>h&&e>=o&&(l=h),e>=s){c=h;break}}let u=l;const d=c-l!==r.length?t.slice(c):void 0;for(let h=0;h<r.length;h++)t[u++]=r[h];if(d){for(let e=0;e<d.length;e++)t[u++]=d[e];t.length=u}return{startRow:l,endRow:l+r.length}}I(ap,"layerName","CompositeLayer");const cp=()=>{},up={10241:9987,10240:9729,10242:33071,10243:33071};function dp(e,t,n,i){const r=Math.min(n/t.width,i/t.height),o=Math.floor(t.width*r),s=Math.floor(t.height*r);return 1===r?{data:t,width:o,height:s}:(e.canvas.height=s,e.canvas.width=o,e.clearRect(0,0,o,s),e.drawImage(t,0,0,t.width,t.height,0,0,o,s),{data:e.canvas,width:o,height:s})}function hp(e){return e&&(e.id||e.url)}function fp(e,t,n,i){const r=e.width,o=e.height,s=new Ks(e.gl,{width:t,height:n,parameters:i});return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:o=0,targetInternalFormat:s=6408}=n;let{targetX:a,targetY:l,targetZ:c,width:u,height:d}=n;const{framebuffer:h,deleteFramebuffer:f}=ca(e);ws(h);const{gl:p,handle:g}=h,m="undefined"!==typeof a||"undefined"!==typeof l||"undefined"!==typeof c;a=a||0,l=l||0,c=c||0;const v=p.bindFramebuffer(36160,g);ws(t);let y=null;if(t instanceof Zs&&(y=t,u=Number.isFinite(u)?u:y.width,d=Number.isFinite(d)?d:y.height,y.bind(0),t=y.target),m)switch(t){case 3553:case 34067:p.copyTexSubImage2D(t,o,a,l,i,r,u,d);break;case 35866:case 32879:ko(p).copyTexSubImage3D(t,o,a,l,c,i,r,u,d)}else p.copyTexImage2D(t,o,s,i,r,u,d,0);y&&y.unbind(),p.bindFramebuffer(36160,v||null),f&&h.delete()}(e,s,{targetY:0,width:r,height:o}),e.delete(),s}function pp(e,t,n){for(let i=0;i<t.length;i++){const{icon:r,xOffset:o}=t[i];e[hp(r)]={...r,x:o,y:n}}}class gp{constructor(e,t){let{onUpdate:n=cp,onError:i=cp}=t;I(this,"gl",void 0),I(this,"onUpdate",void 0),I(this,"onError",void 0),I(this,"_loadOptions",null),I(this,"_texture",null),I(this,"_externalTexture",null),I(this,"_mapping",{}),I(this,"_textureParameters",null),I(this,"_pendingCount",0),I(this,"_autoPacking",!1),I(this,"_xOffset",0),I(this,"_yOffset",0),I(this,"_rowHeight",0),I(this,"_buffer",4),I(this,"_canvasWidth",1024),I(this,"_canvasHeight",0),I(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=i}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?hp(e):e;return this._mapping[t]||{}}setProps(e){let{loadOptions:t,autoPacking:n,iconAtlas:i,iconMapping:r,textureParameters:o}=e;var s;(t&&(this._loadOptions=t),void 0!==n&&(this._autoPacking=n),r&&(this._mapping=r),i)&&(null===(s=this._texture)||void 0===s||s.delete(),this._texture=null,this._externalTexture=i);o&&(this._textureParameters=o)}get isLoaded(){return 0===this._pendingCount}packIcons(e,t){if(!this._autoPacking||"undefined"===typeof document)return;const n=Object.values(function(e,t,n){if(!e||!t)return null;n=n||{};const i={},{iterable:r,objectInfo:o}=Xu(e);for(const s of r){o.index++;const e=t(s,o),r=hp(e);if(!e)throw new Error("Icon is missing.");if(!e.url)throw new Error("Icon url is missing.");i[r]||n[r]&&e.url===n[r].url||(i[r]={...e,source:s,sourceIndex:o.index})}return i}(e,t,this._mapping)||{});if(n.length>0){const{mapping:e,xOffset:t,yOffset:i,rowHeight:r,canvasHeight:o}=function(e){let{icons:t,buffer:n,mapping:i={},xOffset:r=0,yOffset:o=0,rowHeight:s=0,canvasWidth:a}=e,l=[];for(let u=0;u<t.length;u++){const e=t[u];if(!i[hp(e)]){const{height:t,width:c}=e;r+c+n>a&&(pp(i,l,o),r=0,o=s+o+n,s=0,l=[]),l.push({icon:e,xOffset:r}),r=r+c+n,s=Math.max(s,t)}}return l.length>0&&pp(i,l,o),{mapping:i,rowHeight:s,xOffset:r,yOffset:o,canvasWidth:a,canvasHeight:(c=s+o+n,Math.pow(2,Math.ceil(Math.log2(c))))};var c}({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=r,this._mapping=e,this._xOffset=t,this._yOffset=i,this._canvasHeight=o,this._texture||(this._texture=new Ks(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||up})),this._texture.height!==this._canvasHeight&&(this._texture=fp(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||up)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n)}}_loadIcons(e){const t=this._canvas.getContext("2d",{willReadFrequently:!0});for(const n of e)this._pendingCount++,Tr(n.url,this._loadOptions).then((e=>{const i=hp(n),r=this._mapping[i],{x:o,y:s,width:a,height:l}=r,{data:c,width:u,height:d}=dp(t,e,a,l);this._texture.setSubImageData({data:c,x:o+(a-u)/2,y:s+(l-d)/2,width:u,height:d}),r.width=u,r.height=d,this._texture.generateMipmap(),this.onUpdate()})).catch((e=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:e})})).finally((()=>{this._pendingCount--}))}}const mp=[0,0,0,255],vp={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:e=>e.position},getIcon:{type:"accessor",value:e=>e.icon},getColor:{type:"accessor",value:mp},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class yp extends Mh{constructor(){super(...arguments),I(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[rf,pf]})}initializeState(){this.state={iconManager:new gp(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})};this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:mp},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:t,oldProps:n,changeFlags:i}=e,r=this.getAttributeManager(),{iconAtlas:o,iconMapping:s,data:a,getIcon:l,textureParameters:c}=t,{iconManager:u}=this.state,d=o||this.internalState.isAsyncPropLoading("iconAtlas");if(u.setProps({loadOptions:t.loadOptions,autoPacking:!d,iconAtlas:o,iconMapping:d?s:null,textureParameters:c}),d?n.iconMapping!==t.iconMapping&&r.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&u.packIcons(a,l),i.extensionsChanged){var h;const{gl:e}=this.context;null===(h=this.state.model)||void 0===h||h.delete(),this.state.model=this._getModel(e),r.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw(e){let{uniforms:t}=e;const{sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,sizeUnits:o,billboard:s,alphaCutoff:a}=this.props,{iconManager:l}=this.state,c=l.getTexture();c&&this.state.model.setUniforms(t).setUniforms({iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeUnits:Ft[o],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,billboard:s,alphaCutoff:a}).draw()}_getModel(e){return new jd(e,{...this.getShaders(),id:this.props.id,geometry:new mf({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var t;const n=null===(t=this.getCurrentLayer())||void 0===t?void 0:t.props.onIconError;n?n(e):ne.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:n,anchorX:i=t/2,anchorY:r=n/2}=this.state.iconManager.getIconMapping(e);return[t/2-i,n/2-r]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:n,width:i,height:r}=this.state.iconManager.getIconMapping(e);return[t,n,i,r]}}I(yp,"defaultProps",vp),I(yp,"layerName","IconLayer");const bp=[0,0,0,255],_p={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:e=>e.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:bp},getLineColor:{type:"accessor",value:bp},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class wp extends Mh{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[rf,pf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var t;const{gl:e}=this.context;null===(t=this.state.model)||void 0===t||t.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}}draw(e){let{uniforms:t}=e;const{radiusUnits:n,radiusScale:i,radiusMinPixels:r,radiusMaxPixels:o,stroked:s,filled:a,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:d,lineWidthMinPixels:h,lineWidthMaxPixels:f}=this.props;this.state.model.setUniforms(t).setUniforms({stroked:s?1:0,filled:a,billboard:l,antialiasing:c,radiusUnits:Ft[n],radiusScale:i,radiusMinPixels:r,radiusMaxPixels:o,lineWidthUnits:Ft[u],lineWidthScale:d,lineWidthMinPixels:h,lineWidthMaxPixels:f}).draw()}_getModel(e){return new jd(e,{...this.getShaders(),id:this.props.id,geometry:new mf({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}I(wp,"defaultProps",_p),I(wp,"layerName","ScatterplotLayer");const xp=.75,Pp=[];class Sp extends yp{constructor(){super(...arguments),I(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float sdfBuffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState();this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(e,t)=>{let{index:n,target:i}=t;return this.encodePickingColor(n,i)}}})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e;let{outlineColor:i}=t;i!==n.outlineColor&&(i=i.map((e=>e/255)),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!t.sdf&&t.outlineWidth&&ne.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:t,smoothing:n,outlineWidth:i}=this.props,{outlineColor:r}=this.state,o=i?Math.max(n,xp*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:xp,outlineBuffer:o,gamma:n,sdf:Boolean(t),outlineColor:r},super.draw(e),t&&i){const{iconManager:e}=this.state;e.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:xp}})}}getInstanceOffset(e){return e?Array.from(e).flatMap((e=>super.getInstanceOffset(e))):Pp}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap((e=>super.getInstanceIconFrame(e))):Pp}}I(Sp,"defaultProps",{getIconOffsets:{type:"accessor",value:e=>e.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),I(Sp,"layerName","MultiIconLayer");const Ep=1e20;class Tp{constructor(){let{fontSize:e=24,buffer:t=3,radius:n=8,cutoff:i=.25,fontFamily:r="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=t,this.cutoff=i,this.radius=n;const a=this.size=e+4*t,l=this._createCanvas(a),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font="".concat(s," ").concat(o," ").concat(e,"px ").concat(r),c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:r,actualBoundingBoxRight:o}=this.ctx.measureText(e),s=Math.ceil(n),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-r))),l=Math.min(this.size-this.buffer,s+Math.ceil(i)),c=a+2*this.buffer,u=l+2*this.buffer,d=Math.max(c*u,0),h=new Uint8ClampedArray(d),f={data:h,width:c,height:u,glyphWidth:a,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:t};if(0===a||0===l)return f;const{ctx:p,buffer:g,gridInner:m,gridOuter:v}=this;p.clearRect(g,g,a,l),p.fillText(e,g,g+s);const y=p.getImageData(g,g,a,l);v.fill(Ep,0,d),m.fill(0,0,d);for(let b=0;b<l;b++)for(let e=0;e<a;e++){const t=y.data[4*(b*a+e)+3]/255;if(0===t)continue;const n=(b+g)*c+e+g;if(1===t)v[n]=0,m[n]=Ep;else{const e=.5-t;v[n]=e>0?e*e:0,m[n]=e<0?e*e:0}}Cp(v,0,0,c,u,c,this.f,this.v,this.z),Cp(m,g,g,a,l,c,this.f,this.v,this.z);for(let b=0;b<d;b++){const e=Math.sqrt(v[b])-Math.sqrt(m[b]);h[b]=Math.round(255-255*(e/this.radius+this.cutoff))}return f}}function Cp(e,t,n,i,r,o,s,a,l){for(let c=t;c<t+i;c++)Ap(e,n*o+c,o,r,s,a,l);for(let c=n;c<n+r;c++)Ap(e,c*o+t,1,i,s,a,l)}function Ap(e,t,n,i,r,o,s){o[0]=0,s[0]=-Ep,s[1]=Ep,r[0]=e[t];for(let a=1,l=0,c=0;a<i;a++){r[a]=e[t+a*n];const i=a*a;do{const e=o[l];c=(r[a]-r[e]+i-e*e)/(a-e)/2}while(c<=s[l]&&--l>-1);l++,o[l]=a,s[l]=c,s[l+1]=Ep}for(let a=0,l=0;a<i;a++){for(;s[l+1]<a;)l++;const i=o[l],c=a-i;e[t+a*n]=r[i]+c*c}}const kp=32,Mp=[];function Lp(e,t,n,i){let r=0;for(let s=t;s<n;s++){var o;r+=(null===(o=i[e[s]])||void 0===o?void 0:o.layoutWidth)||0}return r}function Op(e,t,n,i,r,o){let s=t,a=0;for(let l=t;l<n;l++){const t=Lp(e,l,l+1,r);a+t>i&&(s<l&&o.push(l),s=l,a=0),a+=t}return a}function Rp(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0;void 0===o&&(o=e.length);const s=[];return"break-all"===t?Op(e,r,o,n,i,s):function(e,t,n,i,r,o){let s=t,a=t,l=t,c=0;for(let u=t;u<n;u++)if(" "===e[u]?l=u+1:" "!==e[u+1]&&u+1!==n||(l=u+1),l>a){let t=Lp(e,a,l,r);c+t>i&&(s<a&&(o.push(a),s=a,c=0),t>i&&(t=Op(e,a,l,i,r,o),s=o[o.length-1])),a=l,c+=t}}(e,r,o,n,i,s),s}function Ip(e,t,n,i,r,o){let s=0,a=0;for(let l=t;l<n;l++){const t=e[l],n=i[t];n?(a||(a=n.layoutHeight),r[l]=s+n.layoutWidth/2,s+=n.layoutWidth):(ne.warn("Missing character: ".concat(t," (").concat(t.codePointAt(0),")"))(),r[l]=s,s+=kp)}o[0]=s,o[1]=a}class zp{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;I(this,"limit",void 0),I(this,"_cache",{}),I(this,"_order",[]),this.limit=e}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}const Fp={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){const e=[];for(let t=32;t<128;t++)e.push(String.fromCharCode(t));return e}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let Dp=new zp(3);function jp(e,t){for(let n=0;n<e.length;n++)t.data[4*n+3]=e[n]}function Np(e,t,n,i){e.font="".concat(i," ").concat(n,"px ").concat(t),e.fillStyle="#000",e.textBaseline="alphabetic",e.textAlign="left"}class Bp{constructor(){I(this,"props",{...Fp}),I(this,"_key",void 0),I(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:t}=this.props;return(1.2*e+2*t)/e}setProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.props,e),this._key=this._getKey();const t=function(e,t){let n;n="string"===typeof t?new Set(Array.from(t)):new Set(t);const i=Dp.get(e);if(!i)return n;for(const r in i.mapping)n.has(r)&&n.delete(r);return n}(this._key,this.props.characterSet),n=Dp.get(this._key);if(n&&0===t.size)return void(this._atlas!==n&&(this._atlas=n));const i=this._generateFontAtlas(t,n);this._atlas=i,Dp.set(this._key,i)}_generateFontAtlas(e,t){const{fontFamily:n,fontWeight:i,fontSize:r,buffer:o,sdf:s,radius:a,cutoff:l}=this.props;let c=t&&t.data;c||(c=document.createElement("canvas"),c.width=1024);const u=c.getContext("2d",{willReadFrequently:!0});Np(u,n,r,i);const{mapping:d,canvasHeight:h,xOffset:f,yOffset:p}=function(e){let{characterSet:t,getFontWidth:n,fontHeight:i,buffer:r,maxCanvasWidth:o,mapping:s={},xOffset:a=0,yOffset:l=0}=e,c=0,u=a;const d=i+2*r;for(const f of t)if(!s[f]){const e=n(f);u+e+2*r>o&&(u=0,c++),s[f]={x:u+r,y:l+c*d+r,width:e,height:d,layoutWidth:e,layoutHeight:i},u+=e+2*r}return{mapping:s,xOffset:u,yOffset:l+c*d,canvasHeight:(h=l+(c+1)*d,Math.pow(2,Math.ceil(Math.log2(h))))};var h}({getFontWidth:e=>u.measureText(e).width,fontHeight:1.2*r,buffer:o,characterSet:e,maxCanvasWidth:1024,...t&&{mapping:t.mapping,xOffset:t.xOffset,yOffset:t.yOffset}});if(c.height!==h){const e=u.getImageData(0,0,c.width,c.height);c.height=h,u.putImageData(e,0,0)}if(Np(u,n,r,i),s){const t=new Tp({fontSize:r,buffer:o,radius:a,cutoff:l,fontFamily:n,fontWeight:"".concat(i)});for(const n of e){const{data:e,width:i,height:o,glyphTop:s}=t.draw(n);d[n].width=i,d[n].layoutOffsetY=.9*r-s;const a=u.createImageData(i,o);jp(e,a),u.putImageData(a,d[n].x,d[n].y)}}else for(const g of e)u.fillText(g,d[g].x,d[g].y+o+.9*r);return{xOffset:f,yOffset:p,mapping:d,data:c,width:c.width,height:c.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:n,buffer:i,sdf:r,radius:o,cutoff:s}=this.props;return r?"".concat(e," ").concat(t," ").concat(n," ").concat(i," ").concat(o," ").concat(s):"".concat(e," ").concat(t," ").concat(n," ").concat(i)}}const Up={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:e=>e.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class Vp extends Mh{constructor(){super(...arguments),I(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[rf,pf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:t}=e;if(t.extensionsChanged){var n;const{gl:e}=this.context;null===(n=this.state.model)||void 0===n||n.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}}draw(e){let{uniforms:t}=e;const{billboard:n,sizeScale:i,sizeUnits:r,sizeMinPixels:o,sizeMaxPixels:s,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]),this.state.model.setUniforms(t).setUniforms({billboard:n,stroked:Boolean(a),padding:l,sizeUnits:Ft[r],sizeScale:i,sizeMinPixels:o,sizeMaxPixels:s}).draw()}_getModel(e){return new jd(e,{...this.getShaders(),id:this.props.id,geometry:new mf({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}I(Vp,"defaultProps",Up),I(Vp,"layerName","TextBackgroundLayer");const Wp={start:1,middle:0,end:-1},Gp={top:1,center:0,bottom:-1},Hp=[0,0,0,255],qp={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Hp},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Fp.characterSet},fontFamily:Fp.fontFamily,fontWeight:Fp.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Hp},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:e=>e.text},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:Hp},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class Xp extends ap{constructor(){super(...arguments),I(this,"state",void 0),I(this,"getBoundingRect",((e,t)=>{let{size:[n,i]}=this.transformParagraph(e,t);const{fontSize:r}=this.state.fontAtlasManager.props;n/=r,i/=r;const{getTextAnchor:o,getAlignmentBaseline:s}=this.props;return[(Wp["function"===typeof o?o(e,t):o]-1)*n/2,(Gp["function"===typeof s?s(e,t):s]-1)*i/2,n,i]})),I(this,"getIconOffsets",((e,t)=>{const{getTextAnchor:n,getAlignmentBaseline:i}=this.props,{x:r,y:o,rowWidth:s,size:[a,l]}=this.transformParagraph(e,t),c=Wp["function"===typeof n?n(e,t):n],u=Gp["function"===typeof i?i(e,t):i],d=r.length,h=new Array(2*d);let f=0;for(let p=0;p<d;p++){const e=(1-c)*(a-s[p])/2;h[f++]=(c-1)*a/2+e+r[p],h[f++]=(u-1)*l/2+o[p]}return h}))}initializeState(){this.state={styleVersion:0,fontAtlasManager:new Bp},this.props.maxWidth>0&&ne.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:t,oldProps:n,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText();(this._updateFontAtlas()||t.lineHeight!==n.lineHeight||t.wordBreak!==n.wordBreak||t.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo(e){let{info:t}=e;return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(){const{fontSettings:e,fontFamily:t,fontWeight:n}=this.props,{fontAtlasManager:i,characterSet:r}=this.state,o={...e,characterSet:r,fontFamily:t,fontWeight:n};if(!i.mapping)return i.setProps(o),!0;for(const s in o)if(o[s]!==i.props[s])return i.setProps(o),!0;return!1}_updateText(){var e;const{data:t,characterSet:n}=this.props,i=null===(e=t.attributes)||void 0===e?void 0:e.getText;let r,{getText:o}=this.props,s=t.startIndices;const a="auto"===n&&new Set;if(i&&s){const{texts:e,characterCount:n}=function(e){let{value:t,length:n,stride:i,offset:r,startIndices:o,characterSet:s}=e;const a=t.BYTES_PER_ELEMENT,l=i?i/a:1,c=r?r/a:0,u=o[n]||Math.ceil((t.length-c)/l),d=s&&new Set,h=new Array(n);let f=t;if(l>1||c>0){f=new(0,t.constructor)(u);for(let e=0;e<u;e++)f[e]=t[e*l+c]}for(let p=0;p<n;p++){const e=o[p],t=o[p+1]||u,n=f.subarray(e,t);h[p]=String.fromCodePoint.apply(null,n),d&&n.forEach(d.add,d)}if(d)for(const p of d)s.add(String.fromCodePoint(p));return{texts:h,characterCount:u}}({...ArrayBuffer.isView(i)?{value:i}:i,length:t.length,startIndices:s,characterSet:a});r=n,o=(t,n)=>{let{index:i}=n;return e[i]}}else{const{iterable:e,objectInfo:n}=Xu(t);s=[0],r=0;for(const t of e){n.index++;const e=Array.from(o(t,n)||"");a&&e.forEach(a.add,a),r+=e.length,s.push(r)}}this.setState({getText:o,startIndices:s,numInstances:r,characterSet:a||n})}transformParagraph(e,t){const{fontAtlasManager:n}=this.state,i=n.mapping,r=this.state.getText,{wordBreak:o,lineHeight:s,maxWidth:a}=this.props;return function(e,t,n,i,r){const o=Array.from(e),s=o.length,a=new Array(s),l=new Array(s),c=new Array(s),u=("break-word"===n||"break-all"===n)&&isFinite(i)&&i>0,d=[0,0],h=[0,0];let f=0,p=0,g=0;for(let v=0;v<=s;v++){const e=o[v];if("\n"!==e&&v!==s||(g=v),g>p){const e=u?Rp(o,n,i,r,p,g):Mp;for(let n=0;n<=e.length;n++){const i=0===n?p:e[n-1],s=n<e.length?e[n]:g;Ip(o,i,s,r,a,h);for(let e=i;e<s;e++){var m;const t=(null===(m=r[o[e]])||void 0===m?void 0:m.layoutOffsetY)||0;l[e]=f+h[1]/2+t,c[e]=h[0]}f+=h[1]*t,d[0]=Math.max(d[0],h[0])}p=g}"\n"===e&&(a[p]=0,l[p]=0,c[p]=0,p++)}return d[1]=f,{x:a,y:l,rowWidth:c,size:d}}(r(e,t)||"",s,o,a*n.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:t,getText:n,fontAtlasManager:{scale:i,texture:r,mapping:o},styleVersion:s}=this.state,{data:a,_dataDiff:l,getPosition:c,getColor:u,getSize:d,getAngle:h,getPixelOffset:f,getBackgroundColor:p,getBorderColor:g,getBorderWidth:m,backgroundPadding:v,background:y,billboard:b,fontSettings:_,outlineWidth:w,outlineColor:x,sizeScale:P,sizeUnits:S,sizeMinPixels:E,sizeMaxPixels:T,transitions:C,updateTriggers:A}=this.props,k=this.getSubLayerClass("characters",Sp),M=this.getSubLayerClass("background",Vp);return[y&&new M({getFillColor:p,getLineColor:g,getLineWidth:m,padding:v,getPosition:c,getSize:d,getAngle:h,getPixelOffset:f,billboard:b,sizeScale:P,sizeUnits:S,sizeMinPixels:E,sizeMaxPixels:T,transitions:C&&{getPosition:C.getPosition,getAngle:C.getAngle,getSize:C.getSize,getFillColor:C.getBackgroundColor,getLineColor:C.getBorderColor,getLineWidth:C.getBorderWidth,getPixelOffset:C.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:A.getPosition,getAngle:A.getAngle,getSize:A.getSize,getFillColor:A.getBackgroundColor,getLineColor:A.getBorderColor,getLineWidth:A.getBorderWidth,getPixelOffset:A.getPixelOffset,getBoundingRect:{getText:A.getText,getTextAnchor:A.getTextAnchor,getAlignmentBaseline:A.getAlignmentBaseline,styleVersion:s}}}),{data:a.attributes&&a.attributes.background?{length:a.length,attributes:a.attributes.background}:a,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new k({sdf:_.sdf,smoothing:Number.isFinite(_.smoothing)?_.smoothing:Fp.smoothing,outlineWidth:w/(_.radius||Fp.radius),outlineColor:x,iconAtlas:r,iconMapping:o,getPosition:c,getColor:u,getSize:d,getAngle:h,getPixelOffset:f,billboard:b,sizeScale:P*i,sizeUnits:S,sizeMinPixels:E*i,sizeMaxPixels:T*i,transitions:C&&{getPosition:C.getPosition,getAngle:C.getAngle,getColor:C.getColor,getSize:C.getSize,getPixelOffset:C.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:A.getText,getPosition:A.getPosition,getAngle:A.getAngle,getColor:A.getColor,getSize:A.getSize,getPixelOffset:A.getPixelOffset,getIconOffsets:{getTextAnchor:A.getTextAnchor,getAlignmentBaseline:A.getAlignmentBaseline,styleVersion:s}}}),{data:a,_dataDiff:l,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(e){!function(e){ne.assert(Number.isFinite(e)&&e>=3,"Invalid cache limit"),Dp=new zp(e)}(e)}}function Zp(e,t,n,i){let r;if(Array.isArray(e[0])){const n=e.length*t;r=new Array(n);for(let i=0;i<e.length;i++)for(let n=0;n<t;n++)r[i*t+n]=e[i][n]||0}else r=e;return n?Cf(r,{size:t,gridResolution:n}):i?function(e,t){const{size:n=2,startIndex:i=0,endIndex:r=e.length,normalize:o=!0}=t||{},s=e.slice(i,r);Nf(s,n,0,r-i);const a=Cf(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const l of a)Bf(l,n);return a}(r,{size:t}):r}I(Xp,"defaultProps",qp),I(Xp,"layerName","TextLayer");class Yp extends Qf{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?Zp(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(Kp(e)){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}const t=this.getPathLength(e);return t<2?0:this.isClosed(e)?t<3?0:t+2:t}updateGeometryAttributes(e,t){if(0!==t.geometrySize)if(e&&Kp(e))for(const n of e){const e=this.getGeometrySize(n);t.geometrySize=e,this.updateGeometryAttributes(n,t),t.vertexStart+=e}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}_updateSegmentTypes(e,t){const n=this.attributes.segmentTypes,i=!!e&&this.isClosed(e),{vertexStart:r,geometrySize:o}=t;n.fill(0,r,r+o),i?(n[r]=4,n[r+o-2]=4):(n[r]+=1,n[r+o-2]+=2),n[r+o-1]=4}_updatePositions(e,t){const{positions:n}=this.attributes;if(!n||!e)return;const{vertexStart:i,geometrySize:r}=t,o=new Array(3);for(let s=i,a=0;a<r;s++,a++)this.getPointOnPath(e,a,o),n[3*s]=o[0],n[3*s+1]=o[1],n[3*s+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const{positionSize:i}=this;t*i>=e.length&&(t+=1-e.length/i);const r=t*i;return n[0]=e[r],n[1]=e[r+1],n[2]=3===i&&e[r+2]||0,n}isClosed(e){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:t}=this,n=e.length-t;return e[0]===e[n]&&e[1]===e[n+1]&&(2===t||e[2]===e[n+2])}}function Kp(e){return Array.isArray(e[0])}const Qp=[0,0,0,255],$p={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:e=>e.path},getColor:{type:"accessor",value:Qp},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Jp={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class eg extends Mh{constructor(){super(...arguments),I(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\n    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\n    geometry.position = vec4(currPosition + offset, 1.0);\n    gl_Position = project_common_position_to_clipspace(geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[rf,pf]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Jp,accessor:"getPath",update:this.calculatePositions,noAlloc:true,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:true},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Jp,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Jp,defaultValue:Qp},instancePickingColors:{size:3,type:5121,accessor:(e,t)=>{let{index:n,target:i}=t;return this.encodePickingColor(e&&e.__source?e.__source.index:n,i)}}}),this.setState({pathTesselator:new Yp({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:t,changeFlags:n}=e,i=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:e}=this.state,r=t.data.attributes||{};e.updateGeometry({data:t.data,geometryBuffer:r.getPath,buffers:r,normalize:!t._pathType,loop:"loop"===t._pathType,getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||i.invalidateAll()}if(n.extensionsChanged){var r;const{gl:e}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(e),i.invalidateAll()}}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,{data:i}=this.props;return i[0]&&i[0].__source&&(t.object=i.find((e=>e.__source.index===n))),t}disablePickingIndex(e){const{data:t}=this.props;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else super.disablePickingIndex(e)}draw(e){let{uniforms:t}=e;const{jointRounded:n,capRounded:i,billboard:r,miterLimit:o,widthUnits:s,widthScale:a,widthMinPixels:l,widthMaxPixels:c}=this.props;this.state.model.setUniforms(t).setUniforms({jointType:Number(n),capType:Number(i),billboard:r,widthUnits:Ft[s],widthScale:a,miterLimit:o,widthMinPixels:l,widthMaxPixels:c}).draw()}_getModel(e){return new jd(e,{...this.getShaders(),id:this.props.id,geometry:new mf({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}I(eg,"defaultProps",$p),I(eg,"layerName","PathLayer");const tg={circle:{type:wp,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:yp,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Xp,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},ng={type:eg,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},ig={type:sp,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function rg(e){let{type:t,props:n}=e;const i={};for(const r in n)i[r]=t.defaultProps[n[r]];return i}function og(e,t){const{transitions:n,updateTriggers:i}=e.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in t){const s=t[o];let a=e.props[o];o.startsWith("get")&&(a=e.getSubLayerAccessor(a),r.updateTriggers[s]=i[o],n&&(r.transitions[s]=n[o])),r[s]=a}return r}function sg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:o=e.length}=n;for(let s=r;s<o;s++){const n=e[s],{geometry:r}=n;if(r)if("GeometryCollection"===r.type){ne.assert(Array.isArray(r.geometries),"GeoJSON does not have geometries array");const{geometries:e}=r;for(let r=0;r<e.length;r++){ag(e[r],i,t,n,s)}}else ag(r,i,t,n,s)}return i}function ag(e,t,n,i,r){const{type:o,coordinates:s}=e,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=t;if(function(e,t){let n=lg[e];ne.assert(n,"Unknown GeoJSON type ".concat(e));for(;t&&--n>0;)t=t[0];return t&&Number.isFinite(t[0])}(o,s))switch(o){case"Point":a.push(n({geometry:e},i,r));break;case"MultiPoint":s.forEach((e=>{a.push(n({geometry:{type:"Point",coordinates:e}},i,r))}));break;case"LineString":l.push(n({geometry:e},i,r));break;case"MultiLineString":s.forEach((e=>{l.push(n({geometry:{type:"LineString",coordinates:e}},i,r))}));break;case"Polygon":c.push(n({geometry:e},i,r)),s.forEach((e=>{u.push(n({geometry:{type:"LineString",coordinates:e}},i,r))}));break;case"MultiPolygon":s.forEach((e=>{c.push(n({geometry:{type:"Polygon",coordinates:e}},i,r)),e.forEach((e=>{u.push(n({geometry:{type:"LineString",coordinates:e}},i,r))}))}))}else ne.warn("".concat(o," coordinates are malformed"))()}const lg={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function cg(e){return e.geometry.coordinates}function ug(e,t){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:i,lines:r,polygons:o}=e,s=function(e,t){const n={points:null,lines:null,polygons:null};for(const i in n){const r=e[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(3*r.length);const o=[];for(let e=0;e<r.length;e++)t(r[e],o),n[i][3*e+0]=o[0],n[i][3*e+1]=o[1],n[i][3*e+2]=o[2]}return n}(e,t);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:s.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:s.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}const dg=["points","linestrings","polygons"],hg={...rg(tg.circle),...rg(tg.icon),...rg(tg.text),...rg(ng),...rg(ig),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:e=>e.properties.icon},getText:{type:"accessor",value:e=>e.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class fg extends ap{initializeState(){this.state={layerProps:{},features:{}}}updateState(e){let{props:t,changeFlags:n}=e;if(!n.dataChanged)return;const{data:i}=this.props,r=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:r}),r?this._updateStateBinary({props:t,changeFlags:n}):this._updateStateJSON({props:t,changeFlags:n})}_updateStateBinary(e){let{props:t,changeFlags:n}=e;const i=ug(t.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON(e){let{props:t,changeFlags:n}=e;const i=function(e){if(Array.isArray(e))return e;switch(ne.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return ne.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}(t.data),r=this.getSubLayerRow.bind(this);let o={};const s={};if(Array.isArray(n.dataChanged)){const e=this.state.features;for(const t in e)o[t]=e[t].slice(),s[t]=[];for(const t of n.dataChanged){const n=sg(i,r,t);for(const i in e)s[i].push(lp({data:o[i],getIndex:e=>e.__source.index,dataRange:t,replace:n[i]}))}}else o=sg(i,r);const a=function(e,t){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:i,lineFeatures:r,polygonFeatures:o,polygonOutlineFeatures:s}=e;return n.points.data=i,n.points._dataDiff=t.pointFeatures&&(()=>t.pointFeatures),n.points.getPosition=cg,n.lines.data=r,n.lines._dataDiff=t.lineFeatures&&(()=>t.lineFeatures),n.lines.getPath=cg,n.polygons.data=o,n.polygons._dataDiff=t.polygonFeatures&&(()=>t.polygonFeatures),n.polygons.getPolygon=cg,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=t.polygonOutlineFeatures&&(()=>t.polygonOutlineFeatures),n.polygonsOutline.getPath=cg,n}(o,s);this.setState({features:o,featuresDiff:s,layerProps:a})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n,sourceLayer:i}=t;return t.featureType=dg.find((e=>i.id.startsWith("".concat(this.id,"-").concat(e,"-")))),n>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[n]),t}_updateAutoHighlight(e){const t="".concat(this.id,"-points-"),n="points"===e.featureType;for(const i of this.getSubLayers())i.id.startsWith(t)===n&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:t}=this.props,{layerProps:n}=this.state,i="polygons-fill",r=this.shouldRenderSubLayer(i,n.polygons.data)&&this.getSubLayerClass(i,ig.type);if(r){const o=og(this,ig.props),s=e&&t;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new r(o,this.getSubLayerProps({id:i,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:t}=this.props,{layerProps:n}=this.state,i="polygons-stroke",r="linestrings",o=!e&&t&&this.shouldRenderSubLayer(i,n.polygonsOutline.data)&&this.getSubLayerClass(i,ng.type),s=this.shouldRenderSubLayer(r,n.lines.data)&&this.getSubLayerClass(r,ng.type);if(o||s){const e=og(this,ng.props);return[o&&new o(e,this.getSubLayerProps({id:i,updateTriggers:e.updateTriggers}),n.polygonsOutline),s&&new s(e,this.getSubLayerProps({id:r,updateTriggers:e.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:t,binary:n}=this.state;let{highlightedObjectIndex:i}=this.props;!n&&Number.isFinite(i)&&(i=t.points.data.findIndex((e=>e.__source.index===i)));const r=new Set(e.split("+")),o=[];for(const s of r){const e="points-".concat(s),r=tg[s],a=r&&this.shouldRenderSubLayer(e,t.points.data)&&this.getSubLayerClass(e,r.type);if(a){const l=og(this,r.props);let c=t.points;if("text"===s&&n){const{instancePickingColors:e,...t}=c.data.attributes;c={...c,data:{...c.data,attributes:t}}}o.push(new a(l,this.getSubLayerProps({id:e,updateTriggers:l.updateTriggers,highlightedObjectIndex:i}),c))}}return o}renderLayers(){const{extruded:e}=this.props,t=this._renderPolygonLayer();return[!e&&t,this._renderLineLayers(),this._renderPointLayers(),e&&t]}getSubLayerAccessor(e){const{binary:t}=this.state;return t&&"function"===typeof e?(t,n)=>{const{data:i,index:r}=n,o=function(e,t){if(!e)return null;const n="startIndices"in e?e.startIndices[t]:t,i=e.featureIds.value[n];return-1!==n?function(e,t,n){const i={properties:{...e.properties[t]}};for(const r in e.numericProps)i.properties[r]=e.numericProps[r].value[n];return i}(e,i,n):null}(i,r);return e(o,n)}:super.getSubLayerAccessor(e)}}I(fg,"layerName","GeoJsonLayer"),I(fg,"defaultProps",hg);const pg=[0,0,0,255],gg={getSourcePosition:{type:"accessor",value:e=>e.sourcePosition},getTargetPosition:{type:"accessor",value:e=>e.targetPosition},getSourceColor:{type:"accessor",value:pg},getTargetColor:{type:"accessor",value:pg},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class mg extends Mh{constructor(){super(...arguments),I(this,"state",void 0)}getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:"#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\nattribute float instanceHeights;\nattribute float instanceTilts;\n\nuniform bool greatCircle;\nuniform bool useShortestPath;\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\n\n  float deltaZ = targetZ - sourceZ;\n  float dh = distance * instanceHeights;\n  if (dh == 0.0) {\n    return sourceZ + deltaZ * ratio;\n  }\n  float unitZ = deltaZ / dh;\n  float p2 = unitZ * unitZ + 1.0;\n  float dir = step(deltaZ, 0.0);\n  float z0 = mix(sourceZ, targetZ, dir);\n  float r = mix(ratio, 1.0 - ratio, dir);\n  return sqrt(r * (p2 - r)) * dh + z0;\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\n  float distance = length(source.xy - target.xy);\n  float z = paraboloid(distance, source.z, target.z, segmentRatio);\n\n  float tiltAngle = radians(instanceTilts);\n  vec2 tiltDirection = normalize(target.xy - source.xy);\n  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n\n  return vec3(\n    mix(source.xy, target.xy, segmentRatio) + tilt,\n    z * cos(tiltAngle)\n  );\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 sourceRadians = radians(source);\n  vec2 targetRadians = radians(target);\n  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\n  vec2 shd_sq = sin_half_delta * sin_half_delta;\n\n  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\n  return 2.0 * asin(sqrt(a));\n}\n\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\n  vec2 lngLat;\n  if(abs(angularDist - PI) < 0.001) {\n    lngLat = (1.0 - t) * source.xy + t * target.xy;\n  } else {\n    float a = sin((1.0 - t) * angularDist);\n    float b = sin(t * angularDist);\n    vec3 p = source3D.yxz * a + target3D.yxz * b;\n    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n  }\n\n  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\n\n  return vec3(lngLat, z);\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\n  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  isValid = 1.0;\n\n  uv = vec2(segmentRatio, positions.y);\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  vec4 curr;\n  vec4 next;\n  vec3 source;\n  vec3 target;\n\n  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\n    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\n    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\n\n    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\n    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\n    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\n\n    if (abs(currPos.x - prevPos.x) > 180.0) {\n      indexDir = -1.0;\n      isValid = 0.0;\n    } else if (abs(currPos.x - nextPos.x) > 180.0) {\n      indexDir = 1.0;\n      isValid = 0.0;\n    }\n    nextPos = indexDir < 0.0 ? prevPos : nextPos;\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n\n    if (isValid == 0.0) {\n      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\n      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\n      currPos = mix(currPos, nextPos, t);\n      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n    }\n\n    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\n    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\n  \n    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\n    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n  \n  } else {\n    vec3 source_world = instanceSourcePositions;\n    vec3 target_world = instanceTargetPositions;\n    if (useShortestPath) {\n      source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n      target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n\n      float deltaLng = target_world.x - source_world.x;\n      if (deltaLng > 180.) target_world.x -= 360.;\n      if (deltaLng < -180.) source_world.x -= 360.;\n    }\n    source = project_position(source_world, instanceSourcePositions64Low);\n    target = project_position(target_world, instanceTargetPositions64Low);\n    float antiMeridianX = 0.0;\n\n    if (useShortestPath) {\n      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;\n      }\n      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);\n\n      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\n        isValid = 0.0;\n        indexDir = sign(segmentRatio - thresholdRatio);\n        segmentRatio = thresholdRatio;\n      }\n    }\n\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n    vec3 currPos = interpolateFlat(source, target, segmentRatio);\n    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\n\n    if (useShortestPath) {\n      if (nextPos.x < antiMeridianX) {\n        currPos.x += TILE_SIZE;\n        nextPos.x += TILE_SIZE;\n      }\n    }\n\n    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));\n    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));\n    geometry.position = vec4(currPos, 1.0);\n  }\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  DECKGL_FILTER_GL_POSITION(curr, geometry);\n  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\n  vColor = vec4(color.rgb, color.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid == 0.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  geometry.uv = uv;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[rf,pf]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:pg},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:pg},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var t;const{gl:e}=this.context;null===(t=this.state.model)||void 0===t||t.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}}draw(e){let{uniforms:t}=e;const{widthUnits:n,widthScale:i,widthMinPixels:r,widthMaxPixels:o,greatCircle:s,wrapLongitude:a}=this.props;this.state.model.setUniforms(t).setUniforms({greatCircle:s,widthUnits:Ft[n],widthScale:i,widthMinPixels:r,widthMaxPixels:o,useShortestPath:a}).draw()}_getModel(e){let t=[];for(let i=0;i<50;i++)t=t.concat([i,1,0,i,-1,0]);const n=new jd(e,{...this.getShaders(),id:this.props.id,geometry:new mf({drawMode:5,attributes:{positions:new Float32Array(t)}}),isInstanced:!0});return n.setUniforms({numSegments:50}),n}}I(mg,"layerName","ArcLayer"),I(mg,"defaultProps",gg);const vg=e=>{const{location:t,n:n}=e;return(0,Jh.jsxs)("div",{style:{height:"200px",position:"absolute",top:"20%",width:"450px",right:"40px",fontFamily:"AvantGarde-Bold"},children:[(0,Jh.jsx)("span",{style:{fontSize:"50px",color:"orange"},children:t}),(0,Jh.jsx)("br",{}),(0,Jh.jsx)("span",{style:{fontSize:"30px",color:"white"},children:"".concat(n," Dunedin staff member").concat(n>1?"s have":" has "," worked on projects here")})]})},yg=e=>{const{Project:t,client:n,duration:i,desc:r,contacts:o,image_name:s}=e.feature;return(0,Jh.jsxs)("div",{style:{height:"200px",position:"absolute",top:"2%",width:"45%",right:"20px",fontFamily:"AvantGarde-Bold"},children:[(0,Jh.jsx)("div",{style:{fontSize:"30px",color:"orange",marginBottom:"10px"},children:t}),(0,Jh.jsx)("div",{style:{fontSize:"30px",color:"white",marginBottom:"10px"},children:"".concat(n,"  ").concat(i)}),(0,Jh.jsx)("div",{style:{fontSize:"22px",color:"white",marginBottom:"10px",fontFamily:"Arial",whiteSpace:"pre-line"},children:"".concat(r)}),o&&(0,Jh.jsx)("div",{style:{fontSize:"22px",color:"white",fontWeight:"normal",whiteSpace:"pre-line"},children:"Dunedin Team Members - ".concat(o)}),(0,Jh.jsx)("img",{src:"/client-function-queenstown"+"/images/".concat(s),style:{maxWidth:"700px",maxHeight:"500px",objectFit:"contain",marginTop:"28px"}})]})},bg=e=>{const{line1:t,line2:n,line3:i,line4:r}=e.lines;return(0,Jh.jsxs)("div",{style:{height:"300px",top:"20px"},children:[(0,Jh.jsx)("span",{className:"header-text",style:{fontSize:"60px"},children:t}),(0,Jh.jsx)("br",{}),(0,Jh.jsx)("span",{className:"header-text",style:{fontSize:"40px",color:"white"},children:n}),(0,Jh.jsx)("br",{}),(0,Jh.jsx)("span",{className:"header-text",style:{fontSize:"60px",color:"white"},children:i}),(0,Jh.jsx)("br",{}),(0,Jh.jsx)("span",{className:"header-text",style:{fontSize:"60px"},children:r})]})},_g=170.50325014707238,wg=-45.8757087589976;function xg(){const{viewState:e,name:t,feature:n,lines:i}=nf(),r={data:Hh,id:"national",pickable:!1,opacity:1,stroked:!0,filled:!0,radiusScale:1e3,radiusMinPixels:5,radiusMaxPixels:10,lineWidthMinPixels:2,visible:!0,getPosition:e=>[e.lng,e.lat],getRadius:e=>20,getLineColor:e=>[0,0,0],getFillColor:e=>[255,165,0]},o={data:qh,id:"local",pickable:!0,opacity:1,stroked:!0,filled:!0,radiusScale:1e3,radiusMinPixels:5,radiusMaxPixels:10,lineWidthMinPixels:2,visible:!0,getPosition:e=>[e.lng,e.lat],getRadius:e=>20,getLineColor:e=>[0,0,0],getFillColor:e=>[255,165,0]},s=[new wp({...o,visible:"dunedin"===t,data:Xh}),new wp({...o,visible:"local"===t,data:qh}),new wp({...r,visible:"national"===t,data:Hh})];return(0,Jh.jsxs)(jh,{initialViewState:e,controller:!0,layers:s,children:[(0,Jh.jsx)(P,{mapboxAccessToken:"pk.eyJ1IjoicGV0ZWhpbGxqbnIiLCJhIjoiY2swcjZtd3IxMDJjOTNjb3c1Z25wczQ3NyJ9.2Ut4kmGeVuvc7UUb-qezNw",mapStyle:"mapbox://styles/mapbox/dark-v9",attributionControl:!1}),(0,Jh.jsx)(bg,{lines:i}),(0,Jh.jsx)("img",{src:Nh,height:50,alt:"stantec logo",className:"logo-position"}),"dunedin"===t?(0,Jh.jsx)(Jh.Fragment,{}):(0,Jh.jsx)(yg,{feature:n})]})}function Pg(){const{viewState:t,name:n,feature:i,lines:r}=nf(),o={data:Wh,widthMinPixels:1,greatCircle:!0,visible:!0,getSourcePosition:e=>[_g,wg,0],getTargetPosition:e=>[e.lng,e.lat,0],getHeight:.1,getWidth:2,getSourceColor:e=>[214,169,87,80],getTargetColor:e=>[214,169,87,80]},s={id:"globe",data:[[[-180,90],[0,90],[180,90],[180,-90],[0,-90],[-180,-90]]],getPolygon:e=>e,stroked:!1,filled:!0,getFillColor:[40,40,40],visible:!0},a={id:"land",data:"https://d2ad6b4ur7yvpq.cloudfront.net/naturalearth-3.3.0/ne_50m_land.geojson",stroked:!1,filled:!0,opacity:.8,getFillColor:[173,173,173],visible:!0},l={id:"staff",data:Wh,pickable:!0,opacity:1,stroked:!0,filled:!0,radiusScale:1e4,radiusMinPixels:5,radiusMaxPixels:500,lineWidthMinPixels:2,visible:!0,getPosition:e=>[e.lng,e.lat],getRadius:e=>e.n,getLineColor:e=>[0,0,0],getFillColor:e=>[255,165,0]},c={id:"international",data:Gh,pickable:!1,opacity:1,stroked:!0,filled:!0,radiusScale:1e3,radiusMinPixels:5,radiusMaxPixels:10,lineWidthMinPixels:2,visible:!0,getPosition:e=>[e.lng,e.lat],getRadius:e=>20,getLineColor:e=>[0,0,0],getFillColor:e=>[255,165,0]},u=(0,e.useMemo)((()=>[new sp(s),new fg(a)]),[s,a]),d=[new wp({...c,visible:"international"===n}),new wp({...l,visible:"staff"===n}),new mg({...o,visible:"staff"===n})];return(0,Jh.jsxs)(jh,{views:new kn,initialViewState:t,controller:!0,layers:[u,d],parameters:{clearColor:[0,0,0,1],cull:!0},children:[(0,Jh.jsx)(bg,{lines:r}),(0,Jh.jsx)("img",{src:Nh,height:50,alt:"stantec logo",className:"logo-position"}),"staff"===n?(0,Jh.jsx)(vg,{location:i.loc,n:i.n}):(0,Jh.jsx)(yg,{feature:i})]})}const Sg=()=>{const{view:e}=nf();return"Map"===e?(0,Jh.jsx)(xg,{}):(0,Jh.jsx)(Pg,{})};const Eg=function(){return(0,Jh.jsx)(Sg,{})};t.createRoot(document.getElementById("root")).render((0,Jh.jsx)(e.StrictMode,{children:(0,Jh.jsx)(tf,{children:(0,Jh.jsx)(Eg,{})})}))})()})();
//# sourceMappingURL=main.54ed0742.js.map